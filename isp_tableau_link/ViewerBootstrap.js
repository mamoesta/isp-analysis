(function(){
/*! BEGIN MscorlibSlim */
var global=window;(function(global){"use strict";var ss={};ss.initAssembly=function(obj,name,res){};ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)};ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)};ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)};ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);var r={};for(var i=0;i<a.length;i+=2){r[a[i]]=a[i+1]}return r};ss.clone=function ss$clone(t,o){return o?t.$clone(o):o};ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b};ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==='[object Date]'};ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==='[object Array]'};ss.equals=function ss$equals(a,b){if(!ss.isValue(a))throw new ss_NullReferenceException('Object is null');else if(a!==ss&&typeof(a.equals)==='function')return a.equals(b);if(ss.isDate(a)&&ss.isDate(b))return a.valueOf()===b.valueOf();else if(typeof(a)==='function'&&typeof(b)==='function')return ss.delegateEquals(a,b);else if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b))return true;else return a===b};ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a))return!ss.isValue(b);else return ss.isValue(b)?ss.equals(a,b):false};ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);for(var i=0,l=keys.length;i<l;i++){var k=keys[i];target[k]=source[k]}};ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n))delete d[n]}};ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined};if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable('toString'),dontEnums=['toString','toLocaleString','valueOf','hasOwnProperty','isPrototypeOf','propertyIsEnumerable','constructor'],dontEnumsLength=dontEnums.length;return function(obj){if(typeof obj!=='object'&&(typeof obj!=='function'||obj===null)){throw new TypeError('Object.keys called on non-object')}var result=[],prop,i;for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)}}if(hasDontEnumBug){for(i=0;i<dontEnumsLength;i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])}}}return result}}())}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length};ss.setMetadata=function ss$_setMetadata(type,metadata){};ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){if(baseType&&baseType!==Object){var f=function(){};f.prototype=baseType.prototype;ctor.prototype=new f;ctor.prototype.constructor=ctor}ss.shallowCopy(members,ctor.prototype)};ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ss.shallowCopy(members,ctor.prototype);ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0};ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?'string':'number')}};ss.getBaseType=function ss$getBaseType(type){throw new Error("Not implemented yet")};ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance))return false;if(typeof(type.isInstanceOfType)==='function')return type.isInstanceOfType(instance);return ss.isAssignableFrom(type,ss.getInstanceType(instance))};ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==='function'&&target.isAssignableFrom(type))||type.prototype instanceof target};ss.safeCast=function ss$safeCast(instance,type){if(type===true)return instance;else if(type===false)return null;else return ss.isInstanceOfType(instance,type)?instance:null};ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==='undefined')return instance;else if(type===true||(type!==false&&ss.isInstanceOfType(instance,type)))return instance;throw new ss_InvalidCastException('Cannot cast object to requested type')};ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance))throw new ss_NullReferenceException('Cannot get type of null');try{return instance.constructor}catch(ex){return Object}};ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==='function')return type.getDefaultValue();else if(type===Boolean)return false;else if(type===Date)return new Date(0);else if(type===Number)return 0;return null};var ss_IFormattable=null;var ss_IComparable=null;var ss_IEquatable=null;ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return!s||!s.length};if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))}}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp('['+String.fromCharCode.apply(null,chars)+']+$'):/\s*$/,'')};ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp('^['+String.fromCharCode.apply(null,chars)+']+'):/^\s*/,'')};ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)};ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]}else{return Array.apply(null,arr)}};ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;i<targets.length;i+=2){if(targets[i]===object&&targets[i+1]===method){return true}}return false};ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)}else{var clone=ss.arrayClone(targets);for(var i=0;i<clone.length;i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)}}return null}};delegate._targets=targets;return delegate};ss.mkdel=function ss$mkdel(object,method){if(!object){return method}return ss._mkdel([object,method])};ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)}return delegate2}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)}return delegate1}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];var targets2=delegate2._targets?delegate2._targets:[null,delegate2];return ss._mkdel(targets1.concat(targets2))};ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null}if(!delegate2){return delegate1}var targets=delegate1._targets;var object=null;var method;if(delegate2._targets){object=delegate2._targets[0];method=delegate2._targets[1]}else{method=delegate2}for(var i=0;i<targets.length;i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null}var t=ss.arrayClone(targets);t.splice(i,2);return ss._mkdel(t)}}return delegate1};ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b)return true;if(!a._targets&&!b._targets)return false;var ta=a._targets||[null,a],tb=b._targets||[null,b];if(ta.length!=tb.length)return false;for(var i=0;i<ta.length;i++){if(ta[i]!==tb[i])return false}return true};var ss_Enum=function Enum$(){};ss.Enum=ss_Enum;ss.initClass(ss_Enum,ss,{});ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];var values=enumType.prototype;for(var i in values){if(values.hasOwnProperty(i))parts.push(values[i])}return parts};var ss_IEnumerator=null;var ss_IEnumerable=null;ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)};ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance))throw new ss_InvalidOperationException('Nullable object must have a value.');return instance};var ss_Nullable$1=function Nullable$1$(T){};ss.Nullable$1=ss_Nullable$1;ss_Nullable$1.eq=function Nullable$eq(a,b){return!ss.isValue(a)?!ss.isValue(b):(a===b)};ss_Nullable$1.ne=function Nullable$eq(a,b){return!ss.isValue(a)?ss.isValue(b):(a!==b)};ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b};ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b};ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b};ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b};ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null};ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null};ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null};ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null};ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null};ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null};ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null};ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null};ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null};ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null};ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null};ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true)return true;else if(a===false||b===false)return false;else return null};ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true)return true;else if(a===false&&b===false)return false;else return null};ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null};ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null};ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null};ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null};ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;i<arguments.length;i++){if(!ss.isValue(arguments[i]))return null}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))};var ss_Int32=function Int32$(){};ss.Int32=ss_Int32;ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0};ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b))return null;if(b===0)throw new ss_DivideByZeroException;return ss_Int32.trunc(a/b)};ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?(n>0?Math.floor(n):Math.ceil(n)):null};var ss_JsDate=function JsDate$(){};ss_JsDate.__typeName='ss.JsDate';ss.JsDate=ss_JsDate;ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);ss_JsDate.createInstance=function JsDate$createInstance(){return new Date};ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date};var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;this._index=-1};ss.ArrayEnumerator=ss_ArrayEnumerator;ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;return(this._index<this._array.length)},reset:function ArrayEnumerator$reset(){this._index=-1},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length)throw'Invalid operation';return this._array[this._index]},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);this._index=-1;this._object=o};ss.ObjectEnumerator=ss_ObjectEnumerator;ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;return(this._index<this._keys.length)},reset:function ObjectEnumerator$reset(){this._index=-1},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length)throw new ss_InvalidOperationException('Invalid operation');var k=this._keys[this._index];return{key:k,value:this._object[k]}},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);var ss_IDisposable=null;var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!='')?[s]:[];this.length=ss.isValue(s)?s.length:0};ss.StringBuilder=ss_StringBuilder;ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();this._parts.push(s);this.length+=s.length}return this},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))},appendLine:function StringBuilder$appendLine(s){this.append(s);this.append('\r\n');return this},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))},clear:function StringBuilder$clear(){this._parts=[];this.length=0},toString:function StringBuilder$toString(){return this._parts.join('')}});var ss_Exception=function Exception$(message,innerException){this._message=message||'An error occurred.';this._innerException=innerException||null;this._error=new Error};ss.Exception=ss_Exception;ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message},get_innerException:function Exception$get_innerException(){return this._innerException},get_stack:function Exception$get_stack(){return this._error.stack},toString:function Exception$toString(){var message=this._message;var exception=this;if(ss.isNullOrEmptyString(message)){if(ss.isValue(ss.getInstanceType(exception))&&ss.isValue(ss.getTypeFullName(ss.getInstanceType(exception)))){message=ss.getTypeFullName(ss.getInstanceType(exception))}else{message='[object Exception]'}}return message}});ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o}else if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))}else if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))}else if(o instanceof Error){return new ss_JsErrorException(o)}else{return new ss_Exception(o.toString())}};var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||'The method or operation is not implemented.',innerException)};ss_NotImplementedException.__typeName='ss.NotImplementedException';ss.NotImplementedException=ss_NotImplementedException;ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||'Specified method is not supported.',innerException)};ss_NotSupportedException.__typeName='ss.NotSupportedException';ss.NotSupportedException=ss_NotSupportedException;ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];ss_Exception.call(this,message||'One or more errors occurred.',this.innerExceptions.length?this.innerExceptions[0]:null)};ss_AggregateException.__typeName='ss.AggregateException';ss.AggregateException=ss_AggregateException;ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];for(var i=0;i<this.innerExceptions.length;i++){var e=this.innerExceptions[i];if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)}else{inner.push(e)}}return new ss_AggregateException(this._message,inner)}},ss_Exception);var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():'An error occurred'),innerException);this.arguments=ss.arrayClone(args)};ss_PromiseException.__typeName='ss.PromiseException';ss.PromiseException=ss_PromiseException;ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments}},ss_Exception);var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);this.error=error};ss_JsErrorException.__typeName='ss.JsErrorException';ss.JsErrorException=ss_JsErrorException;ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack}},ss_Exception);var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||'Value does not fall within the expected range.',innerException);this.paramName=paramName||null};ss_ArgumentException.__typeName='ss.ArgumentException';ss.ArgumentException=ss_ArgumentException;ss.initClass(ss_ArgumentException,ss,{},ss_Exception);var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message='Value cannot be null.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException)};ss_ArgumentNullException.__typeName='ss.ArgumentNullException';ss.ArgumentNullException=ss_ArgumentNullException;ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message='Value is out of range.';if(paramName)message+='\nParameter name: '+paramName}ss_ArgumentException.call(this,message,paramName,innerException);this.actualValue=actualValue||null};ss_ArgumentOutOfRangeException.__typeName='ss.ArgumentOutOfRangeException';ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||'Invalid format.',innerException)};ss_FormatException.__typeName='ss.FormatException';ss.FormatException=ss_FormatException;ss.initClass(ss_FormatException,ss,{},ss_Exception);var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||'Division by 0.',innerException)};ss_DivideByZeroException.__typeName='ss.DivideByZeroException';ss.DivideByZeroException=ss_DivideByZeroException;ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||'The cast is not valid.',innerException)};ss_InvalidCastException.__typeName='ss.InvalidCastException';ss.InvalidCastException=ss_InvalidCastException;ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||'Operation is not valid due to the current state of the object.',innerException)};ss_InvalidOperationException.__typeName='ss.InvalidOperationException';ss.InvalidOperationException=ss_InvalidOperationException;ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||'Object is null.',innerException)};ss_NullReferenceException.__typeName='ss.NullReferenceException';ss.NullReferenceException=ss_NullReferenceException;ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||'Key not found.',innerException)};ss_KeyNotFoundException.__typeName='ss.KeyNotFoundException';ss.KeyNotFoundException=ss_KeyNotFoundException;ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||'Ambiguous match.',innerException)};ss_AmbiguousMatchException.__typeName='ss.AmbiguousMatchException';ss.AmbiguousMatchException=ss_AmbiguousMatchException;ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);if(typeof(global.HTMLElement)==='undefined'){global.HTMLElement=Element}if(typeof(global.MessageEvent)==='undefined'){global.MessageEvent=Event}Date.now=Date.now||function(){return+new Date};global.ss=ss})(global);
/*! BEGIN Bootstrap */
(function(){'dont use strict';var a={};global.tab=global.tab||{};global.tabBootstrap=global.tabBootstrap||{};ss.initAssembly(a,'ViewerBootstrap');var b=function(e,x,z,A){this.$1$1=null;this.$1$2=null;this.$1$3=null;this.$1$4=null;this.set_name(e);this.set_commandId(x);this.set_hostId(z);this.set_parameters(A)};b.__typeName='tab._ApiCommand';b.generateNextCommandId=function(){var e='cmd'+b.$0;b.$0++;return e};b.parse=function(e){var x;var z=e.indexOf(String.fromCharCode(44));if(z<0){x=e;return new b(x,null,null,null)}x=e.substr(0,z);var A;var B=e.substr(z+1);z=B.indexOf(String.fromCharCode(44));if(z<0){A=B;return new b(x,A,null,null)}A=B.substr(0,z);var C;var D=B.substr(z+1);z=D.indexOf(String.fromCharCode(44));if(z<0){C=D;return new b(x,A,C,null)}C=D.substr(0,z);var E=D.substr(z+1);return new b(x,A,C,E)};global.tab._ApiCommand=b;var c=function(e,x,z){this.$1=null;this.$2=null;this.$0=null;this.$1=e;this.$2=x;this.$0=z};c.__typeName='tab._ApiServerNotification';c.deserialize=function(e){var x=JSON.parse(e);var z=x['api.workbookName'];var A=x['api.worksheetName'];var B=x['api.commandData'];return new c(z,A,B)};global.tab._ApiServerNotification=c;var d=function(e){this.$1=null;this.$0=null;var x=JSON.parse(e);this.$1=x['api.commandResult'];this.$0=x['api.commandData']};d.__typeName='tab._ApiServerResultParser';global.tab._ApiServerResultParser=d;var f=function(e,x){this.$0=null;this.$1$1=null;this.set_name(e);this.$0=x};f.__typeName='tab.NonApiCommand';f.parse=function(e){var x=e.split(String.fromCharCode(44));var z=x[0];var A=x.slice(1);return new f(z,A)};global.tab.NonApiCommand=f;var g=function(){};g.__typeName='tabBootstrap.$0';g.$0=function(){var e={parseOnLoad:true,usePlainJson:true,noFirebugLite:true,useXDomain:tsConfig.xdomain_active,locale:'en-us'};if(tsConfig.xdomain_active){var x={tableau:tsConfig.external_static_asset_prefix+'/javascripts/built-dojo/tableau'};e.modulePaths=x;e.baseUrl=tsConfig.external_static_asset_prefix+'/javascripts/built-dojo/dojo/';e.dojoBlankHtmlUrl=tsConfig.local_static_asset_prefix+'/javascripts/blank.html'}if(tsConfig.debugMode){try{var z=new RegExp('[?&][:]?debug=');if(window.location.search.search(z)!==-1){e.isDebug=true;e.debugAtAllCosts=true}}catch(A){}}window.self['djConfig']=e};var h=function(){};h.__typeName='tabBootstrap.$1';h.$1=function(e){var x=document.getElementById(e);if(ss.isValue(x)){x.style.display='none'}};h.$2=function(){var e=document.getElementById('tsConfigContainer');var x=JSON.parse(e.value);window.self['tsConfig']=x};h.$0=function(e){var x=document.getElementById('tabBootErr');var z=x.childNodes[1].lastChild;z.textContent+='\n'+e;x.style.display='block';h.$1('loadingGlassPane');h.$1('loadingSpinner');try{window.parent.postMessage('tableau.completed','*')}catch(A){}return false};var i=function(){r.call(this,-1,0,'',{});this.open=false;this.start=0;this.end=0};i.__typeName='tabBootstrap.$2';i.$0=function(){if(ss.isNullOrUndefined(i.$1)){i.$1=new i}return i.$1};var j=function(){};j.__typeName='tabBootstrap.$3';var k=function(){};k.__typeName='tabBootstrap.ApiCommandResponder';k.$0=function(e,x,z){var A={};A['api.workbookName']=e;A['api.worksheetName']=x;A['api.commandData']=z;return JSON.stringify(A)};global.tabBootstrap.ApiCommandResponder=k;var l=function(){k.call(this)};l.__typeName='tabBootstrap.ApiCrossDomainResponder';global.tabBootstrap.ApiCrossDomainResponder=l;var m=function(e){this.$2$1=null;k.call(this);this.set_responseAction(e)};m.__typeName='tabBootstrap.ApiNativeHostResponder';global.tabBootstrap.ApiNativeHostResponder=m;var n=function(){};n.__typeName='tabBootstrap.BaseUrlFormatter';n.formatBaseUrl=function(){return window.location.protocol+'//'+window.location.host};n.formatUrlRoot=function(e,x){var z=e;if(ss.isValue(x)){z+=x}else if(ss.isValue(tsConfig.vizql_root)){z+=tsConfig.vizql_root}else{var A=window.location.pathname;A=A.replace(new RegExp('\\/[^\\/]*$'),'');z+=A}return z};n.formatSessionMethod=function(e,x,z){var A=new ss.StringBuilder;A.append(z);A.append('/');A.append(e);A.append('/sessions/');A.append(x);return A.toString()};global.tabBootstrap.BaseUrlFormatter=n;var o=function(e,x){this.$0=null;this.$1=null;this.$0=e;var z=n.formatBaseUrl();this.$1=n.formatUrlRoot(z,x)};o.__typeName='tabBootstrap.BootstrapSession';global.tabBootstrap.BootstrapSession=o;var p=function(){};p.__typeName='tabBootstrap.EmbedMode';global.tabBootstrap.EmbedMode=p;var q=function(){};q.__typeName='tabBootstrap.Metric';q.isEqual=function(e,x){return e.w===x.w&&e.h===x.h};q.isInstanceOfType=function(){return true};global.tabBootstrap.Metric=q;var r=function(e,x,z,A){this.id=0;this.metricSuite=0;this.description=null;this.$0=null;this.start=0;this.end=0;this.open=false;this.id=e;this.metricSuite=x;this.description=z;this.start=s.getTiming();this.open=true;this.$0=A};r.__typeName='tabBootstrap.MetricsContext';global.tabBootstrap.MetricsContext=r;var s=function(){this.$8=0;this.$3=[];this.$4=[];this.$5=null;this.$9='';this.$b='';this.$a='';this.$6='';this.$7=0;if(ss.isValue(tsConfig.metricsFilter)&&tsConfig.metricsFilter!==''){var e=0;var x=tsConfig.metricsFilter.split(String.fromCharCode(124));for(var z=0;z<x.length;z++){var A=x[z];var B=((typeof(A['trim'])==='function')?A.trim():A);B=B.toLowerCase();if(ss.keyExists(s.$3,B)){e|=s.$3[B]}}this.$7=e}};s.__typeName='tabBootstrap.MetricsController';s.$1=function(){if(ss.isNullOrUndefined(s.$4)){s.$4=new s}return s.$4};s.createContext=function(e,x,z){if(ss.isNullOrUndefined(x)){x=32}var A=x===0||(x&s.$1().$7)!==x;if(ss.isNullOrUndefined(z)){z={}}var B;if(A){B=i.$0()}else{B=new r(s.$1().$0(),x,e,z);s.$1().$3.push(B)}return B};s.logEvent=function(e){if(e.metricSuite===0||(e.metricSuite&s.$1().$7)!==e.metricSuite){return}if(ss.isValue(s.$1().$5)){e.parameters['sid']=s.$1().$6;s.$1().$5(e)}else{s.$1().$4.push(e)}};s.setEventLogger=function(e){s.$1().$5=e;if(ss.isValue(e)&&s.$4.$4.length>0){for(var x=0;x<s.$4.$4.length;x++){var z=s.$4.$4[x];z.parameters['sid']=s.$4.$6;s.$4.$5(z)}s.$4.$4=[]}};s.initSessionInfo=function(){var e=s.$1();var x=(ss.isNullOrEmptyString(tsConfig.current_sheet_name)?tsConfig.sheetId:tsConfig.current_sheet_name);if(ss.referenceEquals(e.$9,tsConfig.sessionid)&&ss.referenceEquals(e.$b,tsConfig.workbookName)&&ss.referenceEquals(e.$a,x)){return}e.$9=tsConfig.sessionid;e.$b=tsConfig.workbookName;e.$a=x;var z=new Date;e.$6=z.getTime().toString(36);e.$6=e.$6.substr(e.$6.length-6);if(e.$9.length>=5){e.$6=e.$6+e.$9.substr(1,1);e.$6=e.$6+e.$9.substr(4,1)}e.$2()};s.closeContext=function(e){var x=e.id;var z=-1;for(var A=s.$1().$3.length-1;A>=0;A--){if(s.$4.$3[A].id===x){z=A;break}}if(z!==-1){var B=s.$4.$3.length-z;for(var C=0;C<B;C++){s.$4.$3.pop()}}s.$4.$1(e)};s.$0=function(e){var x={};x['id']=e.id;x['d']=e.description;if(ss.getKeyCount(e.get_properties())>0){x['p']=e.get_properties()}return x};global.tabBootstrap.MetricsController=s;var t=function(e,x,z){this.eventType=null;this.metricSuite=0;this.parameters=null;this.eventType=e;this.metricSuite=x;this.parameters=z};t.__typeName='tabBootstrap.MetricsEvent';global.tabBootstrap.MetricsEvent=t;var u=function(){};u.__typeName='tabBootstrap.MetricsSuites';global.tabBootstrap.MetricsSuites=u;var v=function(){};v.__typeName='tabBootstrap.Utility';v.$c=function(){if(!tsConfig.is_mobile_device||tsConfig.embedded){return false}var e=window.navigator.userAgent.indexOf('Android')!==-1;if(e){return false}var x=window.navigator.userAgent.indexOf('Safari')!==-1&&window.navigator.userAgent.indexOf('OS 7')!==-1;return x};v.$b=function(){try{var e=v.$4();var x=e.orientation;return ss.isValue(x)&&(x===90||x===-90)}catch(z){}return false};v.get_urlLocationSearchParams=function(){return v.$a(v.get_urlLocationSearch().substring(1))};v.get_urlLocationHashData=function(){var e={};var x=v.get_urlLocationHash();if(x.length<2){return{}}x=x.substr(1);var z=x.split('&');for(var A=0;A<z.length;A++){var B=z[A];var C=B.split('=');if(C.length===1){e[v.CLIENTNO]=C[0]}else if(C.length===2){var D=decodeURIComponent(C[0]);var E=decodeURIComponent(C[1]);e[D]=E}}return e};v.set_urlLocationHashData=function(e){var x=new ss.StringBuilder;var z=true;var A=function(){x.append((z?'#':'&'));z=false};var B=new ss.ObjectEnumerator(e);try{while(B.moveNext()){var C=B.current();var D=encodeURIComponent(C.key);A();if(ss.referenceEquals(D,v.CLIENTNO)){x.append(C.value)}else if(ss.isNullOrUndefined(C.value)){x.append(D)}else{x.append(D).append('=').append(encodeURIComponent(C.value))}}}finally{B.dispose()}if(ss.isValue(x)){var E=v.get_locationWindow();if(v.historyApiSupported()){v.replaceState(E,null,null,x.toString())}else{E.location.hash=x.toString()}}};v.get_urlLocationHash=function(){var e=v.get_locationWindow();return e.location.hash};v.get_urlLocationSearch=function(){var e=v.get_locationWindow();return e.location.search};v.get_embedMode=function(){return v.$d};v.get_isEmbedded=function(){return v.get_embedMode()==='sameDomainEmbedded'||v.get_embedMode()==='crossDomainEmbedded'};v.get_locationWindow=function(){return window.self};v.$a=function(e){var x={};var z=e.split('&');for(var A=0;A<z.length;A++){var B=z[A];var C=B.split('=');if(C.length===2){var D=decodeURIComponent(C[0]);var E=decodeURIComponent(C[1]);x[D]=E}}return x};v.xhrPostJsonChunked=function(x,z,A,B,C,D){var E=new XMLHttpRequest;E.open('POST',x,D);E.setRequestHeader('Accept','text/javascript');E.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(!ss.isNullOrUndefined(tsConfig.sheetId)){E.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var F=v.$2(E,C);var G=0;var H=function(){var e='';try{e=E.responseText}catch(U){}var L=e.length;while(G<L){var M=e.substr(G);var N=new RegExp('^(\\d+);');var O=M.match(N);if(!ss.isValue(O)){return}var P=O[0].length;var Q=parseInt(O[1]);if(P+Q>M.length){return}M=M.substr(P,Q);var R=null;try{var S='Parse '+((G===0)?'Primary':'Secondary')+' JSON';{var T=s.createContext(S,32,null);try{R=v.$9(M)}finally{if(ss.isValue(T)){T.dispose()}}}}catch(U){F(new ss.Exception('Invalid JSON'))}if(G===0){A(R)}else{B(R)}G+=P+Q}};var I=-1;var J=false;var K=window.navigator.userAgent.indexOf('MSIE')>=0&&parseFloat(window.navigator.appVersion.split('MSIE ')[1])<10;E.onreadystatechange=function(){try{if(!K&&E.readyState===3&&E.status===200&&!J){H();if(I===-1){I=window.setInterval(H,10)}J=true;return}if(E.readyState!==4){return}if(I!==-1){window.clearInterval(I);I=-1}if(v.$8(E)){H()}else{F(new ss.Exception('Unable to load '+x+'; status: '+E.status))}}catch(e){var ex=ss.Exception.wrap(e);if(typeof(ss.getType('ss'))==='undefined'){E.abort()}else{throw ex}}};try{E.send(z)}catch(L){var e=ss.Exception.wrap(L);F(e)}};v.xhrGetXmlSynchronous=function(x,z){var A=new XMLHttpRequest;A.open('GET',x,false);A.setRequestHeader('Accept','text/xml');try{A.send()}catch(B){var e=ss.Exception.wrap(B);v.$7(A,z,e);return null}return A.responseText};v.xhrPostJson=function(z,A,B,C,D){var E=new XMLHttpRequest;E.open('POST',z,D);E.setRequestHeader('Accept','text/javascript');E.setRequestHeader('Content-Type','application/x-www-form-urlencoded');if(ss.isValue(tsConfig.sheetId)){E.setRequestHeader('X-Tsi-Active-Tab',tsConfig.sheetId)}var F=v.$2(E,C);E.onreadystatechange=function(){if(E.readyState!==4){return}if(v.$8(E)){try{var e=v.$9(E.responseText);B(e)}catch(G){var x=ss.Exception.wrap(G);F(x)}}else{F(new ss.Exception('Unable to load '+z+'; status: '+E.status))}};try{E.send(A)}catch(G){var e=ss.Exception.wrap(G);F(e)}};v.applySafari7CSSHackFix=function(){if(v.$c()){if(v.$b()){window.document.body.style.height=window.outerHeight-20+'px'}else{window.document.body.style.height=''}}};v.attachOneTimeMessageHandler=function(e){var x=null;x=function(z){var A=z;if(e(A)){if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',x,false)}else{window.self.detachEvent('onmessage',x)}}};if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',x,false)}else{window.self.attachEvent('onmessage',x)}};v.sendCommandWithContext=function(e){var x=false;var z=[];if(tsConfig.loadOrderID>=0){z.push(tsConfig.loadOrderID)}if(!ss.isNullOrEmptyString(tsConfig.apiID)){if(tsConfig.loadOrderID<0){z.push(tsConfig.loadOrderID)}z.push(tsConfig.apiID)}var A=new f(e,z);x=v.doPostMessage(A.serialize());return x};v.doPostMessage=function(e){var x=false;if('postMessage'in window){try{window.parent.postMessage(e,'*');x=true}catch(z){}}return x};v.$0=function(){var e=false;var x=false;try{e=ss.referenceEquals(window.self,window.parent);x=ss.isNullOrUndefined(window.parent.outerWidth)}catch(z){x=true}if(e){return'notEmbedded'}else if(x){return'crossDomainEmbedded'}else{return'sameDomainEmbedded'}};v.$9=function(e){if(ss.isNullOrUndefined(e)||typeof(e)!=='string'){return null}e=e.trim();var x=JSON.parse(e);return x};v.$5=function(){var e=window.document.documentElement;return{w:e.clientWidth,h:e.clientHeight}};v.$6=function(){return{w:window.innerWidth,h:window.innerHeight}};v.$4=function(){var e=window.self;while(ss.isValue(e.parent)&&!ss.referenceEquals(e.parent,e)){e=e.parent}return e};v.$3=function(){var e,x;var z=window.document.documentElement.clientWidth;var A=window.document.documentElement.clientHeight;var B=window.navigator.userAgent.indexOf('Android')!==-1;if(B){if(z===window.screen.height){x=window.screen.width-A;e=z-x;z=A+x;A=e}}else if(v.$b()){if(window.innerHeight<A&&v.$c()){A-=20}if(z===window.screen.width){x=window.screen.height-A;e=z-x;z=A+x;A=e}}else if(z===window.screen.height){x=window.screen.width-A;e=z-x;z=A+x;A=e}return{w:z,h:A}};v.get_hashClientNumber=function(){var e=v.get_urlLocationHashData();return((ss.isValue(e)&&ss.isValue(e[v.CLIENTNO]))?e[v.CLIENTNO]:'')};v.addToUrlHash=function(e,x){var z=v.get_urlLocationHashData();z[e]=x;v.set_urlLocationHashData(z)};v.historyApiSupported=function(){return typeof(window.history['pushState'])==='function'&&typeof(window.history['replaceState'])==='function'};v.replaceState=function(e,x,z,A){try{e.history.replaceState(x,z,A)}catch(B){}};v.getValueFromUrlHash=function(e){var x=v.get_urlLocationHashData();return(ss.keyExists(x,e)?x[e]:'')};v.removeEntryFromUrlHash=function(e){var x=v.get_urlLocationHashData();delete x[e];v.set_urlLocationHashData(x)};v.$1=function(){var e=1;if(ss.isValue(tsConfig.highDpi)&&tsConfig.highDpi){if(ss.isValue(tsConfig.pixelRatio)){e=tsConfig.pixelRatio}else{e=ss.coalesce(window.self['devicePixelRatio'],1)}}return e};v.$8=function(e){var x=(ss.isValue(e.status)?e.status:0);if(x>=200&&x<300||x===304||x===1223||x===0&&(window.location.protocol==='file:'||window.location.protocol==='chrome:')){return true}return false};v.$7=function(e,x,z){if(ss.staticEquals(x,null)){return}var A=v.$2(e,x);A(z)};v.$2=function(e,x){return function(z){z.status=e.status;z.responseText=e.responseText;x(z)}};global.tabBootstrap.Utility=v;var w=function(e){this.location=null;this.toolbarDisplayed=false;this.rid=0;this.ts=0;this.isVisibleRectCommunicationEnabled=false;this.apiResponder=null;this.$4=null;this.$6=null;this.$5=null;this.authoringLeftAreaWidth=0;this.rightAreaDrawerWidth=0;this.clearSessionOnUnload=false;this.initialLayoutModel=null;this.initialLayoutError=null;this.secondaryResponses=null;this.bootstrapState=1;this._onSuccess=null;this._onError=null;this.$7=false;this.authoringGutter=null;if(!tsConfig.isPublic&&!tsConfig.toolbarvis){tsConfig.blogURI='';tsConfig.downloadURI=''}this.toolbarDisplayed=tsConfig.toolbarContainerVis;this.ts=(new Date).getTime();this.rid=0;this.location=window.location;tsConfig.showLytebox=ss.referenceEquals(window.self,window.top)&&!ss.isNullOrEmptyString(tsConfig.primaryContentUrl)&&!tsConfig.is_authoring;this.apiResponder=e||w.$0();v.applySafari7CSSHackFix();this.setupClearSessionOnBrowserUnload();this.$7=false;this.authoringLeftAreaWidth=((tsConfig.is_authoring&&!tsConfig.is_mobile)?200:0);if(v.get_isEmbedded()){v.attachOneTimeMessageHandler(ss.mkdel(this,function(x){var z=f.parse(x.data.toString());if(z.get_name()==='tableau.enableVisibleRectCommunication'){this.isVisibleRectCommunicationEnabled=true;return true}return false}));v.sendCommandWithContext('tableau.listening')}this.authoringGutter={top:0,left:6,bottom:6,right:15}};w.__typeName='tabBootstrap.ViewerBootstrap';w.get_instance=function(){return w._instance=w._instance||new w(w.$0())};w.get_canvasPixelLimit=function(){var e=25000000;if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){e=3000000}return e};w.resetInstance=function(){w._instance=null};w.makeOneTimeListener=function(e){var x=false;return function(z){if(x){return}x=true;e(z)}};w.makeOneTimeHandler=function(e){var x=false;return function(){if(x){return}x=true;e(null)}};w.$0=function(){if(tsConfig.is_mobile_app){return new m(null)}else{return new l}};global.tabBootstrap.ViewerBootstrap=w;var y=function(){};y.__typeName='tabBootstrap.VizLayoutConstants';y.get_vizToolbarHeight=function(){return((tsConfig.isPublic&&!tsConfig.features['UsePublicSpecificToolbar']&&tsConfig.watermarkdisplay||tsConfig.is_mobile_app)?60:27)};y.get_displayToolbarHeight=function(){return(w.get_instance().toolbarDisplayed?y.get_vizToolbarHeight():0)};y.get_shouldShowTabs=function(){return tsConfig.showTabs};y.get_tabsHeight=function(){if(tsConfig.is_authoring){return 0}return(y.get_shouldShowTabs()?23:0)};y.get_authoringToolbarHeight=function(){if(!tsConfig.is_authoring){return 0}return(tsConfig.is_mobile?44:40)};y.get_authoringMastheadHeight=function(){if(!tsConfig.is_authoring||!tsConfig.features['WebAuthoringMenuBar']&&tsConfig.is_mobile_app){return 0}else if(tsConfig.features['WebAuthoringMenuBar']){return(tsConfig.is_mobile_app?44:60)}else{return(tsConfig.is_mobile?32:50)}};y.get_authoringTabsHeight=function(){return(tsConfig.is_authoring?30:0)};y.get_authoringVizBorderWidth=function(){return(tsConfig.is_authoring?1:0)};y.get_authoringShelfWidth=function(){return(tsConfig.is_authoring?(tsConfig.is_mobile?50:190):0)};y.get_authoringShelfHeight=function(){return(tsConfig.is_authoring?(tsConfig.is_mobile?0:68):0)};y.get_authoringVizMargin=function(){return(tsConfig.is_authoring?6:0)};global.tabBootstrap.VizLayoutConstants=y;ss.initClass(b,a,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_hostId:function(){return this.$1$2},set_hostId:function(e){this.$1$2=e},get_commandId:function(){return this.$1$3},set_commandId:function(e){this.$1$3=e},get_parameters:function(){return this.$1$4},set_parameters:function(e){this.$1$4=e},get_isApiCommandName:function(){return this.get_rawName().indexOf('api.',0)===0},get_rawName:function(){return this.get_name().toString()},serialize:function(){var e=[];e.push(this.get_name());e.push(this.get_commandId());e.push(this.get_hostId());if(ss.isValue(this.get_parameters())){e.push(this.get_parameters())}var x=e.join(',');return x}});ss.initClass(c,a,{get_workbookName:function(){return this.$1},get_worksheetName:function(){return this.$2},get_data:function(){return this.$0},serialize:function(){var e={};e['api.workbookName']=this.$1;e['api.worksheetName']=this.$2;e['api.commandData']=this.$0;return JSON.stringify(e)}});ss.initClass(d,a,{get_result:function(){return this.$1},get_data:function(){return this.$0}});ss.initClass(f,a,{get_name:function(){return this.$1$1},set_name:function(e){this.$1$1=e},get_parameters:function(){return this.$0},serialize:function(){var e=[];e.push(this.get_name().toString());e=e.concat.apply(e,this.$0);return e.join(',')}});ss.initClass(g,a,{});ss.initClass(h,a,{});ss.initClass(r,a,{get_endTime:function(){return this.end},get_properties:function(){return this.$0},dispose:function(){this.close()},close:function(){if(this.open){this.end=s.getTiming();s.closeContext(this);this.open=false}},elapsedMS:function(){if(!this.open){return this.end-this.start}return s.getTiming()-this.start}},null,[ss.IDisposable]);ss.initClass(i,a,{close:function(){}},r,[ss.IDisposable]);ss.initEnum(j,a,{$4:1,$3:2,$2:3,$1:4,$0:5});ss.initClass(k,a,{sendResponse:null,sendEventNotification:function(e,x,z){var A=k.$0(tsConfig.workbookName,ss.coalesce(x,''),ss.coalesce(z,''));var B=new b(e,'xdomainSourceId',tsConfig.apiID,A);this.sendResponse(B,A)}});ss.initClass(l,a,{$0:function(){return!ss.referenceEquals(window.window,window.parent)},sendResponse:function(e,x){if(!('postMessage'in window)||!this.$0()){return}var z=e.get_name();var A=new b(z,e.get_commandId(),e.get_hostId(),x);var B=A.serialize();window.parent.postMessage(B,'*')}},k);ss.initClass(m,a,{get_responseAction:function(){return this.$2$1},set_responseAction:function(e){this.$2$1=e},sendResponse:function(e,x){if(!ss.staticEquals(this.get_responseAction(),null)){this.get_responseAction()(e,x)}}},k);ss.initClass(n,a,{});ss.initClass(o,a,{formatSessionMethod:function(e){return n.formatSessionMethod(e,this.$0,this.$1)}});ss.initEnum(p,a,{notEmbedded:'notEmbedded',sameDomainEmbedded:'sameDomainEmbedded',crossDomainEmbedded:'crossDomainEmbedded'},true);ss.initClass(q,a,{},Object);ss.initClass(s,a,{$0:function(){var e=this.$8;++this.$8;return e},$2:function(){var e={};e['id']=this.$9;e['sid']=this.$6;e['wb']=this.$b;e['s']=this.$a;e['m']=tsConfig.is_mobile;s.logEvent(new t('init',2,e))},$1:function(e){var x=s.$0(e);x['t']=e.get_endTime();x['e']=e.elapsedMS();s.logEvent(new t('wp',e.metricSuite,x))}});ss.initClass(t,a,{});ss.initEnum(u,a,{none:0,navigation:1,bootstrap:2,rendering:4,commands:8,hitTest:16,debug:32,toolbar:64,fonts:128,min:3,core:15,all:255});ss.initClass(v,a,{});ss.initClass(w,a,{get_hasBootstrapCompleted:function(){return this.bootstrapState===4||this.bootstrapState===5},get_hasBootstrapSucceeded:function(){return this.bootstrapState===4},get_hasBootstrapFailed:function(){return this.bootstrapState===5},get_authoringLeftAreaWidth:function(){return this.authoringLeftAreaWidth},set_authoringLeftAreaWidth:function(e){this.authoringLeftAreaWidth=e},get_rightAreaDrawerWidth:function(){return this.rightAreaDrawerWidth},set_rightAreaDrawerWidth:function(e){this.rightAreaDrawerWidth=e},get_sessionBeingCleared:function(){return this.$7},get_clientDimension:function(){if(ss.isValue(this.$4)){return this.$4}var e=v.get_urlLocationSearchParams()[':size'];var x=(ss.isValue(e)?e.split(String.fromCharCode(44)).map(function(z){return parseInt(z)}):null);this.$4=((ss.isNullOrUndefined(x)||isNaN(x[0])||isNaN(x[1]))?{w:document.documentElement.clientWidth,h:document.documentElement.clientHeight}:{w:x[0],h:x[1]});return this.$4},get_deviceType:function(){return this.$6},get_compositeSize:function(){if(ss.isValue(this.$5)){return this.$5}this.$5=this.getCompositeSizeForDeviceType(this.get_deviceType());return this.$5},getCompositeSizeForDeviceType:function(e){var x=JSON.parse(tsConfig.composite_sizes);return x[w.$2[e]]},setupClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=tsConfig.clear_session_on_unload;if(!this.clearSessionOnUnload){return}if(ss.isValue(window.self['addEventListener'])){window.addEventListener('beforeunload',ss.mkdel(this,function(){this.$7=true;this.clearSession()}),false)}else if(ss.isValue(window.self['attachEvent'])){window.attachEvent('onbeforeunload',ss.mkdel(this,function(){this.$7=true;this.clearSession()}))}},disableClearSessionOnBrowserUnload:function(){this.clearSessionOnUnload=false},waitOnInitialLayoutModel:function(e,x,z){if(this.get_hasBootstrapCompleted()){x(null);return}if(this.bootstrapState!==3){this._onSuccess=e;this._onError=x;this['_onSecondary']=z}else{this._onError=x;this['_onSecondary']=z;var A=this.initialLayoutModel;var B=this.initialLayoutError;if(ss.isValue(B)||ss.isNullOrUndefined(A)){this.bootstrapState=5;x(B)}else{e(A);this.bootstrapState=4;if(ss.isValue(z)&&ss.isValue(this.secondaryResponses)){for(var C=0;C<this.secondaryResponses.length;C++){z(this.secondaryResponses[C])}}}}},$3:function(){var e=null;e=ss.mkdel(this,function(x){var z=x;var A=f.parse(z.data.toString());if(A.get_name()==='tableau.bootstrap'){this.$2();if(ss.isValue(window.self.removeEventListener)){window.removeEventListener('message',e,false)}else{window.self.detachEvent('onmessage',e)}}});if(ss.isValue(window.self.addEventListener)){window.addEventListener('message',e,false)}else{window.self.attachEvent('onmessage',e)}},bootstrap:function(){this.$0();if(!tsConfig.bootstrapWhenNotified||!v.get_isEmbedded()){this.$2()}else{this.$3()}this.$1()},$0:function(){var e=v.get_urlLocationSearchParams()[':device'];if(!ss.isNullOrEmptyString(e)){var x=ss.getEnumerator(Object.keys(w.$2));try{while(x.moveNext()){var z=x.current();if(ss.referenceEquals(w.$2[z],e)){this.$6=z;return}}}finally{x.dispose()}}var A=Math.min(this.get_clientDimension().w,this.get_clientDimension().h);this.$6=((A<=tsConfig.dsd_phone_max_size)?'phone':((A<=tsConfig.dsd_tablet_max_size)?'tablet':'desktop'))},$2:function(){this.rid++;var e=document.getElementById('staticImage');if(tsConfig.bootstrapOnMouseover){this.scaleImageToFit(e)}var x=[];var z=this.getWebClientPortSize('worksheet');x.push('worksheetPortSize='+encodeURIComponent(JSON.stringify(z)));z=this.getWebClientPortSize('dashboard');x.push('dashboardPortSize='+encodeURIComponent(JSON.stringify(z)));if(!tsConfig.is_authoring){x.push('clientDimension='+encodeURIComponent(JSON.stringify(this.get_clientDimension())))}tsConfig.is_rendering_enabled=tsConfig.is_browser_rendering_requested;x.push('isBrowserRendering='+tsConfig.is_rendering_enabled);x.push('browserRenderingThreshold='+tsConfig.browser_rendering_threshold);x.push('formatDataValueLocally='+tsConfig.formatDataValueLocally);x.push('clientNum='+encodeURIComponent(v.get_hashClientNumber()));var A=v.$1();x.push('devicePixelRatio='+encodeURIComponent(A.toString()));if(ss.isValue(tsConfig.is_mobile)&&tsConfig.is_mobile){x.push('imageSizeLimit='+encodeURIComponent((5242880).toString()));x.push('transparentLineMarkLimit='+1200)}x.push('clientRenderPixelLimit='+encodeURIComponent(w.get_canvasPixelLimit().toString()));if(!ss.isNullOrEmptyString(tsConfig.deviceTypeOverride)){x.push(':device='+tsConfig.deviceTypeOverride)}if(ss.isValue(tsConfig.sheetId)){x.push('sheet_id='+encodeURIComponent(tsConfig.sheetId.toString()))}if(ss.isValue(tsConfig.showParams)){x.push('showParams='+encodeURIComponent(tsConfig.showParams.toString()))}if(ss.isValue(tsConfig.stickySessionKey)){x.push('stickySessionKey='+encodeURIComponent(tsConfig.stickySessionKey))}if(ss.isValue(tsConfig.filterTileSize)){x.push('filterTileSize='+encodeURIComponent(tsConfig.filterTileSize.toString()))}if(ss.isValue(tsConfig.workbookLocale)){x.push('workbookLocale='+encodeURIComponent(tsConfig.workbookLocale))}if(ss.isValue(tsConfig.locale)){x.push('locale='+encodeURIComponent(tsConfig.locale.toString()))}if(ss.isValue(tsConfig.language)){x.push('language='+encodeURIComponent(tsConfig.language.toString()))}if(ss.isValue(tsConfig.syncSession)&&tsConfig.syncSession.length!==0&&typeof(tsConfig.syncSession)==='string'){x.push('sync_session_state='+encodeURIComponent(this.getSyncSessionState(tsConfig.syncSession)))}if(ss.isValue(tsConfig.debugMode)){x.push('verboseMode='+tsConfig.debugMode)}if(ss.isValue(tsConfig.features_json)){x.push(':session_feature_flags='+encodeURIComponent(tsConfig.features_json.toString()))}if(ss.isValue(tsConfig.keychain_version)){x.push('keychain_version='+tsConfig.keychain_version)}var B=x.join('&');var C=new o(tsConfig.sessionid);var D=C.formatSessionMethod('bootstrapSession');var E=this.rid;var F=s.createContext('BTSTRP'.toString(),2,null);var G=this;var H=ss.mkdel(this,function(N){F.dispose();N.rid=E;if(ss.isValue(this._onSuccess)){this._onSuccess(N);this.bootstrapState=4}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(N,null)});var I=function(N){if('_onSecondary'in G){G['_onSecondary'](N)}else{G.appendSecondaryResponse(N)}};var J=ss.mkdel(this,function(N){if(ss.isValue(this._onError)){this.bootstrapState=5;this._onError(N)}else{this.bootstrapState=3}this.markInitialLayoutModelAsFinished(null,N);F.dispose()});var K=ss.mkdel(this,function(){this.bootstrapState=2;if(ss.isNullOrUndefined(tsConfig.offlineBootstrapResponse)){v.xhrPostJsonChunked(D,B,H,I,J,true)}else{if(tsConfig.offlineBootstrapResponse.length===0){throw new ss.Exception('Offline bootstrap response is empty')}H(JSON.parse(tsConfig.offlineBootstrapResponse[0]));for(var N=1;N<tsConfig.offlineBootstrapResponse.length;N++){I(JSON.parse(tsConfig.offlineBootstrapResponse[N]))}}});if(!tsConfig.bootstrapOnMouseover){K();return}var L=document.getElementById('initializing_thin_client');this.hideLoadIndicators(L,e);var M=ss.mkdel(this,function(){this.showLoadIndicators(L,e);K()});if(ss.isValue(e)){if(ss.isValue(e.addEventListener)){e.addEventListener('mouseover',w.makeOneTimeListener(M),false)}else if(ss.isValue(e.attachEvent)){e.attachEvent('onmouseover',w.makeOneTimeHandler(M))}}},showLyteboxIfNeeded:function(){if(tsConfig.showLytebox){document.getElementById('primaryContent').style.display='block';document.getElementById('primaryContentLink').style.display='';document.getElementById('centeringContainer').className='lyteboxed';document.getElementById('lyteboxClose').style.display='block';document.body.className+=' lyteboxed'}},getViewport:function(){if(tsConfig.is_mobile_device&&!tsConfig.embedded){return v.$3()}return((tsConfig.features['IframeSizedToWindow']&&!tsConfig.is_mobile)?v.$6():v.$5())},$1:function(){var e=new Object;e.maxHeight=this.get_compositeSize().maxHeight;e.maxWidth=this.get_compositeSize().maxWidth;e.minHeight=this.get_compositeSize().minHeight;e.minWidth=this.get_compositeSize().minWidth;var x=e;var z=new Object;z.sizeConstraints=x;z.chromeHeight=this.chromeMetricsForViewingOnly().h;var A=z;this.apiResponder.sendEventNotification('api.FirstVizSizeKnownEvent',null,JSON.stringify(A))},getSyncSessionState:function(e){var x=e.split(String.fromCharCode(47));var z=new o(x[1],'/'+x[0]);var A=z.formatSessionMethod('get_global_filters');return v.xhrGetXmlSynchronous(A,null)},getWebClientDashboardContainerSize:function(e){var x=this.getViewport();var z=this.chromeMetrics(e);x.h-=z.h;x.w-=z.w;return this.adjustForMinMaxDashboardSizes(x)},getVizClientContainerSize:function(e){var x=this.getWebClientDashboardContainerSize(e);x.h+=y.get_tabsHeight()+y.get_displayToolbarHeight();return x},getWebClientPortSize:function(e){var x=this.getWebClientDashboardContainerSize(e);if(e==='dashboard'&&ss.isValue(tsConfig.features)&&tsConfig.is_authoring){x.h-=this.authoringGutter.top+this.authoringGutter.bottom;x.w-=this.authoringGutter.left+this.authoringGutter.right}return this.adjustForMinMaxDashboardSizes(x)},adjustForMinMaxDashboardSizes:function(e){var x=this.get_compositeSize().minWidth;var z=this.get_compositeSize().maxWidth;if(x!==0&&e.w<x){e.w=x}else if(z!==0&&e.w>z){e.w=z}else if(tsConfig.showLytebox){e.w=tsConfig.lyteboxedVizWidth}var A=this.get_compositeSize().minHeight;if(A!==0&&e.h<A){e.h=A}else{var B=this.get_compositeSize().maxHeight;if(B!==0&&e.h>B){e.h=B}}return e},chromeMetrics:function(e){var x=0;var z=0;if(this.toolbarDisplayed){x+=y.get_vizToolbarHeight()}x+=y.get_authoringToolbarHeight();x+=y.get_authoringMastheadHeight();x+=y.get_authoringTabsHeight();x+=y.get_tabsHeight();if(!tsConfig.is_mobile){x+=2*y.get_authoringVizBorderWidth();z+=2*y.get_authoringVizBorderWidth()}if(e==='worksheet'){x+=y.get_authoringShelfHeight();z+=y.get_authoringShelfWidth();z+=this.get_authoringLeftAreaWidth();if(!tsConfig.is_mobile){x+=y.get_authoringVizMargin();z+=y.get_authoringVizMargin()}}else if(e==='dashboard'||e==='story'){z+=this.get_authoringLeftAreaWidth()}z+=this.get_rightAreaDrawerWidth();return{w:z,h:x}},getWebClientContentSizeForViewingOnly:function(){var e=this.getViewport();var x=this.chromeMetricsForViewingOnly();e.h-=x.h;e.w-=x.w;return this.adjustForMinMaxDashboardSizes(e)},chromeMetricsForViewingOnly:function(){var e=0;if(this.toolbarDisplayed){e+=y.get_vizToolbarHeight()}e+=y.get_tabsHeight();return{w:0,h:e}},showLoadIndicators:function(e,x){if(ss.isValue(e)){e.style.display='block'}if(ss.isValue(x)){x.style.cursor='wait'}},hideLoadIndicators:function(e,x){if(!ss.isNullOrUndefined(e)){e.style.display='none'}if(!ss.isNullOrUndefined(x)){x.style.cursor='default'}},clearSession:function(){if(!this.clearSessionOnUnload){return}var e=(new o(tsConfig.sessionid)).formatSessionMethod('clear');var x=function(){};v.xhrPostJson(e,null,x,x,false)},markInitialLayoutModelAsFinished:function(e,x){this.initialLayoutError=x;this.initialLayoutModel=e;delete this['_onSuccess']},appendSecondaryResponse:function(e){if(ss.isValue(this.secondaryResponses)){this.secondaryResponses.push(e)}else{this.secondaryResponses=[e]}},scaleImageToFit:function(e){var x=e.style.backgroundImage.replace(new RegExp('"','g'),'').replace(new RegExp('url\\((.*)\\)','gi'),'$1');var z=document.createElement('img');var A=ss.mkdel(this,function(){var C=this.getWebClientContentSizeForViewingOnly();var D=this.chromeMetricsForViewingOnly();var E={w:C.w+D.w-parseInt(e.style.left,10),h:C.h+D.h-parseInt(e.style.top,10)};if(ss.Int32.div(E.h,z.height)<ss.Int32.div(E.w,z.width)){var F=Math.round(E.h*z.width/z.height);e.style.backgroundSize=F+'px '+E.h+'px'}else{var G=Math.round(E.w*z.height/z.width);e.style.backgroundSize=E.w+'px '+G+'px'}});if(ss.isValue(z.addEventListener)){z.addEventListener('load',A,false)}else if(ss.isValue(z.attachEvent)){z.attachEvent('onload',function(){A(null)})}else{z.onload=A}var B=function(){tsConfig.bootstrapOnMouseover=false;if(ss.isNullOrUndefined(e)){return}if(ss.isValue(e.dispatchEvent)){var C=document.createEvent('MouseEvents');C.initMouseEvent('mouseover',true,true,window.self,null,0,0,0,0,false,false,false,false,null,null);e.dispatchEvent(C)}else if(ss.isValue(e['fireEvent'])){e['fireEvent']('onmouseover')}};if(ss.isValue(z['addEventListener'])){z.addEventListener('error',B,false)}else if(ss.isValue(z['attachEvent'])){z.attachEvent('onerror',function(){B(null)})}else{z['onerror']=B}z.src=x}});ss.initClass(y,a,{});ss.setMetadata(u,{enumFlags:true});(function(){b.crossDomainEventNotificationId='xdomainSourceId';b.$0=0})();(function(){g.$1='en-us'})();(function(){window.onerror=ss.delegateCombine(window.onerror,function(e,x,z,A,B){return h.$0(e)});h.$2();g.$0()})();(function(){i.$1=null})();(function(){s.getTiming=null;s.recordingStart=0;s.$2=0;s.$3=null;s.$4=null;s.recordingStart=(new Date).getTime();if(ss.isValue(window)&&ss.isValue(window.self.performance)&&ss.isValue(window.self.performance['now'])){if(ss.isValue(window.self.performance.timing)){s.$2=window.self.performance.timing.responseStart-window.self.performance.timing.navigationStart}else{s.$2=0}s.getTiming=function(){return window.self.performance.now()-s.$2}}else{s.$2=(new Date).getTime();s.getTiming=function(){return(new Date).getTime()-s.$2}}s.$3={};s.$3['none']=0;s.$3['navigation']=1;s.$3['bootstrap']=2;s.$3['rendering']=4;s.$3['commands']=8;s.$3['toolbar']=64;s.$3['hittest']=16;s.$3['debug']=32;s.$3['fonts']=128;s.$3['min']=3;s.$3['core']=15;s.$3['all']=255})();(function(){v.$e=20;v.$d=null;v.CLIENTNO='cn';v.$d=v.$0()})();(function(){w.ipadImageSizeLimit=5242880;w.$1=1200;w.$2=ss.mkdict(['phone','phone','tablet','tablet','desktop','desktop','default','default']);w._instance=null})();(function(){y.toolbarHeight=27;y.largeToolbarHeight=60;y.tabsHeightPx=23;y.$0=60;y.$1=44})()})();var viewerBootstrap=tabBootstrap.ViewerBootstrap.get_instance();viewerBootstrap.bootstrap();viewerBootstrap.showLyteboxIfNeeded()})();