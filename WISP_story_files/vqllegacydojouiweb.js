/*! BEGIN LegacyDojoUI */
(function(){"dont use strict";var t={},tr,rf,h,uf,c,l,ci,pt,ir,o,r,li,wt,ff,rr,p,ti,ur,fr,er,or,ai,et,sr,ii,s,lt,hr,cr,ri,ef,bt,lr,ot,n,ui,ar,vr,vi,yr,fi,pr,of,wr,br,a,kr,kt,u,dr,sf,hf,it,ei,rt,gr,cf,st,k,i,v,dt,f,nu,gt,ut,yi,pi,ht,wi,bi,ki,ct,g,tu,iu,ru,ni,uu,fu,eu,nt,di,at,ft,gi,ou,su,vt,hu,cu,lu,tt,au,nr,e,vu,oi,yt,yu,pu,w,wu,d,bu,ku,du,b,gu,si,nf,tf,hi,y;global.tab=global.tab||{};ss.initAssembly(t,"vqllegacydojoui");tr=function(){spiff.Template.call(this,$("<div class='tabHorizontalSlider'>\n<\/div>'"))};tr.__typeName="tab.$0";rf=function(n,t,i,r,u){this.$6=!1;this.$a=0;this.$7=null;this.$8=null;this.$9=null;this.$a=n;this.$6=t;this.$7=i;this.$8=r;this.$9=u};rf.__typeName="tab.$1";h=function(n,t,i){this.dropdown=null;this.menuNode=null;this.glass=null;this.dropdownLabelContainer=null;this.fillListElement=null;this.searchBox=null;this.currentlySelected=0;this.multimode=!1;this.$k=!1;this.$j=!1;l.call(this,n,t,i);this.searchBox=n.get_searchWidget();this.searchBox.setStyle(1);var r=ss.mkdel(this,function(){this.hideMenu()});this.searchBox.add_escapeKeyPressed(r);this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.searchBox.remove_escapeKeyPressed(r)})));this.$j=!1};h.__typeName="tab.BaseDropdown";global.tab.BaseDropdown=h;uf=function(){};uf.__typeName="tab.BaseLegacyDojoUIModule";global.tab.BaseLegacyDojoUIModule=uf;c=function(n){var t=function(t,i){this.$c=null;ss.makeGenericType(spiff.BaseView$1,[n]).call(this,t,i)};return ss.registerGenericClassInstance(t,c,[n],{get_legendViewModel:function(){return this.get_viewModel()},get_baseLegendTemplate:function(){return this.get_template()},get_legendTooltip:function(){return this.$9(),this.$c},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this)},dispose:function(){ss.isValue(this.$c)&&(this.$c.remove_ubertipCommandExecuted(ss.mkdel(this,this.$a)),this.$c.dispose());ss.makeGenericType(spiff.BaseView$1,[n]).prototype.dispose.call(this)},drawTitle:function(){this.get_baseLegendTemplate().titleArea.html(this.get_legendViewModel().get_titleHtml());tab.FormattingConverters.cleanUpFontFamilyStyles(this.get_baseLegendTemplate().titleArea);this.$b(this.get_legendViewModel().get_titleInline());tableau.util.setupTitleEllipsis(this.get_baseLegendTemplate().titleArea)},$b:function(n){var t="",i="";n?(this.get_baseLegendTemplate().titleArea.width(this.get_legendViewModel().get_titleWidth()),t="inline-block",i="top"):(this.get_baseLegendTemplate().titleArea.width(""),this.get_baseLegendTemplate().titleArea.height(this.get_legendViewModel().get_titleHeight()));this.get_baseLegendTemplate().titleArea.css("display",t);this.get_baseLegendTemplate().titleArea.css("vertical-align",i);ss.isValue(this.get_baseLegendTemplate().get_contentArea())&&this.get_baseLegendTemplate().get_contentArea().css("display",t);ss.isValue(this.get_baseLegendTemplate().titleControls)&&(this.get_legendViewModel().get_backgroundColor().get_a()<1?this.get_baseLegendTemplate().titleControls.css("background-color","white"):this.get_baseLegendTemplate().titleControls.css("background-color",this.get_legendViewModel().get_backgroundColor().toRgba()))},highlighterFitsUpperRight:function(){var n=!this.get_legendViewModel().get_titleInline();return this.get_legendViewModel().get_hasTitle()&&n?!0:!1},$a:function(n,t){tab.UberTipClientCommands.executeUbertipCommand(t.command)},makeTooltip:function(){var n=this.get_legendViewModel().$6();return ss.isNullOrUndefined(n)?null:tab.ObjectRegistry.newLegacyTooltip(tab.TooltipBaseLegacyMode).call(null,tab.TooltipBaseLegacyMode,null,n)},$9:function(){if(ss.isNullOrUndefined(this.$c)){if(this.$c=this.makeTooltip(),ss.isNullOrUndefined(this.$c))return;this.$c.add_ubertipCommandExecuted(ss.mkdel(this,this.$a))}},showContextMenu:null},function(){return ss.makeGenericType(spiff.BaseView$1,[n])},function(){return[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[n])]}),t.controlsMargin=2,t};c.__typeName="tab.BaseLegendView$1";ss.initGenericClass(c,t,1);global.tab.BaseLegendView$1=c;l=function(n,t,i){this.div=null;this.focusedId=null;this.listItemFocusHandler=null;this.parent=null;this.attributes=null;this.pendingManager=null;this.apply=null;this.cancel=null;this.disposables=new tab.DisposableHolder;this.tiledWidget=null;this.$2$1=null;this.$2$2=0;this.$2$3=null;Object.call(this);this.parent=n;this.div=t;this.listItemFocusHandler=ss.mkdel(this,this.$0);this.attributes={};ss.isValue(i)&&(this.attributes=i)};l.__typeName="tab.BaseMode";global.tab.BaseMode=l;ci=function(n,t,i,r,u,f){this.column=null;this.$1=null;spiff.Template.call(this,$("<span class='tabLegendItemColumn'/>"));this.column=this.domRoot;this.$1=[];for(var e=0;e<n;++e)this.$1[e]=new pt(r,u,f),o.setDomNodeStyleSize(this.$1[e].domRoot,t,i),this.column.append(this.$1[e].domRoot)};ci.__typeName="tab.CategoricalLegendColumnHtmlTemplate";global.tab.CategoricalLegendColumnHtmlTemplate=ci;pt=function(n,t,i){var u,e,f,r,s;this.item=null;this.itemSwatch=null;this.itemLabelHolder=null;this.itemLabel=null;this.renderContext=null;this.canvasElt=null;spiff.Template.call(this,$("<div class='tabLegendItem'><span class='tabLegendItemSwatchHolder'><\/span><span class='tabLegendItemLabelHolder'><span class='tabLegendItemLabel' /><\/span><\/div>"));this.item=this.domRoot;u=this.getElementBySelector(".tabLegendItemSwatchHolder");this.itemLabel=this.getElementBySelector(".tabLegendItemLabel");this.itemLabelHolder=this.getElementBySelector(".tabLegendItemLabelHolder");o.setDomNodeStyleSize(u,n.w,n.h);e=ss.isValue(t)?"<span class='tabLegendItemSwatch' />":"<canvas class='tabLegendItemSwatch' />";u.append($(e));this.itemSwatch=this.getElementBySelector(".tabLegendItemSwatch");ss.isNullOrUndefined(t)?(f=this.itemSwatch.get(0),this.renderContext=tab.CanvasRenderer.getRenderContext(f,"transparent"),this.canvasElt=f,tab.CanvasUtil.sizeCanvasWithHighDPISupport(this.canvasElt,this.renderContext,n)):(r={l:t.l,t:t.t,w:t.w,h:t.h},i&&(s=1,r.w-=2,r.h-=2,this.itemSwatch.css("border-width",s+"px"),this.itemSwatch.css("border-style","none")),o.setDomNodeStyleSize(this.itemSwatch,r.w,r.h),this.itemSwatch.css("top",r.t+"px"),this.itemSwatch.css("left",r.l+"px"),this.renderContext=null)};pt.__typeName="tab.CategoricalLegendItemHtmlTemplate";global.tab.CategoricalLegendItemHtmlTemplate=pt;ir=function(n){this.panel=null;this.columnsHolder=null;this.columnHolder=null;this.highlighterButton=null;this.contextMenuButton=null;f.call(this,n);this.panel=this.domRoot;this.panel.append($("<div class='tabLegendTitleControls'><div class='tabLegendHighlighterButton tabLegendTitleControlsButtons'><div class='tabLegendHighlighterButtonIcon'/><\/div><div class='tabLegendContextMenuButton tabLegendTitleControlsButtons'><div class='tabLegendContextMenuButtonIcon'/><\/div><\/div>"));this.columnsHolder=this.getElementBySelector(".tabLegendContentHolder");this.columnHolder=this.getElementBySelector(".tabLegendColumnHolder");this.titleControls=this.getElementBySelector(".tabLegendTitleControls");this.highlighterButton=this.getElementBySelector(".tabLegendHighlighterButton");this.contextMenuButton=this.getElementBySelector(".tabLegendContextMenuButton");this.highlighterButton.attr("title",tab.Strings.LegendPanelHighlightSelectedItems);this.contextMenuButton.attr("title",tab.Strings.TabAuthColorEditLegendButtonTooltip)};ir.__typeName="tab.CategoricalLegendTemplate";global.tab.CategoricalLegendTemplate=ir;o=function(n,t){var f,e,i,u;this.viewportWidth=0;this.viewportHeight=0;this.viewportOffset=null;this.$v=[];this.$y=null;this.$w=null;this.$x=null;ss.makeGenericType(c,[r]).call(this,n,t);this.showOrHideTitleControls(!1);this.get_catLegendTemplate().contextMenuButton.toggle(this.get_catLegendViewModel().get_shouldShowContextMenu());this.get_catLegendTemplate().highlighterButton.toggle(this.get_catLegendViewModel().get_shouldShowHighlighter());n.selectionChanged=ss.delegateCombine(n.selectionChanged,ss.mkdel(this,this.onSelectionChanged));f=ss.mkdel(this,this.onFocus);e=ss.mkdel(this,function(){this.showOrHideTitleControls(!1)});this.element[0].addEventListener("focus",f,!0);this.element[0].addEventListener("blur",e,!0);this.disposables.add(ss.mkdel(this,function(){n.selectionChanged=ss.delegateRemove(n.selectionChanged,ss.mkdel(this,this.onSelectionChanged));this.element[0].removeEventListener("focus",f,!0);this.element[0].removeEventListener("blur",e,!0)}));this.element.on("keydown",ss.mkdel(this,this.onKeyDown));this.get_catLegendViewModel().get_shouldShowContextMenu()&&(i=new spiff.Button(this.get_catLegendTemplate().contextMenuButton),i.add_click(ss.mkdel(this,this.showContextMenu)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){i.remove_click(ss.mkdel(this,this.showContextMenu));tab.MiscUtil.dispose$1(i)}))));n.get_shouldShowHighlighter()&&(u=new spiff.Button(this.get_catLegendTemplate().highlighterButton),u.add_click(ss.mkdel(this,this.onLegendHighlighterButtonTapped)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){u.remove_click(ss.mkdel(this,this.onLegendHighlighterButtonTapped));tab.MiscUtil.dispose$1(u)}))))};o.__typeName="tab.CategoricalLegendView";o.setDomNodeStyleSize=function(n,t,i){n.css("width",t+"px");n.css("height",i+"px")};global.tab.CategoricalLegendView=o;r=function(n,t,i,r){this.legendType=null;this.$r=null;this.$w=null;this.$s=null;this.$v=null;this.$p=null;this.$u=null;this.$t=0;this.$q=0;this.selectionChanged=null;v.call(this,i,r);this.legendType=t;this.$r=n;this.$r.add_legendChanged(ss.mkdel(this,this.$f));this.$r.add_legendNameChanged(ss.mkdel(this,this.$e));var u=this.get_visualModel();this.$v=u.get_selectionsModel().getLegendSelection(this.get_legendTypeEnum(),this.$l());this.$v.add_newSelection(ss.mkdel(this,this.$g));this.$p=u.get_brushingsModel().getLegendSelection(this.get_legendTypeEnum(),this.$l());this.$p.add_newSelection(ss.mkdel(this,this.$g));u.get_selectionsModel().add_newSelections(ss.mkdel(this,this.$g));this.$w=this.legendType==="color"?tab.ColorModel.fromColorCode(this.$h().swatchBgColor):this.$k();this.get_visualModel().add_emptyHighlightFogAllChanged(ss.mkdel(this,this.$d));this.$f()};r.__typeName="tab.CategoricalLegendViewModel";r.legendShouldBeGrayed=function(n,t,i,r){return n&&t&&!i?!1:i||t||r};global.tab.CategoricalLegendViewModel=r;li=function(n){this.$2=null;this._anchorIndex=-1;this._selectedIndexes=[];this._lastRangeSelectionIndex=-1;this.changelist=null;this._applyTimer=null;this.$2=n};li.__typeName="tab.CategoricalSelection";global.tab.CategoricalSelection=li;wt=function(){this.$0=null;this.$0=[]};wt.__typeName="tab.Changelist";global.tab.Changelist=wt;ff=function(){};ff.__typeName="tab.ChangeType";global.tab.ChangeType=ff;rr=function(t,i,r){h.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml))};rr.__typeName="tab.CheckDropdown";global.tab.CheckDropdown=rr;p=function(n,t,i){this.checkListContainer=null;this.$3=null;l.call(this,n,t,i);this.set_itemFormatter(p.getFilterItemHtml)};p.__typeName="tab.Checklist";p.addAllItem=function(t,i,r,u,f,e){var o=n.getAllItemHtml(i,r,u,f,e),s=t.append($(o).addClass("tab-ctrl-formatted-text"));n.filterItem.setChecked(s.children().get(0),f)};p.shouldCheckAllItem=function(n,t){return ss.isValue(t)&&ss.isValue(t.get_allItemCheckState())?ss.unbox(t.get_allItemCheckState()):n.all||n.allChecked&&!n.exclude||n.allNotChecked&&n.exclude};global.tab.Checklist=p;ti=function(n,t,i){oi.call(this,n,t,i);this.tileHtml="<div id='{1}' role='listbox' aria-multiselectable='true' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; position: absolute; width: 100%;\">"};ti.__typeName="tab.ChecklistContentFormatter";global.tab.ChecklistContentFormatter=ti;ur=function(){this.select=null;this.deselect=null;this.domain=null;this.select=[];this.deselect=[]};ur.__typeName="tab.CompiledChecklistChangelist";global.tab.CompiledChecklistChangelist=ur;fr=function(){this.index=0;this.domain=null};fr.__typeName="tab.CompiledRadiolistChangelist";global.tab.CompiledRadiolistChangelist=fr;er=function(){this.templateString="<div class='ConditionalsWidget tab-ctrl-formatted-text'><div class='Conditional' dojoAttachPoint='domCondition'><span dojoAttachPoint='domConditionTitle' class='ConditionalTitle'>Condition<\/span><br/><span dojoAttachPoint='domConditionText'><\/span><\/div><div class='Conditional' dojoAttachPoint='domLimit'><span dojoAttachPoint='domLimitTitle' class='ConditionalTitle'>Limit<\/span><br/><span dojoAttachPoint='domLimitText'><\/span><\/div><\/div>";this.isContainer=!1;this.domCondition=null;this.domConditionTitle=null;this.domConditionText=null;this.domLimit=null;this.domLimitTitle=null;this.domLimitText=null;Object.call(this)};er.__typeName="tab.ConditionalsWidget";global.tab.ConditionalsWidget=er;or=function(n,t,i){this.$2=0;this.$1=null;this.$0=null;ss.EventArgs.call(this);this.$2=n;this.$1=t;this.$0=i};or.__typeName="tab.ContentFetchedEventArgs";global.tab.ContentFetchedEventArgs=or;ai=function(n){this.viewModel=null;ss.makeGenericType(spiff.BaseView$1,[et]).call(this,n,new tr);this.viewModel=n;this.get_template().domRoot.addClass(this.viewModel.get_sliderClassName())};ai.__typeName="tab.ContinuousSlider";global.tab.ContinuousSlider=ai;et=function(n){this.$6=null;this.$2=0;this.$4=0;this.$5=0;this.$7=0;this.$8="";this.$3=!1;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$6=n;this.$2=n.get_currentFraction();this.$6.add_sliderFractionUpdated(ss.mkdel(this,this.currentFractionUpdated));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$6.remove_sliderFractionUpdated(ss.mkdel(this,this.currentFractionUpdated))})));this.$5=200;this.$3=!0};et.__typeName="tab.ContinuousSliderViewModel";global.tab.ContinuousSliderViewModel=et;sr=function(){this.baseClass="currentPagePanel";this.templateString="<div dojoAttachPoint='containerNode' baseClass='currentPagePanel'><div dojoAttachPoint='_titlePane' style='border:0; float:left; width:100%; overflow:hidden;'><\/div><div dojoType='dijit.layout.SplitContainer' persist='false' dojoAttachPoint='innerWrapper' orientation='${cpOrientation}' sizerWidth='0' dragRestriction='true' activeSizing='false' style='float:left; overflow: visible;'><div dojoType='dijit.layout.LayoutContainer' sizeShare='24' sizeMin='24' style='display:${display_dropdown};' dojoAttachPoint='buttonsContainer' ><button dojoAttachEvent='onClick:prevPage' dojoType='dijit.form.Button' layoutAlign='left' style='margin:0; margin-right:2px;' iconClass='dijitIcon cpLeftArrowBlack' showLabel='false' dojoAttachPoint='_leftBtn'><\/button><select dojoAttachEvent='onChange:onSelection' dojoType='tableau.base.widget.ui.iDropDownSelect' dojoAttachPoint='_dropdown' layoutAlign='client' autoWidth='true' minSize='100' hasDownArrow='true' popupExtraClass='${popupClass}'><\/select><button dojoAttachEvent='onClick:nextPage' dojoType='dijit.form.Button' layoutAlign='right' style='clear: left; margin:0; margin-left:2px;' iconClass='dijitIcon cpRightArrowBlack' showLabel='false' dojoAttachPoint='_rightBtn'><\/button><\/div><div dojoType='dijit.layout.ContentPane' sizeShare='24' sizeMin='24' style='display:${display_slider}; padding:6px 0 0 0; border:0; overflow: visible;' dojoAttachPoint='sliderPane'><div dojoAttachEvent='onChange:onSliderChange' dojoType='dijit.form.HorizontalSlider' slideDuration='0'pageIncrement='1' minimum='0' maximum='${maximum}' discreteValues='${discrete_values}' intermediateChanges='{0}' showButtons='false'dojoAttachPoint='_slider'><\/div><div dojoAttachPoint='_horizontalRuleNode'><\/div><\/div><\/div><div dojoType='dijit.layout.ContentPane' dojoAttachPoint='_checkboxPane' style='padding:0; height:16px; width:90px; display:${display_toggle}; border:0; position:relative; float:left;'><input dojoAttachEvent='onChange:onCheckboxChange' dojoType='dijit.form.CheckBox' dojoAttachPoint='_showHistoryCb'/><\/div><\/div>";this.widgetsInTemplate=!0;this.zid=0;this.sliderPane=null;this.show_toggle=!1;this.show_dropdown=!1;this.show_slider=!1;this.sheetid=null;this.session=null;this.lTitle=null;this.titleHtml=null;this.isDashboard=!1;this.pageViewModel=null;this.innerWrapper=null;this.cpHeight=0;this.buttonsContainer=null;this._started=!1;this._slider=null;this._showHistoryCb=null;this._rightBtn=null;this._leftBtn=null;this._horizontalRuleNode=null;this._dropdown=null;this._checkboxPane=null;this.rid=0;this.timestamp=0;this._horizontalRule=null;this.containerNode=null;this.titleSize=null;this.zoneTitleHeight=0;this.zoneTitleWidth=0;this.updating=!1;this._titlePane=null;this.pages=null;this.current_page=0;this.refreshed=!1;this.enable=!1;this.cpOrientation=null;this.display_dropdown=null;this.display_slider=null;this.display_toggle=null;this.maximum=0;this.discrete_values=0;this.show_ruler=null;this.ruler_count=0;this.popupClass=null;this.requestTimeout=null;this.rebuildLayoutTimeout=null;this.BUTTONS_HEIGHT=26;this.ONLY_BUTTONS=24;this.SLIDER_HEIGHT=22;this.ONLY_SLIDER=16;this.TOGGLE_HEIGHT=16;this.TOGGLE_WIDTH_OFFSET=90;this.RULE_OFFSET=5;this.DOM_OFFSET=4;this.WIDGET_SPACE=8;this.SCROLL_PAGES=14;this.backgroundColor=null;Object.call(this);this.templateString=ss.formatString(this.templateString,tab.FeatureFlags.isEnabled("PageCardImprovements"))};sr.__typeName="tab.CurrentPagePanel";global.tab.CurrentPagePanel=sr;ii=function(){this.firstPeriod=0;this.lastPeriod=0;this.isFutureIncluded=!0;this.periodType=null;this.anchorDateTime=null;this.fy=0;this.startOfWeek=1;this._applyTimer=null;this.domPreview=null;this.textLast=null;this.textCurr=null;this.textNext=null;this.textLastn1=null;this.textLastn2=null;this.textNextn1=null;this.textNextn2=null;this.textTodate=null;this.rangeType=null;this.radioTodate=null;this.rangeN=0;this.UPDATE_DELAY=800;this.inputLastn=null;this.inputNextn=null;this.lowestAllowedDate=new Date(1753,0,1);this.highestAllowedDate=new Date(9999,11,31);k.call(this)};ii.__typeName="tab.DateFilterWidget";global.tab.DateFilterWidget=ii;s=function(){};s.__typeName="tab.DojoUtils";s.localizeDojoLabeledControls=function(n){for(var r,u,i=n,f=i.length,t=0;t<f;t++)r=i[t].item1,u=i[t].item2,ss.isValue(r)&&r.attr("label",tab.Strings.getString(u))};s.disableTextSelection=function(n){if(typeof n.onselectstart=="function"){var t=spiff.EventUtil.stopEvent;n.onselectstart=t}else"MozUserSelect"in n.style&&(n.style.MozUserSelect="none");n.style.cursor="default"};s.setMarginBoxWidth=function(n,t){dojo.marginBox(n,ss.mkdict(["w",t]))};s.setMarginBoxHeight=function(n,t){dojo.marginBox(n,ss.mkdict(["h",t]))};global.tab.DojoUtils=s;lt=function(){};lt.__typeName="tab.DojoWidgets";lt.$0=function(){dojo.require("tableau.base.BaseClient");var n=null;n=[dijit._Widget];dojo.declare("tableau.base.widget.LegacyQuickFilterWidget",n,k.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget];dojo.declare("tableau.base.widget.DateFilterWidget",n,ii.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];a.prototype.templateString="<div class='CategoricalFilter' role='application'><div class='CategoricalFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='CFButton CFResetButton' showlabel='false'dojoAttachPoint='resetButton' dojoAttachEvent='onClick:toggleReset'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='CFButton CFSearchButton' showlabel='false'dojoAttachPoint='searchButton' dojoAttachEvent='onClick:toggleSearchUI'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='CFButton CFDomainButton' showlabel='false'dojoAttachPoint='domainButton' dojoAttachEvent='onClick:toggleDomain'iconClass='wcIconDomainAll'>Show Fewer Values<\/div><div dojoType='dijit.form.Button' dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'class='CFButton CFMenuButton' dojoAttachPoint='menuButton' name='type'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='CFContent' dojoAttachPoint='domContent'><\/div><div class='CFHorizScroll' dojoAttachPoint='domHorizScroll' dojoAttachEvent='onscroll:doscrollHoriz'><div dojoAttachPoint='domHorizScrollContent'><\/div><\/div><div dojoType='tableau.base.widget.ConditionalsWidget' dojoAttachPoint='conditionals'><\/div><\/div><\/div>";dojo.declare("tableau.base.widget.LegacyCategoricalQuickFilter",n,a.prototype);n=[dijit._Widget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.ConditionalsWidget",n,er.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.TabbedNavigation",n,w.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.CurrentPagePanel",n,sr.prototype);dojo.declare("tableau.base.widget.catmode.BaseMode",[dijit._Contained],l.prototype);dojo.declare("tableau.base.widget.catmode.Checklist",[tableau.base.widget.catmode.BaseMode],p.prototype);dojo.declare("tableau.base.widget.catmode.BaseDropdown",[tableau.base.widget.catmode.BaseMode],h.prototype);dojo.declare("tableau.base.widget.catmode.SimpleDropdown",[tableau.base.widget.catmode.BaseDropdown],vu.prototype);dojo.declare("tableau.base.widget.catmode.CheckDropdown",[tableau.base.widget.catmode.BaseDropdown],rr.prototype);dojo.declare("tableau.base.widget.catmode.Pattern",[tableau.base.widget.catmode.BaseMode],fu.prototype);dojo.declare("tableau.base.widget.catmode.Slider",[tableau.base.widget.catmode.BaseMode],yu.prototype);dojo.declare("tableau.base.widget.catmode.TypeIn",[tableau.base.widget.catmode.BaseMode],gu.prototype);dojo.declare("tableau.base.widget.catmode.Radiolist",[tableau.base.widget.catmode.BaseMode],ou.prototype);dojo.declare("tableau.base.widget.ui.iDropDownSelect",[dojox.form.DropDownSelect],pr.prototype);dojo.declare("tableau.base.widget.ui.Slider",[],yt.prototype);dojo.declare("tableau.base.widget.ui.TypeIn",[],b.prototype);dojo.declare("tableau.base.widget.ui.TypeInDateField",[b],si.prototype);dojo.declare("tableau.base.widget.ui.onClickOverride",null,ut.prototype);dojo.declare("tableau.base.widget.ui.iMenuItem",[dijit.MenuItem,ut],hi.prototype);dojo.declare("tableau.base.widget.ui.iCheckedMenuItem",[dijit.CheckedMenuItem,ut],tf.prototype);dojo.declare("tableau.base.widget.hsm.TreeModel",null,du.prototype);dojo.declare("tableau.base.widget.hsm.Tree",[dijit.Tree],bu.prototype);dojo.declare("tableau.base.widget.hsm._TreeNode",[dijit._TreeNode],ku.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyHierarchicalQuickFilter",n,u.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyQuantitativeQuickFilter",n,rt.prototype);n=[tableau.base.widget.DateFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.LegacyRelativeDateQuickFilter",n,i.prototype);n=[tableau.base.widget.LegacyQuickFilterWidget,dijit._Contained,dijit._Templated];dojo.declare("tableau.base.widget.RelativeDatePickFilter",n,tt.prototype);n=[tableau.base.widget.LegacyQuantitativeQuickFilter];dojo.declare("tableau.base.widget.LegacyQuantitativeDateQuickFilter",n,ei.prototype);n=[dijit._Widget,dijit._Templated];wi.prototype.templateString="<div class='ParameterControl' role='form'><div class='ParameterControlBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='ParamTitle' dojoAttachPoint='domTitleBar'><\/h3><\/div><div class='PCContent' dojoAttachPoint='domContent'><\/div><\/div><\/div>";dojo.declare("tableau.base.widget.ParameterControl",n,wi.prototype);dojo.declare("tableau.base.widget.paramui.Base",[dijit._Contained],g.prototype);dojo.declare("tableau.base.widget.paramui.TypeIn",[tableau.base.widget.paramui.Base],ni.prototype);dojo.declare("tableau.base.widget.paramui.TypeInDateField",[tableau.base.widget.paramui.Base],uu.prototype);dojo.declare("tableau.base.widget.paramui.Compact",[tableau.base.widget.paramui.Base],tu.prototype);dojo.declare("tableau.base.widget.paramui.List",[tableau.base.widget.paramui.Base],iu.prototype);dojo.declare("tableau.base.widget.paramui.Slider",[tableau.base.widget.paramui.Base],ru.prototype);n=[dijit._Widget,dijit._Templated,dijit._Contained];dojo.declare("tableau.base.widget.SearchWidgetBase",n,e.prototype);n=[tableau.base.widget.SearchWidgetBase];nr.prototype.templateString="<div class='Search' role='form'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick'><\/div><\/div>";dojo.declare("tableau.base.widget.SearchWidget",n,nr.prototype);dojo.declare("tableau.base.widget.SmallSearchWidget",[tableau.base.widget.SearchWidgetBase],pu.prototype);dojo.declare("tableau.base.widget.FilteringSearchWidget",[tableau.base.widget.SearchWidgetBase],ri.prototype);n=[dijit._Widget,dijit._Templated,dijit._Contained];dojo.declare("tableau.base.widget.TypeInFilterContents",n,nf.prototype);n=[dijit.layout._LayoutWidget,dijit._Templated];dojo.declare("tableau.base.widget.FilterPanel",n,ar.prototype)};global.tab.DojoWidgets=lt;hr=function(n,t,i){this.$2=0;this.$0=null;this.$1=null;this.$2=n;this.$0=t;this.$1=i};hr.__typeName="tab.FetchInfo";global.tab.FetchInfo=hr;cr=function(n,t,i){this.$4=null;this.$9=null;this.$3=null;this.$7=null;this.$8=null;this.$6=5;this.$5=!1;this.$1$1=null;this.$4=t;this.$9=n;this.$3=i;this.$7=[];this.$8=[]};cr.__typeName="tab.FilterContentFetcher";global.tab.FilterContentFetcher=cr;ri=function(){this.templateString="<div class='Search FilteringSearch'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' aria-multiline='false' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onclick:focusQueryBox,onfocus:focusQueryBox' title='${SEARCH_TOOLTIP}'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span>"+(tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")?"<span dojoAttachPoint='domScreenReaderStatus' class='sr-only' role='status' aria-live='polite'><\/span>":"")+"<\/div><\/div>";this.domQueryBox=null;this.domSearchButton=null;this.domSearchBusyImg=null;this.domScreenReaderStatus=null;this.$6=100;this.$7=null;this.$8=0;e.call(this)};ri.__typeName="tab.FilteringSearchWidget";global.tab.FilteringSearchWidget=ri;ef=function(){};ef.__typeName="tab.FilteringSearchWidgetStyle";global.tab.FilteringSearchWidgetStyle=ef;bt=function(){};bt.__typeName="tab.FilterItemBase";global.tab.FilterItemBase=bt;lr=function(){bt.call(this)};lr.__typeName="tab.FilterItemDesktop";global.tab.FilterItemDesktop=lr;ot=function(){bt.call(this)};ot.__typeName="tab.FilterItemMobile";ot.formatListRowFilterItemHtml=function(t,i,r,u){var l=n.getItemId(r,u),f=u===n.allItemIndex,e,c;e=f?i.s:t.isSingleSelect()?n.shouldCheckFilterItemSingleValue(i,t):n.shouldCheckFilterItemMultiValue(i,t);var a=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role),h=n.showFacets(t),v=h?tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role):"",o=ss.isValue(t.get_modeContents())&&ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(i,u),s=!1;return f?(c=ss.isValue(t.get_modeContents())?t.get_modeContents().pendingManager:null,s=p.shouldCheckAllItem(t.get_oFilter(),c)):(e&&!o||!e&&o)&&(s=!0),ot.getScrollingListRowHtml(l,a,v,f,s,h,o)};ot.getScrollingListRowHtml=function(n,t,i,r,u,f,e){return['<div class="ListRow',r?" rowAll":"",u?" checked":"",f?" Wide":"",e?" pending":"",'" id="_popup_',n,'">','<div class="facet">',i,"<\/div>",'<div class="checkArea">&nbsp;<\/div>','<div class="labelArea" style="margin-left: 28px;">',t,"<\/div><\/div>"].join("")};ot.formatRemovableListRowFilterItemHtml=function(t,i,r,u){var f=n.getItemId(r,u),e=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role);return ot.getScrollingListRemovableRowHtml(f,e)};ot.getScrollingListRemovableRowHtml=function(n,t){return['<div class="ListRow" id="_popup_',n,'" style="min-width: 270px; white-space: nowrap;"><div class="wcIconSearchRemoveContainer" style="margin-right:10px"><div class="wcIconSearchRemove" style="margin-right:10px">&nbsp;<\/div><\/div><div class="xRowlabelArea">',t,'<\/div><div style="clear:both;"><\/div><\/div>'].join("")};global.tab.FilterItemMobile=ot;n=function(){};n.__typeName="tab.FilterItemUtil";n.getBaseItemName=function(n,t){var i=t+"_"+n.get_oFilter().name;return ss.isValue(n.get_session())&&(i+=n.get_session().get_viewId()),i};n.getItemId=function(t,i){return tableau.format.escapeHTML(t+"_"+(i===n.allItemIndex?n.$1:i.toString()))};n.getIndexFromId=function(t){var i=n.$0(t),r=parseInt(i,10);return isNaN(r)?ss.referenceEquals(i,n.$1)?n.allItemIndex:n.unknownItemIndex:r};n.isAllItemId=function(t){return ss.referenceEquals(n.$0(t),n.$1)};n.getAllItemTuple=function(t,i){var r={d:n.$1,s:i,t:null};return r.f=[{t:"i",v:t}],r};n.getAllItemHtml=function(t,i,r,u,f){return f(t,n.getAllItemTuple(r,u),i,n.allItemIndex)};n.isAllOrAllChecked=function(n){return n.get_oFilter().all||n.get_oFilter().allChecked};n.isAllMode=function(n){return n.get_oFilter().all};n.addAllItemToTuples=function(n,t,i){var r=[];return r.push({d:tab.Strings.QuickFilterAll,s:t,t:[{t:"i",v:i}]}),$.merge(r,n)};n.shouldCheckFilterItemSingleValue=function(t,i){return t.s&&!(i.get_oFilter().exclude&&n.isAllOrAllChecked(i))};n.shouldCheckFilterItemMultiValue=function(t,i){return t.s||!i.get_oFilter().exclude&&n.isAllMode(i)};n.showFacets=function(n){return n.get_oFilter().showFacets&&n.get_modeContents().get_width()>100};n.resetPendingFilterItems=function(t,i){for(var r,u=0;u<t.length;u++)r=t[u],n.filterItem.isPending(r)&&(n.filterItem.togglePendingState(r),i&&n.filterItem.setChecked(r,!n.filterItem.isChecked(r)))};n.toggleClassState=function(n,t){var i=$(n),r=!i.hasClass(t);return i.toggleClass(t,r),r};n.getClassElement=function(n,t){for(var i=0;ss.isValue(n)&&i<5;i++,n=n.parentNode)if($(n).hasClass(t))return n;return null};n.$0=function(n){var t=n.split(String.fromCharCode(95));return t[t.length-1]};global.tab.FilterItemUtil=n;ui=function(n,t,i){this.$6=null;this.$4=null;this.$5=null;this.$3=null;this.$1=0;this.$2=0;this.$1$1=null;this.$6=$(n);this.$6.addClass("tiledContent");var r=document.createElement("div");this.$4=$(r);this.$4.css("left","0px");this.$4.css("position","relative");this.$4.css("height",t+"px");this.$4.css("width",this.$6.css("width")+"px");this.$4.addClass("tileContainer");this.$6.append(this.$4);this.$6.scroll(ss.mkdel(this,this.$0));this.$5=new Array(i)};ui.__typeName="tab.FilterListUI";global.tab.FilterListUI=ui;ar=function(){this.templateString="<div class='FilterPanel' dojoAttachPoint='containerNode' dojoAttachEvent='onmousedown:onMouseDown'><\/div>";this.session=null;this.field="";this.filter=null;this.format={};this.width=0;this.metricsOnly=!1;this.layoutSession=null;this.zid=0;this.quickFilterDisplayViewModel=null;this.$6=null;this.requestSetAttributes=null;this.titleHTML=null;this.$8=0;this.$9=0;this.attributes={};this.$7=null;this.textStyle=null;this.backgroundColor=null;Object.call(this);this.$6=new tab.DisposableHolder};ar.__typeName="tab.FilterPanel";global.tab.FilterPanel=ar;vr=function(n,t,i){this.$2=null;this.$0=null;this.$1=null;this.$2=n;this.$0=t;this.$1=i};vr.__typeName="tab.FormattingStyleInfo";global.tab.FormattingStyleInfo=vr;vi=function(){};vi.__typeName="tab.ICategoricalSelectionWidget";global.tab.ICategoricalSelectionWidget=vi;yr=function(){};yr.__typeName="tab.IContentFetcher";global.tab.IContentFetcher=yr;fi=function(){};fi.__typeName="tab.IContentFormatter";global.tab.IContentFormatter=fi;pr=function(){Object.call(this);this._stopClickEvents=!1};pr.__typeName="tab.IDropDownSelect";global.tab.IDropDownSelect=pr;of=function(){hi.call(this)};of.__typeName="tab.IMenuItem";global.tab.IMenuItem=of;wr=function(){};wr.__typeName="tab.ITiledGridModel";global.tab.ITiledGridModel=wr;br=function(){};br.__typeName="tab.ITiledWidgetUI";global.tab.ITiledWidgetUI=br;a=function(){this.widgetsInTemplate=!0;this.$g=null;this.getContextMenuCommands=null;this.requestSetAttributes=null;this.session=null;this.field="";this.filterViewModel=null;this.presModel=null;this.applyDelay=1e3;this.attributes={};this.isTypeInList=!1;this.domContent=null;this.domBox=null;this.searchDiv=null;this.resetButton=null;this.domainButton=null;this.menuButton=null;this.stateId=0;this.$i=null;this.singleSelectMenuItem=null;this.multiSelectMenuItem=null;this.inclusiveMenuItem=null;this.exclusiveMenuItem=null;this.getSID=null;this.mode=null;this.metricsOnly=!1;this.searchButton=null;this.domControls=null;this.width=0;this.modeContents=null;this.domHorizScroll=null;this.conditionals=null;this.showContextMenu=null;this.$h=null;this.$4$1=null;k.call(this);this.$g=new li(this);this.set_titleDomId(tab.DomUtil.generateUniqueId())};a.__typeName="tab.LegacyCategoricalQuickFilter";a.$0=function(n,t){var r,u,i,f;if(ss.isNullOrUndefined(n)||(r=n.table.tuples,u=t.table.tuples,r.length!==u.length))return!0;for(i=0,f=r.length;i<f;i++)if(!ss.referenceEquals(r[i].t[0].v,u[i].t[0].v))return!0;return!1};a.$1=function(n,t){if(ss.isNullOrUndefined(n))return!0;var r=ss.isValue(n.all)&&n.all,i=ss.isValue(t.all)&&t.all;return r!==i&&i};a.findFirstDesirableFocusable=function(n){var t,r,i,u;if(ss.isNullOrUndefined(n))return null;for(t=null,r=[".QueryBox",".FIItem[tabindex]",".CFContent [tabindex]","[tabindex]"],i=0;i<r.length;i++){if(u=r[i],ss.isValue(t)&&$(t).is(":focusable"))break;t=n.querySelector(u)}return t};global.tab.LegacyCategoricalQuickFilter=a;kr=function(n){this.$2=null;spiff.BaseViewModel.call(this);this.$2=n;this.$2.add_filterUpdated(ss.mkdel(this,this.handleUpdateFilterContent))};kr.__typeName="tab.LegacyCategoricalQuickFilterViewModel";global.tab.LegacyCategoricalQuickFilterViewModel=kr;kt=function(){};kt.__typeName="tab.LegacyFilterDropDownArrowTemplate";kt.getDropDownForColor=function(n){return"<svg focusable='false' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='12px' height='12px' viewBox='0 0 12 12' style='enable-background:new 0 0 12 12;' xml:space='preserve'><path style='fill:"+n+";' d='M4.9,6.9L2.1,3.3C2,3.2,2.1,3,2.2,3h5.6C8,3,8.1,3.2,8,3.3L5.2,6.9C5.1,7,4.9,7,4.9,6.9z'/><\/svg>"};global.tab.LegacyFilterDropDownArrowTemplate=kt;u=function(){this.templateString="<div class='HierarchicalFilter'><div dojoAttachPoint='domBox' class='HierarchicalFilterBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='HFButton HFSearchButton' showlabel='false'dojoAttachPoint='searchButton' dojoAttachEvent='onClick:toggleSearchUI'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='HFButton HFMenuButton' dojoAttachPoint='menuButton'name='type' dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='HFLevels tab-ctrl-formatted-coloronly' dojoAttachPoint='domLevelBox'><table cellspacing='2'><tr dojoAttachPoint='domLevelContainer'><\/tr><\/table><\/div><div class='HFSelection tab-ctrl-formatted-text' dojoAttachPoint='domContent'><\/div><div dojoType='tableau.base.widget.ConditionalsWidget' dojoAttachPoint='conditionals'><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.$c=[];this.session=null;this.field="";this.filterViewModel=null;this.$a=500;this.attributes={};this.stateId=0;this.domBox=null;this.domLevelBox=null;this.domContent=null;this.domControls=null;this.searchDiv=null;this.searchButton=null;this.RANGE_START="minValue";this.RANGE_END="maxValue";this.$b=null;this.$d=null;this.tree=null;this._applyTimer=null;this.searchWidget=null;this.menuButton=null;this.conditionals=null;this.domLevelContainer=null;this.metricsOnly=!1;this.getContextMenuCommands=null;this.showContextMenu=null;this.requestSetAttributes=null;k.call(this)};u.__typeName="tab.LegacyHierarchicalQuickFilter";u.$0=function(n,t){var i=tab.ColorModel.fromColorCode(t),f=tab.ColorModel.fromColorCode(n.color),c=tab.ColorModel.alphaCompositeSolidDest(tab.ColorModel.fromColorModelPlusAlpha(f,.235294118523598),i),l={"border-width":"1px","border-style":"solid","border-color":c.toRgb()},e,r;tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelNoneSelected",l);e=tab.ColorModel.alphaCompositeSolidDest(tab.ColorModel.fromColorModelPlusAlpha(f,.411764711141586),i);r={"border-color":e.toRgb()};tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelSomeSelected",r);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelAllSelected",r);var o=tab.ColorModel.fromColorCode(t),s=tab.ColorModel.alphaCompositeSolidDest(tab.ColorModel.fromColorModelPlusAlpha(i,.39215686917305),u.$8),h=tab.ColorModel.alphaCompositeSolidDest(tab.ColorModel.fromColorModelPlusAlpha(i,.549019634723663),u.$8);o.isLStarAboveThreshold(95)&&(s=u.$4,h=u.$2);var a={"background-color":s.toRgb()},v={"background-color":h.toRgb()},y={"background-color":o.toRgb()};tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelAllSelected",a);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelSomeSelected",v);tab.StyleUtil.appendCSSRule(".HFLevels td.HFLevelNoneSelected",y)};global.tab.LegacyHierarchicalQuickFilter=u;dr=function(n){this.$2=null;spiff.BaseViewModel.call(this);this.$2=n};dr.__typeName="tab.LegacyHierarchicalQuickFilterViewModel";global.tab.LegacyHierarchicalQuickFilterViewModel=dr;sf=function(n){this.domBox=null;this.domContent=null;this.highlighterButton=null;this.contextMenuButton=null;this.domImageBody=null;f.call(this,n);this.domBox=this.getElementBySelector(".LegendBox");this.domContent=this.getElementBySelector(".LegendContent");this.titleControls=this.getElementBySelector(".tabLegendTitleControls");this.highlighterButton=this.getElementBySelector(".tabLegendHighlighterButton");this.contextMenuButton=this.getElementBySelector(".tabLegendContextMenuButton");this.domImageBody=this.getElementBySelector(".LegendImageBody")};sf.__typeName="tab.LegacyLegendTemplate";global.tab.LegacyLegendTemplate=sf;hf=function(n,t){var i,u,r;this.legacyLegendViewModel=null;this.$i=null;this.$k=0;this.eventHandler=null;this.iterButtons=null;this.$j=0;this.bodyOffset={x:0,y:0};this.bodySize=null;ss.makeGenericType(c,[it]).call(this,n,t);this.legacyLegendViewModel=n;this.legacyLegendViewModel.add_newLegacyLegend(ss.mkdel(this,this.handleNewLegacyLegend));this.legacyLegendViewModel.add_validStateChanged(ss.mkdel(this,this.handleValidStateChanged));this.$g();i=!1;u=this.legacyLegendViewModel.get_shouldShowContextMenu();this.get_serverRenderedModel().isVisuallyCat?i=!0:(this.get_legendTemplate().highlighterButton.toggle(!1),i=u);i&&this.disposables.add$1(new spiff.HoverBehavior(this,null,ss.mkdel(this,this.$d),ss.mkdel(this,this.$e)));u&&(this.get_legendTemplate().contextMenuButton.show(),r=new spiff.Button(this.get_legendTemplate().contextMenuButton),r.add_click(ss.mkdel(this,this.showContextMenu)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){r.remove_click(ss.mkdel(this,this.showContextMenu));tab.MiscUtil.dispose$1(r)}))))};hf.__typeName="tab.LegacyLegendView";global.tab.LegacyLegendView=hf;it=function(n,t,i){this.$h=null;this.$j=null;this.$i=null;this.$3$1=null;this.$3$2=null;v.call(this,t,i);this.$h=n;this.$h.add_newLegacyLegend(ss.mkdel(this,this.handleNewLegacyLegend));this.get_visualModel().add_urlInfoCacheChange(ss.mkdel(this,this.$c));this.$j=i;this.$j.add_validStateChanged(ss.mkdel(this,this.handleZoneValidStateChanged))};it.__typeName="tab.LegacyLegendViewModel";global.tab.LegacyLegendViewModel=it;ei=function(n){this.$s=0;this.$q=null;this.$r=null;this.$p=!1;rt.call(this,n)};ei.__typeName="tab.LegacyQuantitativeDateQuickFilter";ei.mergeDateWithTime=function(n,t){return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()))};global.tab.LegacyQuantitativeDateQuickFilter=ei;rt=function(){this.templateString="<div class='QuantitativeFilter'><div class='QuantitativeFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='QFTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='QFButton QFResetButton' showlabel='false'dojoAttachPoint='resetButton' dojoAttachEvent='onClick:toggleReset'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='QFButton QFDomainButton' showlabel='false'dojoAttachPoint='domainButton' dojoAttachEvent='onClick:toggleDomain'iconClass='wcIconDomainAll'>Show Smaller Range<\/div><div dojoType='dijit.form.Button' class='QFButton QFMenuButton' name='type' dojoAttachPoint='menuButton'dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><\/div><div class='QFContent' dojoAttachPoint='domContent'><div class='QFReadout QFLowerBound tab-ctrl-formatted-border-hover' dojoAttachEvent='onclick:showLowerInput' dojoAttachPoint='domLowerBound'><div class='readoutText tab-ctrl-formatted-fixedsize' dojoAttachPoint='domLowerText'><\/div><input type='text' dojoAttachPoint='domLowerInput'><\/input><\/div><div class='QFReadout QFUpperBound tab-ctrl-formatted-border-hover' dojoAttachEvent='onclick:showUpperInput' dojoAttachPoint='domUpperBound'><div class='readoutText tab-ctrl-formatted-fixedsize' dojoAttachPoint='domUpperText'><\/div><input type='text' dojoAttachPoint='domUpperInput'><\/input><\/div><div dojoAttachPoint='domBar' class='QFSlider QFBar'><div dojoAttachPoint='domRange' class='QFRange' dojoAttachEvent='onmousedown:startRangeCapture'><div dojoAttachPoint='domHighlight' class='QFRangeHighlight'><\/div><\/div><\/div><span dojoAttachPoint='domLowerImg' class='QFSlider QFImg QFFilterLeft' dojoAttachEvent='onmousedown:startLowerCapture'><\/span><span dojoAttachPoint='domUpperImg' class='QFSlider QFImg QFFilterRight' dojoAttachEvent='onmousedown:startUpperCapture'><\/span><\/div><\/div><\/div>";this.getContextMenuCommands=null;this.requestSetAttributes=null;this.attributes={};this.widgetsInTemplate=!0;this.global=!1;this.templateRoot=null;this.session=null;this.field="";this.filterViewModel=null;this.presModel=null;this.$d=200;this.$e=null;this.$g=10;this.rid=0;this.timestamp=0;this.domContent=null;this.domControls=null;this.domLowerText=null;this.domUpperText=null;this.domLowerInput=null;this.domUpperInput=null;this.domBar=null;this.domRange=null;this.domHighlight=null;this.domLowerImg=null;this.domUpperImg=null;this.domLowerBound=null;this.domUpperBound=null;this.resetButton=null;this.menuButton=null;this.domainButton=null;this.lastLowerOffset=0;this.lastUpperOffset=0;this.classQF="QF";this.classQFButtonR="QFButtonR";this.classQFButtonHide="QFButtonHide";this.classQFDisabled="QFDisabled";this.classQFCenterText="QFCenterText";this.classQFHideButtons="QFHideButtons";this.classQFHideSlider="QFHideSlider";this.classQFHideReadout="QFHideReadout";this.classQFResetDisabled="QFResetDisabled";this.oCurrentMin=null;this.oCurrentMax=null;this.oRangeMin=null;this.oRangeMax=null;this.oDataMin=null;this.oDataMax=null;this.rangeMinOverride=null;this.rangeMaxOverride=null;this.previousMinVal=null;this.previousMaxVal=null;this.metricsOnly=!1;this.oMetrics=null;this.$i=null;this.precision=0;this.captureInfo=null;this.showInputStartValue=null;this.mode=null;this.showContextMenu=null;this.$f=null;this.$h=!1;k.call(this);tab.ServerFontLoader.get_instance().add_fontPreparationComplete(ss.mkdel(this,this.$1))};rt.__typeName="tab.LegacyQuantitativeQuickFilter";rt.$0=function(n,t){n.keyCode===13&&(spiff.EventUtil.stopEvent(n),t.blur())};global.tab.LegacyQuantitativeQuickFilter=rt;gr=function(n){this.$2=null;spiff.BaseViewModel.call(this);this.$2=n};gr.__typeName="tab.LegacyQuantitativeQuickFilterViewModel";global.tab.LegacyQuantitativeQuickFilterViewModel=gr;cf=function(n){this.$i=null;ss.makeGenericType(spiff.BaseView$1,[st]).call(this,n,new gi);this.$h().add_updateQuickFilterDisplay(ss.mkdel(this,this.$b));this.$h().add_resized(ss.mkdel(this,this.$f));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$h().remove_updateQuickFilterDisplay(ss.mkdel(this,this.$b))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$h().remove_resized(ss.mkdel(this,this.$f))})));this.$h().add_updateQuickFilterContent(ss.mkdel(this,this.$a));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$h().remove_updateQuickFilterContent(ss.mkdel(this,this.$a))})));this.$h().get_hasBorder()&&this.get_template().domRoot.addClass("tabBordered")};cf.__typeName="tab.LegacyQuickFilterDisplayView";global.tab.LegacyQuickFilterDisplayView=cf;st=function(n,t){this.$a=null;this.$6=null;this.$8=!0;this.$9=!0;this.$7=null;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$6=t;this.$6.add_filterUpdated(ss.mkdel(this,this.$5));this.$a=n;this.$a.add_quickFilterDisplayUpdated(ss.mkdel(this,this.handleUpdateQuickFilterDisplay));this.$a.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.$4));this.$3()};st.__typeName="tab.LegacyQuickFilterDisplayViewModel";global.tab.LegacyQuickFilterDisplayViewModel=st;k=function(){this.titleHTML=null;this.format={};this.backgroundColor=null;this.textStyle=null;this.domTitleBar=null;this.oFilter=null;this.titleH=0;this.titleW=0;Object.call(this)};k.__typeName="tab.LegacyQuickFilterWidget";global.tab.LegacyQuickFilterWidget=k;i=function(){this.templateString="<div class='RelativeDateFilter'><div class='RelativeDateFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='RDFButton RDFMenuButton' name='type' dojoAttachPoint='menuButton'dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><\/div><div dojoType='dijit.form.DropDownButton' dojoAttachPoint='domDropdownButton'><span class='RDText'>date description<\/span><div dojoType='dijit.TooltipDialog' dojoAttachPoint='domTooltipDialog'><div class='RelativeDateFilterDialog' dojoAttachPoint='domDialog'><div class='RangeButtonsBar'><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPYear'dojoAttachPoint='buttonYear' name='year'>Years<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPQuarter'dojoAttachPoint='buttonQuarter' name='quarter'>Quarters<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPMonth'dojoAttachPoint='buttonMonth' name='month'>Months<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPWeek'dojoAttachPoint='buttonWeek' name='week'>Weeks<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPDay'dojoAttachPoint='buttonDay' name='day'>Days<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPHour'dojoAttachPoint='buttonHour' name='hour'>Hours<\/div><div dojotype='dijit.form.ToggleButton' dojoAttachEvent='onClick:setPMinute'dojoAttachPoint='buttonMinute' name='minute'>Minutes<\/div><\/div><div class='vertSpacer topHR'><\/div><div class='radioLine'><div class='column1'><input class='rradio' type='radio' name='radio-${field}' value='last'dojoAttachPoint='radioLast' dojoAttachEvent='onclick:setRLast'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textLast' dojoAttachEvent='onclick:setRLast'><\/span><\/div><div class='column2'><input class='rradio' type='radio' name='radio-${field}' value='lastn'dojoAttachPoint='radioLastn' dojoAttachEvent='onclick:setRLastn'><\/input><div class='fakeRadio'><\/div><span class='rlabel alignLN' dojoAttachPoint='textLastn1' dojoAttachEvent='onclick:setRLastn'><\/span><input class='rtext' type='text' size='2' dojoAttachPoint='inputLastn' value='3'dojoAttachEvent='onkeyup:onTypingLast'><\/input><span class='spinner' dojoAttachPoint='lastSpinner'><div class='spinnerElement spinnerUp' dojoAttachPoint='lastUp'dojoAttachEvent='onmouseover:overLastUp,onmouseout:outLastUp,onclick:upLast'><\/div><div class='spinnerElement spinnerDown' dojoAttachPoint='lastDown'dojoAttachEvent='onmouseover:overLastDown,onmouseout:outLastDown,onclick:downLast'><\/div><\/span><span class='rlabel' dojoAttachPoint='textLastn2' dojoAttachEvent='onclick:setRLastn'><\/span><\/div><\/div><div class='radioLine'><div class='column1'><input class='rradio' type='radio' name='radio-${field}' value='curr'dojoAttachPoint='radioCurr' dojoAttachEvent='onclick:setRCurr'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textCurr' dojoAttachEvent='onclick:setRCurr'><\/span><\/div><div class='column2'><input class='rradio' type='radio' name='radio-${field}' value='nextn'dojoAttachPoint='radioNextn' dojoAttachEvent='onclick:setRNextn'><\/input><div class='fakeRadio'><\/div><span class='rlabel alignLN' dojoAttachPoint='textNextn1' dojoAttachEvent='onclick:setRNextn'><\/span><input class='rtext' type='text' size='2' dojoAttachPoint='inputNextn' value='3'dojoAttachEvent='onkeyup:onTypingNext'><\/input><span class='spinner' dojoAttachPoint='nextSpinner'><div class='spinnerElement spinnerUp' dojoAttachPoint='nextUp'dojoAttachEvent='onmouseover:overNextUp,onmouseout:outNextUp,onclick:upNext'><\/div><div class='spinnerElement spinnerDown' dojoAttachPoint='nextDown'dojoAttachEvent='onmouseover:overNextDown,onmouseout:outNextDown,onclick:downNext'><\/div><\/span><span class='rlabel' dojoAttachPoint='textNextn2' dojoAttachEvent='onclick:setRNextn'><\/span><\/div><\/div><div class='radioline'><div class='column1'><input class='rradio' type='radio' name='radio-${field}' value='next'dojoAttachPoint='radioNext' dojoAttachEvent='onclick:setRNext'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textNext' dojoAttachEvent='onclick:setRNext'><\/span><\/div><div class='column2'><input class='rradio' type='radio' name='radio-${field}' value='todate'dojoAttachPoint='radioTodate' dojoAttachEvent='onclick:setRTodate'><\/input><div class='fakeRadio'><\/div><span class='rlabel' dojoAttachPoint='textTodate' dojoAttachEvent='onclick:setRTodate'><\/span><\/div><\/div><div class='vertSpacer bottomHR'><\/div><div class='preview'><span dojoAttachPoint='domPreview'><\/span><\/div><\/div><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.session=null;this.field="";this.filterViewModel=null;this.stateId=0;this.rid=0;this.timestamp=0;this.$9=[];this.layoutSession=null;this.getContextMenuCommands=null;this.showContextMenu=null;this.zid=0;this.domText=null;this.domDropdownButton=null;this.domDialog=null;this.$a=[];this.buttonYear=null;this.buttonQuarter=null;this.buttonMonth=null;this.buttonWeek=null;this.buttonDay=null;this.buttonHour=null;this.buttonMinute=null;this.radioLast=null;this.radioCurr=null;this.radioNext=null;this.radioLastn=null;this.radioNextn=null;this.lastSpinner=null;this.nextSpinner=null;this.lastUp=null;this.lastDown=null;this.nextUp=null;this.nextDown=null;this.domNode=null;this.domTooltipDialog=null;this.menuButton=null;this.$7="RDFButtonR1";this.$6="RDFButtonHide";this.$8=new tab.DisposableHolder;this.getSID=null;this.attributes=null;this.requestSetAttributes=null;ii.call(this)};i.__typeName="tab.LegacyRelativeDateQuickFilter";i.get_anchoredDescriptions=function(){return ss.isNullOrUndefined(i.$1)&&i.$0(),i.$1};i.get_nonAnchoredDescriptions=function(){return ss.isNullOrUndefined(i.$2)&&i.$0(),i.$2};i.$0=function(){var e,o,t,u,n,f;for(i.$1={},i.$2={},e=tab.Strings,o=ss.Enum.getValues(hu),t=0;t<o.length;t++){var r=o[t],s={},h={},c=ss.Enum.getValues(cu);for(u=0;u<c.length;u++)n=c[u],f=ss.formatString("RelDateAnchored_{0}_{1}",n,r),s[n]=e[f],f=ss.formatString("RelDate_{0}_{1}",n,r),h[n]=e[f];i.$1[r]=s;i.$2[r]=h}};global.tab.LegacyRelativeDateQuickFilter=i;v=function(n,t){this.$b=null;this.$9=null;this.$a=null;spiff.BaseViewModel.call(this);this.$b=n;this.$9=t;this.$9.add_propertyChanged(ss.mkdel(this,this.$2));this.$9.add_zoneResized(ss.mkdel(this,this.$3));this.$2(this.$9,new tab.PropertyChangedEventArgs("newZoneParent"))};v.__typeName="tab.LegendBaseViewModel";global.tab.LegendBaseViewModel=v;dt=function(n,t,i,r,u){this.selectedItems=null;this.brushedItems=null;this.isHighlightingEnabled=!1;this.hasMarkNodeSelection=!1;this.isOneway=!1;this.selectedItems=n.slice(0);this.brushedItems=t.slice(0);this.isHighlightingEnabled=i;this.hasMarkNodeSelection=r;this.isOneway=u};dt.__typeName="tab.LegendSelectionState";dt.$0=function(n,t){var r=new Set,i,u;return tab.SetUtilities.addAll(ss.Int32).call(null,r,n),i=new Set,tab.SetUtilities.addAll(ss.Int32).call(null,i,t),u=tab.SetUtilities.symmetricDifferenceWith(ss.Int32).call(null,r,i),tab.SetUtilities.getValues(ss.Int32).call(null,u)};global.tab.LegendSelectionState=dt;f=function(n){this.legendContentArea=null;this.titleControls=null;this.titleArea=null;spiff.Template.call(this,n);this.titleArea=this.getElementBySelector(".tabLegendTitle")};f.__typeName="tab.LegendTemplate";global.tab.LegendTemplate=f;nu=function(n,t,i,r){var f;this.$1=0;this.$2=0;this.$4=0;this.$6=0;this.$5=0;this.$3=0;this.$0=null;this.$1=n;this.$2=t;this.$4=i;this.$6=r;this.$5=this.$1*this.$2;this.$3=Math.ceil(n/i);this.$0={};var e=0,u=i*t,o=this.$5;for(f=0;f<this.$3;++f){o<u&&(u=o);var s=new tab.IntegerRange(e,e+u-1),h=tab.IntegerRange.pixelToItemRange(s,t),c=new rf(f,!1,{x:0,y:e},h,"item");this.$0[f]=c;o-=u;e+=u}};nu.__typeName="tab.ListGridModel";global.tab.ListGridModel=nu;gt=function(){};gt.__typeName="tab.LocalSearch";gt.searchQueryMatchesText=function(n,t){var i=n.length,r;return n.charCodeAt(0)===39&&n.charCodeAt(i-1)===39?ss.referenceEquals(n.substr(1,i-2),t):n.charCodeAt(0)!==42&&n.charCodeAt(i-1)===42?t.indexOf(n.substr(0,i-1))===0:n.charCodeAt(0)===42&&n.charCodeAt(i-1)!==42?(r=t.lastIndexOf(n.substr(1,i-1)),r>=0&&r===t.length-(i-1)):n.charCodeAt(0)===42&&n.charCodeAt(i-1)===42?t.indexOf(n.substr(1,i-2))>=0:t.indexOf(n)>=0};gt.findMatches=function(n,t,i,r){var s=n.toLowerCase(),o=[],f=t.table.tuples,u,e;for(ss.isNullOrUndefined(r)&&(r=function(n){return n}),u=0;u<f.length;u++)e=i(f[u]),gt.searchQueryMatchesText(s,e.toLowerCase())&&o.push(r(f[u],e,u));return o};global.tab.LocalSearch=gt;ut=function(){this.$2=null;this.$3=tsConfig.is_mobile;dijit.MenuItem.call(this)};ut.__typeName="tab.OnClickOverride";global.tab.OnClickOverride=ut;yi=function(){spiff.Template.call(this,$("<div class='tab-page'><\/div>"))};yi.__typeName="tab.PageTemplate";global.tab.PageTemplate=yi;pi=function(n){this.pageViewModel=null;this.$a=null;ss.makeGenericType(spiff.BaseView$1,[ht]).call(this,n,new yi);this.pageViewModel=n;this.pageViewModel.add_newPage(ss.mkdel(this,this.handleNewPage));this.pageViewModel.add_resized(ss.mkdel(this,this.updatePageControl));this.pageViewModel.add_titleVisibilityChanged(ss.mkdel(this,this.updatePageControl));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_newPage(ss.mkdel(this,this.handleNewPage))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_resized(ss.mkdel(this,this.updatePageControl))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pageViewModel.remove_titleVisibilityChanged(ss.mkdel(this,this.updatePageControl))})))};pi.__typeName="tab.PageView";global.tab.PageView=pi;ht=function(n){this.$2=null;this.$2$1=null;this.$2$2=null;this.$2$3=null;spiff.BaseViewModel.call(this);this.$2=n;this.$2.add_newPage(ss.mkdel(this,this.handleNewPage));this.$2.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.handleParentZoneResized));this.get_pageModel().get_zoneModel().get_zoneCommonModel().add_changeZoneTitleVisibility(ss.mkdel(this,this.handleTitleVisibilityChanged));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$2.remove_newPage(ss.mkdel(this,this.handleNewPage))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$2.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.handleParentZoneResized))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$2.get_zoneModel().get_zoneCommonModel().remove_changeZoneTitleVisibility(ss.mkdel(this,this.handleTitleVisibilityChanged))})))};ht.__typeName="tab.PageViewModel";global.tab.PageViewModel=ht;wi=function(n){this.$e=!0;this.domBox=null;this.domControls=null;this.format={};this.getSID=null;this.session=null;this.$8="";this.$7={};this.stateId=0;this.$d=null;this.$c=null;this.domTitleBar=null;this.domContent=null;this.$9=0;this.$b=0;this.$a=null;this.backgroundColor=null;Object.call(this);this.session=n.session;this.$8=n.field;this.$9=n.titleH;this.$b=n.titleW;this.$a=n.titleHTML;this.format=n.format;this.backgroundColor=n.backgroundColor;this.$7=n.attributes;this.$d=n.viewModel};wi.__typeName="tab.ParameterControl";global.tab.ParameterControl=wi;bi=function(){spiff.Template.call(this,$("<div class='tab-parameter'><\/div>"))};bi.__typeName="tab.ParameterControlTemplate";global.tab.ParameterControlTemplate=bi;ki=function(n){this.$b=null;this.$a=null;ss.makeGenericType(spiff.BaseView$1,[ct]).call(this,n,new bi);this.$b=n;this.$b.add_newParameterControl(ss.mkdel(this,this.handleNewParameterControl));this.$b.add_resized(ss.mkdel(this,this.updateSize));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$b.remove_newParameterControl(ss.mkdel(this,this.handleNewParameterControl))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$b.remove_resized(ss.mkdel(this,this.updateSize))})));this.$b.get_hasBorder()&&this.get_template().domRoot.addClass("tabBordered")};ki.__typeName="tab.ParameterControlView";global.tab.ParameterControlView=ki;ct=function(n){this.$4=null;this.$2$1=null;this.$2$2=null;spiff.BaseViewModel.call(this);this.$4=n;this.$4.add_newParameterCtrl(ss.mkdel(this,this.$2));this.$4.get_zoneModel().get_zoneCommonModel().add_resizeZone(ss.mkdel(this,this.$3));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$4.remove_newParameterCtrl(ss.mkdel(this,this.$2))})));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$4.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.$3))})))};ct.__typeName="tab.ParameterControlViewModel";global.tab.ParameterControlViewModel=ct;g=function(n,t,i,r,u){this.disposables=null;this.parameterViewModel=null;this.parent=null;this.field=null;this.newValInFlight=null;this.div=null;this.attributes=null;Object.call(this);this.disposables=new tab.DisposableHolder;this.parent=n;this.div=t;this.field=i;this.attributes=r;this.parameterViewModel=u;this.newValInFlight=null};g.__typeName="tab.ParamUIBase";global.tab.ParamUIBase=g;tu=function(n,t,i,r,u){var e,o,h,f,s,c,l;for(this.$2=null,this.$1=null,g.call(this,n,t,i,r,u),e=new spiff.ComboBoxViewModel,e.set_menuTheme(1),e.set_menuStyleClass(this.parent.domNode.id+"_menu"),this.$2=e,this.$2.add_selectedItemChanged(ss.mkdel(this,this.$0)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.$2.remove_selectedItemChanged(ss.mkdel(this,this.$0))}))),o=this.get_legacyModel().domain,h=o.length,f=0;f<h;f++)s=new spiff.ComboBoxItem(null,o[f],f,""),this.$2.addItem(s),ss.referenceEquals(this.get_legacyModel().alias,o[f])&&this.$2.set_selectedItem(s);tab.ColorModel.fromColorCode(this.parent.get_backgroundColor()).isLuminanceAboveThreshold(.314999997615814)||this.$2.set_additionalMenuClass("tab-darkBackground");this.$1=tab.ObjectRegistry.newView(spiff.ComboBoxView).call(null,[this.$2]);c=new vr(this.parent.get_model().textStyle,this.parent.get_backgroundColor(),this.parent.get_model().lineHeight);y.applyFormattingByClassName(this.$2.get_menuStyleClass(),c,!0);l=this.$1.get_rootElement().find(".tabComboBoxButton")[0];l.innerHTML=kt.getDropDownForColor(this.parent.get_model().textStyle.color.toString());this.$1.addToDom($(this.div));this.disposables.add$1(this.$2);this.disposables.add$1(this.$1)};tu.__typeName="tab.ParamUICompact";global.tab.ParamUICompact=tu;iu=function(n,t,i,r,u){g.call(this,n,t,i,r,u)};iu.__typeName="tab.ParamUIList";global.tab.ParamUIList=iu;ru=function(n,t,i,r,u){this.slider=null;g.call(this,n,t,i,r,u)};ru.__typeName="tab.ParamUISlider";global.tab.ParamUISlider=ru;ni=function(n,t,i,r,u){this.widget=null;g.call(this,n,t,i,r,u)};ni.__typeName="tab.ParamUITypeIn";global.tab.ParamUITypeIn=ni;uu=function(n,t,i,r,u){ni.call(this,n,t,i,r,u)};uu.__typeName="tab.ParamUITypeInDateField";global.tab.ParamUITypeInDateField=uu;fu=function(n,t,i){this.widget=null;l.call(this,n,t,i)};fu.__typeName="tab.Pattern";global.tab.Pattern=fu;eu=function(n,t,i,r){this.domainActualSize=0;this.$6=!1;this.$5=!1;this.$8=null;this.$a=!1;this.$9=!1;this.$7=null;this.$4=null;this.parent=null;this.$1$1=null;this.$1$2=null;this.parent=n;this.domainActualSize=t;this.$6=i;this.$5=r;this.resetPendingChanges()};eu.__typeName="tab.PendingChangesManager";global.tab.PendingChangesManager=eu;nt=function(){};nt.__typeName="tab.QfButtonUtil";nt.enableResetButton=function(n){if(!ss.isNullOrUndefined(n)){var t=$(n.iconNode);t.removeClass("wcIconFiltered");t.removeClass("wcIconNonfiltered");t.addClass("wcIconFiltered");n.attr("label",tab.Strings.QuickFilterClearEnabled);n.setDisabled(!1);$(n.domNode.firstChild.firstChild).removeClass("tab-quickFilterButtonDisabled")}};nt.disableResetButton=function(n){if(!ss.isNullOrUndefined(n)){var t=$(n.iconNode);t.removeClass("wcIconFiltered");t.addClass("wcIconNonfiltered");n.attr("label",tab.Strings.QuickFilterClearDisabled);n.setDisabled(!0);t.removeClass("dijitButtonHover");t.removeClass("dijitHover");$(n.domNode.firstChild.firstChild).addClass("tab-quickFilterButtonDisabled")}};global.tab.QfButtonUtil=nt;di=function(){this.panel=null;this.contextMenuButton=null;this.ramp=null;this.centerMark=null;this.minLabel=null;this.maxLabel=null;f.call(this,$("\n            <div class='tabLegendPanel' style='position: relative; overflow: hidden'>\n                <div class='tabLegendTitleAndControls'>\n                    <h3 class='tabLegendTitle' style='position: absolute'><\/h3>\n                    <div class='tabLegendTitleControls'>\n                        <div class='tabLegendContextMenuButton' style='display:none;'>\n                            <div class='tabLegendContextMenuButtonIcon'><\/div>\n                        <\/div>\n                    <\/div>\n                <\/div>\n                <canvas class='tabLegendRamp' style='position: absolute'><\/canvas>\n                <div class='tabLegendCenterMark' style='position: absolute'><\/div>\n                <div class='tabLegendMinLabel' style='position: absolute'><\/div>\n                <div class='tabLegendMaxLabel' style='position: absolute'><\/div>\n            <\/div>"));this.panel=this.domRoot;this.titleControls=this.getElementBySelector(".tabLegendTitleControls");this.contextMenuButton=this.getElementBySelector(".tabLegendContextMenuButton");this.ramp=this.getElementBySelector(".tabLegendRamp");this.centerMark=this.getElementBySelector(".tabLegendCenterMark");this.minLabel=this.getElementBySelector(".tabLegendMinLabel");this.maxLabel=this.getElementBySelector(".tabLegendMaxLabel")};di.__typeName="tab.QuantitativeColorLegendTemplate";global.tab.QuantitativeColorLegendTemplate=di;at=function(n){if(ss.makeGenericType(c,[ft]).call(this,n,new di),this.$t().get_shouldShowContextMenu()){this.disposables.add$1(new spiff.HoverBehavior(this,null,ss.mkdel(this,this.$h),ss.mkdel(this,this.$i)));this.$s().contextMenuButton.show();var t=new spiff.Button(this.$s().contextMenuButton);t.set_hoverTooltipText(tab.Strings.TabAuthColorEditLegendButtonTooltip);t.add_click(ss.mkdel(this,this.showContextMenu));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){t.remove_click(ss.mkdel(this,this.showContextMenu));tab.MiscUtil.dispose$1(t)})))}};at.__typeName="tab.QuantitativeColorLegendView";at.setDomNodeStyleSize=function(n,t,i){n.css("width",t+"px");n.css("height",i+"px")};global.tab.QuantitativeColorLegendView=at;ft=function(n,t,i){this.$d=null;v.call(this,t,i);this.$d=n;this.$d.add_legendChanged(ss.mkdel(this,this.$c))};ft.__typeName="tab.QuantitativeColorLegendViewModel";global.tab.QuantitativeColorLegendViewModel=ft;gi=function(){spiff.Template.call(this,$("<div class='tab-quick-filter'><\/div>"))};gi.__typeName="tab.QuickFilterDisplayTemplate";global.tab.QuickFilterDisplayTemplate=gi;ou=function(t,i,r){this.$3=null;this.contentNode=null;l.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatRadiolistFilterItemHtml))};ou.__typeName="tab.Radiolist";global.tab.Radiolist=ou;su=function(n,t,i){ti.call(this,n,t,i);this.tileHtml="<div id='{1}' role='listbox' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; position: absolute; width: 100%;\">"};su.__typeName="tab.RadiolistContentFormatter";global.tab.RadiolistContentFormatter=su;vt=function(){this.range=null;this.index=0;this.type=0;this.checkState=!1};vt.__typeName="tab.RawChange";global.tab.RawChange=vt;hu=function(){};hu.__typeName="tab.RelativeDateFilterPeriodType";global.tab.RelativeDateFilterPeriodType=hu;cu=function(){};cu.__typeName="tab.RelativeDateFilterRangeType";global.tab.RelativeDateFilterRangeType=cu;lu=function(n){this.$2=null;spiff.BaseViewModel.call(this);this.$2=n};lu.__typeName="tab.RelativeDateFilterViewModel";global.tab.RelativeDateFilterViewModel=lu;tt=function(){this.templateString="<div class='RelativeDatePickFilter'><div dojoAttachPoint='domBox' class='RelativeDatePickFilterBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='RDFButton RDFMenuButton' name='type' dojoAttachPoint='menuButton'dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'><\/div><div class='PicklistContentDiv tab-ctrl-formatted-coloronly' dojoAttachPoint='domPicker'><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.session=null;this.field="";this.stateId=0;this.rid=0;this.timestamp=0;this.currentRange=null;this.layoutSession=null;this.zid=0;this.filterViewModel=null;this.currentAbbrev=null;this.showContextMenu=null;this.disposables=null;this.getContextMenuCommands=null;this.periodType=null;this.rangeType=null;this.rangeN=0;this.domPicker=null;this.getSID=null;this.$3=null;this.menuButton=null;k.call(this)};tt.__typeName="tab.RelativeDatePickFilter";global.tab.RelativeDatePickFilter=tt;au=function(n){this.$0=null;ss.EventArgs.call(this);this.$0=n};au.__typeName="tab.ScrolledEventArgs";global.tab.ScrolledEventArgs=au;nr=function(){this.templateString="<div class='Search'><div class='SearchBox tab-ctrl-formatted-border tab-ctrl-formatted-darker-border-hover' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick'><\/div><\/div>";this.domQuerySection=null;this.domQueryBox=null;this.domSearchAddButton=null;this.domSearchButton=null;this.domSearchBusyImg=null;this.domResults=null;this.$8=null;this.applyDelay=500;this.$9=100;this._bSearching=!1;this._queryBoxPasteTimeout=null;this._searchTimer=null;this._isFilterSearchable=!1;this._initializedSearchResults=!1;this._domResultsPBExtents=null;this._lastRemoteSearch=null;e.call(this);this.$8=new li(this)};nr.__typeName="tab.SearchWidget";global.tab.SearchWidget=nr;e=function(){this.isContainer=!1;this.domXButton=null;this.CANCEL_SEARCH_TOOLTIP=tab.Strings.QuickFilterSearchCancel;this.SEARCH_TOOLTIP=tab.Strings.QuickFilterSearchTooltip;this.ADD_ITEM_CTRL_ENTER=tab.Strings.QuickFilterSearchAddItemCtrlEnter;this.ADD_ITEM_ENTER=tab.Strings.QuickFilterSearchAddItemEnter;this.XBUTTON_CLOSE_TOOLTIP=tab.Strings.QuickFilterSearchCloseTooltip;this.XBUTTON_CLEAR_TOOLTIP=tab.Strings.QuickFilterSearchClearTooltip;this.NO_MATCHES=tab.Strings.QuickFilterSearchNoMatches;this.isVisible=!1;this.qf=null;this.oResults=null;this.resultCount=-1;this.searchDelay=400;this.busy_gif_url=null;this._isTypeInList=!1;this.$3$1=null;this.$3$2=null;Object.call(this)};e.__typeName="tab.SearchWidgetBase";global.tab.SearchWidgetBase=e;vu=function(t,i,r){h.call(this,t,i,r);this.set_itemFormatter(ss.mkdel(n.filterItem,n.filterItem.formatDropdownListFilterItemHtml))};vu.__typeName="tab.SimpleDropdown";global.tab.SimpleDropdown=vu;oi=function(n,t,i){this.$0=null;this.$2=null;this.$1=null;this.tileHtml="<div id='{1}' role='listbox' class=\"tile tab-ctrl-formatted-text\" style=\"top: {0}px; left: 0; right: 0; position: absolute; width: 100%;\">";this.$0=n;this.$2=t;this.$1=i};oi.__typeName="tab.SimpleListContentFormatter";global.tab.SimpleListContentFormatter=oi;yt=function(n,t,i,r,u,f,e,o,s){this.$h=null;this.styleid=0;this.$y=null;this.$D=-1;this.$t=["show-readout","hide-readout"];this.$x=["show-slider","hide-slider"];this.$e=["show-step-btns","hide-buttons"];this.$C=["show-ticks","hide-ticks"];this.div=null;this.$f=null;this.currentlySelected=0;this.numValues=0;this.$z=null;this.$A=null;this.slider=null;this.readout=null;this.$o=!1;this.$B=null;this.$j=null;this.$F=null;this.$q=null;this.$u=null;this.$p=!1;this.$m=null;this.$G=null;this.$v=!1;this.$l=null;this.$n=!1;this.$i=null;this.$r=null;this.$g=null;this.$w=!1;this.$s=!1;this.$k=null;this.$E=null;this.div=n;this.$f=t;this.$n=i;this.$i=r;this.$m=u;this.$l=f;this.$r=e;this.$k=o;this.$w=s;$(this.div).addClass("tableauWidgetUiSlider");this.$h=new tab.DisposableHolder;this.currentlySelected=-1};yt.__typeName="tab.Slider";global.tab.Slider=yt;yu=function(n,t,i){this.$3=null;this.$4=null;l.call(this,n,t,i)};yu.__typeName="tab.SliderCatmode";global.tab.SliderCatmode=yu;pu=function(){this.templateString="<div class='SmallSearch'><div class='SmallSearchBox' dojoAttachPoint='domSearchBox'><div class='Autocompleter' dojoAttachPoint='domAutocompleter'><\/div><div class='wcSearchX dijitInlineTable' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/div><\/div><\/div>";this.domSearchBox=null;this.domAutocompleter=null;this.autocompleter=null;e.call(this)};pu.__typeName="tab.SmallSearchWidget";global.tab.SmallSearchWidget=pu;w=function(n){var r,t,i;this.baseClass="tableauTabbedNavigation";this.templateString="<div style='width:${innerWidth};' class='tabbedNavigationOuterWrapper' role='navigation'><div id='container' dojoType='dijit.layout.LayoutContainer' style='width:100%; height:100%;' dojoAttachPoint='_innerWrapper'><button dojoType='dijit.form.Button' class='tabsMenuBtn' layoutAlign='left' id='menuBtn' dojoAttachPoint='_menuBtn' style='display:none;'><\/button><button dojoType='dijit.form.Button' class='tabsLeftBtn' layoutAlign='left' dojoAttachPoint='_leftBtn' style='display:none;'><\/button><button dojoType='dijit.form.Button' class='tabsRightBtn' layoutAlign='right' dojoAttachPoint='_rightBtn' style='display:none;'><\/button><div dojoType='dijit.layout.LayoutContainer' layoutAlign='client' dojoAttachPoint='_containerNode'><div class='dijitTabContainerTop-tabs' dojoAttachPoint='_scrollNode' role='tablist'><\/div><\/div><\/div><\/div>";this.widgetsInTemplate=!0;this.innerWidth="100%";this.selectedTabArrayIndex=0;this.$k=0;this.$o=null;this.$l=null;this.$m=new tab.DisposableHolder;this.$n=null;this.currentTab=null;this._scrollNode=null;this._leftBtn=null;this._rightBtn=null;this._menuBtn=null;this._containerNode=null;this._innerWrapper=null;this.$p=null;this._anim=null;this._buttons=null;Object.call(this);this.$o=[];this.$l=[];this.$o=tsConfig.visible_sheets||this.$o;r=this._indexOf(this.$o,tsConfig.current_sheet_name);t=r;ss.isNullOrUndefined(t)&&(t=this.selectedTabArrayIndex);this.selectedTabArrayIndex=t;this.innerWidth=n.innerWidth||this.innerWidth;i=ss.mkdel(this,function(){this.$g(this.currentTab)});tab.ServerFontLoader.get_instance().add_fontPreparationComplete(i);this.$m.add$1(new tab.CallOnDispose(function(){tab.ServerFontLoader.get_instance().remove_fontPreparationComplete(i)}))};w.__typeName="tab.TabbedNavigation";w.$2=function(n){var t=$(n.domNode);n.domNode.setAttribute("role","tab");n.domNode.setAttribute("aria-controls","tab-dashboard-region");t.find(".dijitTabButtonSpacer").attr("role","presentation");t.find(".tabLabel").removeAttr("wairole").removeAttr("role");t.find(".closeImage").removeAttr("wairole").removeAttr("role");w.$1(n.domNode,!1)};w.$0=function(n,t,i){n.setAttribute("role","button");n.setAttribute("aria-label",t);n.setAttribute("aria-disabled",i.toString());$(n).find("button")[0].tabIndex=-1};w.$1=function(n,t){n.setAttribute("aria-selected",t.toString());n.tabIndex=t?0:-1;$(n).find(".tabLabel").removeAttr("aria-pressed")};global.tab.TabbedNavigation=w;wu=function(n,t,i,r,u,f){this.$5=null;this.$7=null;this.$6=null;this.$9=null;this.$8=100;this.$5=n;this.$7=t;this.$6=r;this.$9=i;this.$6.isValid(u)&&this.$4(0,u);this.$5.add_contentFetched(ss.mkdel(this,this.$1));f?this.$3():this.$9.add_scrolled(ss.mkdel(this,this.$2))};wu.__typeName="tab.TiledWidget";global.tab.TiledWidget=wu;d=function(){};d.__typeName="tab.TiledWidgetFactory";d.createChecklist=function(n,t,i,r,u){var f=new ti(n,r,n.get_modeContents().get_itemFormatter());return d.createListTiledWidget(n,t,i,f,u)};d.createRadiolist=function(n,t,i,r,u){var f=new su(n,r,n.get_modeContents().get_itemFormatter());return d.createListTiledWidget(n,t,i,f,u)};d.createSimpleList=function(n,t,i,r,u){var f=new oi(n,r,n.get_modeContents().get_itemFormatter());return d.createListTiledWidget(n,t,i,f,u)};d.createListTiledWidget=function(n,t,i,r,u){var f=n.get_oFilter().isTiled&&tsConfig.filterTileSize>0?tsConfig.filterTileSize:n.get_oFilter().table.actual_size;i.style.position="relative";var e=n.get_oFilter().table.actual_size*u,o=!f?0:Math.ceil(n.get_oFilter().table.actual_size/f),s=new ui(i,e,o),h=tab.DomUtil.getMarginBox(i),c=new nu(n.get_oFilter().table.actual_size,u,f,h.h),l=new cr(n.get_session(),n.get_field(),n.get_domain()),a=t.slice(0,f);return new wu(l,c,s,r,a,!1)};global.tab.TiledWidgetFactory=d;bu=function(){this.model=null;this.anchor=null;this.prev_anchor=null;this.anchorIsStart=!1;this.$3$1=null;dijit.Tree.call(this)};bu.__typeName="tab.Tree";global.tab.Tree=bu;ku=function(){this.isChecked=!1;this.$1=null;this.tree=null;this.item=null;dijit._TreeNode.call(this)};ku.__typeName="tab.TreeNode";global.tab.TreeNode=ku;du=function(n,t,i,r){this.root=null;this.session=null;this.field=null;this.levels=0;this.isSingleSelect=!1;this.session=n;this.field=t;this.levels=i;this.isSingleSelect=r;this.root={};this.root.schema=null;this.root.tuple={d:null,s:!1,t:null};this.root.label="$ROOT$";this.root.level=-1;this.root.children=null};du.__typeName="tab.TreeSupport";global.tab.TreeSupport=du;b=function(n,t,i){this.queryBox=null;this.div=null;this.outerDiv=null;this.querySpan=null;this.$r=null;this.$v=null;this.goButton=null;this.$m=null;this.$l=null;this.$w=!1;this.$t=null;this.$q=null;this.$o=!1;this.$n=null;this.$x=!1;this.$A=null;this.$u=!1;this.$y=0;this.$s=null;this.$p=null;this.$z=null;this.div=n;this.$s=t;this.$A=i;this.div.classList.add("tableauWidgetUiTypeIn");this.$r=new tab.DisposableHolder};b.__typeName="tab.TypeIn";b.selectText=function(n,t,i){if(!ss.isNullOrUndefined(n)){if(typeof n.createTextRange=="function"){var r=n.createTextRange();r.collapse(!0);r.moveStart("character",t);r.moveEnd("character",i-t);r.select()}else typeof n.setSelectionRange=="function"?n.setSelectionRange(t,i):typeof n.selectionStart=="function"&&(n.selectionStart=t,n.selectionEnd=i);n.focus()}};global.tab.TypeIn=b;gu=function(n,t,i){this.isContainer=!0;this.$6=null;l.call(this,n,t,i)};gu.__typeName="tab.TypeInCatmode";global.tab.TypeInCatmode=gu;si=function(n,t,i,r){this.$H=null;this.$G=null;this.$J=null;this.$I=null;this.$M=null;this.$L=null;this.$K=null;b.call(this,n,t,i);this.$H=r;ss.isNullOrUndefined(this.$H)&&(this.$H=function(n){return new tab.DatePicker(n)})};si.__typeName="tab.TypeInDateField";global.tab.TypeInDateField=si;nf=function(){this.templateString="<div class='TypeInFilter'><div class='TIFItemsList tab-ctrl-formatted-text' dojoAttachPoint='domItemsList'dojoAttachEvent='onclick:_onItemsListClick,onmouseover:_onItemsListMouseOver,onmouseout:_onItemsListMouseOut,onkeydown:_onItemsKeyDown'><div class='wcIconSearchRemove' dojoAttachPoint='domXButton'dojoAttachEvent='onclick:_onXButtonClick,onmouseover:_onXButtonMouseOver,onmouseout:_onXButtonMouseOut'><\/div><\/div><div class='TIFButtonDiv' dojoAttachPoint='domClearListButtonDiv'><button class='TIFButton'dojoAttachEvent='onclick:_onClearListButtonClick'>Clear List<\/button><\/div><\/div>";this.isContainer=!1;this.parentFilter=null;this.tuples=null;this.itemName="";this.role=null;this.domItemsList=null;this.domXButton=null;this.domClearListButtonDiv=null;this.$0=null;Object.call(this)};nf.__typeName="tab.TypeInFilterContents";global.tab.TypeInFilterContents=nf;tf=function(){ut.call(this)};tf.__typeName="tab.UICheckedMenuItem";global.tab.UICheckedMenuItem=tf;hi=function(){ut.call(this)};hi.__typeName="tab.UIMenuItem";global.tab.UIMenuItem=hi;y=function(){};y.__typeName="tab.WidgetStyle";y.applyFormatting=function(n,t,i,r,u){y.$0(n.id,t,i,r,y.$2,u)};y.applyFormattingByClassName=function(n,t,i){y.$0(n,t.get_textStyleModel(),t.get_backgroundColor(),t.get_lineHeight(),y.$1,i)};y.$0=function(n,t,i,r,u,f){var s=n+"-style",e,h,o,c,l;tab.StyleUtil.clearStyleSheet(s);e=tab.FormattingConverters.makeFormatStyleDict(t);ss.isValue(r)&&(e["line-height"]=r+"px");ss.isNullOrUndefined(e["font-style"])&&(e["font-style"]="normal");ss.isNullOrUndefined(e["font-weight"])&&(e["font-weight"]="normal");ss.isNullOrUndefined(e["text-decoration"])&&(e["text-decoration"]="none");tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-text"),e);e["font-size"]=null;e["line-height"]=null;tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-fixedsize"),e);ss.isValue(t.color)&&(h={color:t.color},tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-coloronly"),h));o={};ss.isValue(t.color)&&(o["border-color"]=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(t.color),.7843137383461).toString(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-darker-border-hover:hover"),o),o["border-color"]=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(t.color),.411764711141586).toString(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-border"),o),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-border-hover:hover"),o));f&&ss.isValue(i)&&(c=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(i),.549019634723663),l=tab.ColorModel.alphaCompositeSolidDest(c,new tab.ColorModel(255,255,255,1)),o["background-color"]=l.toRgb(),tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-widget"),o),o["border-color"]=null,tab.StyleUtil.appendCSSRuleToStyleSheet$1(s,u(n,"tab-ctrl-formatted-widget:hover"),o))};y.$2=function(n,t){return'[id="'+n+'"].'+t+',[id="'+n+'"] .'+t};y.$1=function(n,t){return"."+n+"."+t+",."+n+" ."+t};global.tab.WidgetStyle=y;ss.initClass(tr,t,{},spiff.Template,[ss.IDisposable]);ss.initClass(rf,t,{$5:function(){return this.$a},$0:function(){return this.$6},$1:function(n){this.$6=n},$2:function(){return this.$7},$3:function(){return this.$8},$4:function(){return this.$9}});ss.initClass(l,t,{add_applyOrCancelClicked:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_applyOrCancelClicked:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},get_lineHeight:function(){return this.parent.get_presModel().lineHeight},get_width:function(){return this.$2$2},set_width:function(n){this.$2$2=n},get_itemFormatter:function(){return this.$2$3},set_itemFormatter:function(n){this.$2$3=n},get_scrollNode:function(){return null},instantiate:function(){},shouldNotReinstantiate:function(){return!1},updateContent:function(){},resetContent:function(){},updateTabIndexes:function(n,t){var r=$(n).find(".FIItem[tabindex=0]"),i;r.attr("tabindex","-1");i=document.getElementById(this.focusedId)||a.findFirstDesirableFocusable(n);ss.isValue(i)&&(i.classList.contains("FIItem")?i.setAttribute("tabindex","0"):$(n).find(".FIItem").first().attr("tabindex","0"),t&&i.focus())},$0:function(n){var t=$(n.target),i=t.closest(".FIItem");i.length>0?(this.focusedId=i[0].id,this.updateTabIndexes(n.currentTarget,!ss.referenceEquals(t[0],i[0]))):t.hasClass("QueryBox")&&(this.focusedId=null)},setUpForPendingChanges:function(){this.parent.shouldDeferChanges()&&(this.pendingManager=this.parent.makePendingChangesManager(),this.pendingManager.add_onPendingChanges(ss.mkdel(this,this.handlePendingChanges)),this.pendingManager.add_onNoPendingChanges(ss.mkdel(this,this.handleNoPendingChanges)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.pendingManager.remove_onPendingChanges(ss.mkdel(this,this.handlePendingChanges));this.pendingManager.remove_onNoPendingChanges(ss.mkdel(this,this.handleNoPendingChanges))}))),this.$1())},$1:function(){this.apply=spiff.LabelButton.newNativeButton();this.apply.addClass("apply");this.apply.set_label(tab.Strings.QuickFilterApply);this.apply.set_hoverTooltipText(tab.Strings.QuickFilterApply);this.apply.onClick(ss.mkdel(this,function(){this.resetPendingVisuals(!1);this.parent.applyPendingChangesByChangelist();this.$2()}));this.disposables.add$1(this.apply);this.cancel=spiff.LabelButton.newNativeButton();this.cancel.addClass("cancel");this.cancel.set_label(tab.Strings.QuickFilterCancel);this.cancel.set_hoverTooltipText(tab.Strings.QuickFilterCancel);this.cancel.onClick(ss.mkdel(this,function(){this.resetPendingVisuals(!0);this.parent.cancelPendingChangesByChangelist();this.$2()}));this.disposables.add$1(this.cancel);var n=ss.mkdel(this,function(){this.updateTabIndexes(this.div,!0)});this.add_applyOrCancelClicked(n);this.disposables.add(ss.mkdel(this,function(){this.remove_applyOrCancelClicked(n)}));this.initApplyAndCancelButtonStates()},initApplyAndCancelButtonStates:function(){this.apply.set_disabled(!0);this.cancel.set_disabled(!0)},appendApplyCancelButtons:function(n){var t=n.children(".CFApplyButtonContainer").first();this.parent.shouldDeferChanges()?(t.length<1&&(t=$("<div>").addClass("CFApplyButtonContainer"),n.append(t)),(ss.isNullOrUndefined(this.cancel)||ss.isNullOrUndefined(this.apply))&&this.setUpForPendingChanges(),t.append(this.cancel.element).append(this.apply.element).height(this.apply.element.outerHeight(!0)+"px")):t.detach()},layoutApplyButton:function(n){if(ss.isValue(n)){var r=tab.DoubleUtil.roundToInt(n.width()),u=parseInt(this.apply.element.css("margin-right")),t=Math.floor(r/2-u),i="max-width";this.apply.element.css(i,t+"px");this.cancel.element.css(i,t+"px")}},handlePendingChanges:function(){this.apply.set_disabled(!1);this.cancel.set_disabled(!1)},handleNoPendingChanges:function(){this.apply.set_disabled(!0);this.cancel.set_disabled(!0)},resetPendingVisuals:function(){},$2:function(){ss.staticEquals(this.$2$1,null)||this.$2$1()},applyChanges:function(){},layout:function(n){tab.FeatureFlags.isEnabled("MobileQFZoneInteractiveRedesign")&&tsConfig.is_mobile?(s.setMarginBoxWidth(this.div,n.w),this.div.style.maxHeight=n.h+"px"):dojo.marginBox(this.div,n)},fetchChildNodeByIndex:function(t){return ss.isNullOrUndefined(t)||t<0?null:(n.filterItem.isAllItem(this.div.firstChild)&&(t+=1),this.div.childNodes[t])},fetchAllItem:function(){return this.div.childNodes[0]},shouldUseAllItem:function(){return this.attributes["show-all"]!=="false"},countIfAll:function(n){for(var i=this.parent.get_mode()==="checklist"?1:0,t=0;t<n.length;t++)n[t].s&&(i+=1);return i===n.length},getSummaryText:function(){return this.hasSummaryText()?this.parent.get_oFilter().summary:""},formatTuple:function(n){return tableau.format.formatTupleDisplayName(n,!0,this.parent.get_oFilter().role)},formatFacet:function(n){return tableau.format.formatTupleDisplayFacet(n,!0,this.parent.get_oFilter().role)},onSmallSearchUI:function(){},hasSummaryText:function(){var t=this.parent.get_mode()==="slider",i=this.parent.get_mode()==="dropdown"||this.parent.get_mode()==="checkdropdown",n=this.parent.get_oFilter().summary,r=!ss.referenceEquals(n,tab.Strings.QuickFilterAll);return ss.isValue(n)&&(t||i&&r)},applyChangesByChangelist:function(n,t){var e=ss.coalesce(this.attributes.values,""),o=[],s=[],h=[],i,r,u,f,c;if(t==="checklist"||t==="checkdropdown"||t==="typeinlist"){for(i=n.compileForChecklist(e),u=0;u<i.select.length;u++)r=i.select[u],o.push(r);for(f=0;f<i.deselect.length;f++)r=i.deselect[f],s.push(r);tab.FilterClientCommands.modifyCategoricalFilterValuesByIndex(this.parent.get_session().get_visualId(),this.parent.get_field(),Array.prototype.slice.call(o),Array.prototype.slice.call(s))}else t==="radiolist"&&(c=n.compileForRadiolist(e),h.push(c.index),tab.FilterClientCommands.setCategoricalFilterValuesByIndex(this.parent.get_session().get_visualId(),this.parent.get_field(),"filter-replace",Array.prototype.slice.call(h)))},destroy:null,dispose:function(){this.disposables.dispose()}},Object,[ss.IDisposable]);ss.initClass(h,t,{get_scrollNode:function(){var n=null;return ss.isValue(this.menuNode)&&(n=this.menuNode.children(".CFInnerContainer").get(0)),n},instantiate:function(n,t,i){this.fillListElement=ss.mkdel(this,function(r){this.createListElement(r,n,t,i)});this.dropdown=$("<span>").addClass("tabComboBox").addClass("tab-ctrl-formatted-widget").addClass("tab-ctrl-formatted-darker-border-hover").addClass("tabComboStdTheme").addClass("tabComboBoxNoIcon").addClass("tiledContent").on("click",ss.mkdel(this,this.onDropdownClicked));var r=tab.DomUtil.generateUniqueId();tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")&&(this.dropdown.on("keyup",ss.mkdel(this,this.$9)).attr("tabindex","0").attr("role","combobox").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-live","polite").attr("aria-describedby",r),tab.MiscUtil.isNullOrEmpty$3(this.parent.get_titleDomId())?this.dropdown.removeAttr("aria-labelledby"):this.dropdown.attr("aria-labelledby",this.parent.get_titleDomId()));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.dropdown.remove()})));this.dropdownLabelContainer=$("<div>").addClass("tabComboBoxNameContainer").addClass("tab-ctrl-formatted-fixedsize").appendTo(this.dropdown);$("<span>").addClass("tabComboBoxName").text(this.getLabelText(n)).attr("id",r).attr("aria-hidden","true").appendTo(this.dropdownLabelContainer);$("<div class='tabComboBoxButtonHolder'><span class='tabComboBoxButton'>"+kt.getDropDownForColor(this.parent.get_presModel().textStyle.color.toString())+"<\/span><\/div>").appendTo(this.dropdown);this.div.appendChild(this.dropdown.get(0));ss.isValue(this.menuNode)&&(this.menuNode.children(".tiledContent").remove(),this.fillMenu(this.menuNode));this.$c(n.length);spiff.GlobalUIEvents.add_dismissTemporaryElements(ss.mkdel(this,this.$8))},updateContent:function(n){var t,i,r;ss.isValue(this.menuNode)&&(tab.BrowserSupport.get_isIE()&&this.menuNode.css({"box-shadow":"none"}),t=n.length>0?n.join(""):this.searchBox.get_noMatchHtml(),i=this.menuNode.children(".tiledContent"),ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null),i.html(t),this.$i(),this.$k&&(r=this.dropdown.offset(),this.menuNode.css({top:r.top-this.menuNode.outerHeight()+"px"})),tab.BrowserSupport.get_isIE()&&this.menuNode.css({"box-shadow":"2px 2px 2px #adadad"}))},resetContent:function(n,t,i){if(this.fillListElement=ss.mkdel(this,function(r){this.createListElement(r,n,t,i)}),!ss.isValue(this.searchBox)||!this.searchBox.isShowingResults()){if(ss.isValue(this.menuNode)){this.$h(this.menuNode);var r=this.$6();this.menuNode.css({top:this.$k?r.y-this.dropdown.height()-this.menuNode.outerHeight()-1+"px":r.y+"px",left:r.x+"px"})}this.dropdownLabelContainer.children().text(this.getLabelText(n));ss.isValue(this.menuNode)&&tab.BrowserViewport.getViewport(ss.mkdel(this,function(n){ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);ss.isValue(this.menuNode)&&(this.menuNode[0].removeEventListener("focus",this.listItemFocusHandler,!0),this.$3(),this.menuNode.children().remove(),this.$4(n,this.menuNode),this.$i())}));this.$c(n.length);this.$i()}},$c:function(n){var t=this.shouldUseAllItem()?1:0;n+t<=5?this.searchBox.hideUI():this.searchBox.showUI$1()},$9:function(n){switch(n.which){case 13:case 32:this.onDropdownClicked(n);break;default:return}n.preventDefault();n.stopPropagation()},shouldNotReinstantiate:function(){return!1},layout:function(n){this.inherited(arguments);ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h)},destroy:function(){this.dispose();this.hideMenu();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null;spiff.GlobalUIEvents.remove_dismissTemporaryElements(ss.mkdel(this,this.$8))},fetchAllItem:function(){return this.shouldUseAllItem()?this.menuNode.children(".CFInnerContainer").children(".FIItem").get(0):null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):null},createListElement:null,getLabelText:function(t){var u=n.isAllOrAllChecked(this.parent),r,i,f;if(this.currentlySelected=-1,this.multimode=!1,r=t.length,r===0)return!u,tab.Strings.QuickFilterAll;for(i=0;i<r;i++)if(t[i].s&&!u){if(this.currentlySelected>-1){this.multimode=!0;break}this.currentlySelected=i}return u&&r>1?tab.Strings.QuickFilterAll:this.multimode?tab.Strings.QuickFilterMultipleValues:this.currentlySelected===-1&&this.hasSummaryText()?this.getSummaryText():(f=this.currentlySelected>-1?this.currentlySelected:0,tableau.format.formatTupleDisplayName(ss.coalesce(t[f],""),!0,this.parent.get_oFilter().role))},onDropdownClicked:function(){tab.BrowserViewport.getViewport(ss.mkdel(this,this.$f))},$f:function(n){var i,t,f;if(!this.$7()&&(i=document.body,this.removeGlass(),this.glass=new spiff.Glass,this.glass.add_click(ss.mkdel(this,this.hideMenu)),this.glass.set_zIndex(899),this.glass.show(),t=this.$6(),this.menuNode=$("<div>").attr("id",this.parent.id+"_menu").addClass("CFOuterContainer").addClass("tabMenuComboDropdownTheme").addClass("tab-ctrl-formatted-widget").attr("role","application").css({position:"absolute",top:t.y+"px",left:t.x+"px","max-height":30*this.get_lineHeight()+"px","z-index":"900",visibility:"hidden"}).appendTo(i),tab.ColorModel.fromColorCode(this.parent.get_backgroundColor()).isLuminanceAboveThreshold(.314999997615814)||this.menuNode.addClass("tab-darkBackground"),this.$j||(y.applyFormatting(this.menuNode.get(0),this.parent.get_presModel().textStyle,this.parent.get_backgroundColor(),this.get_lineHeight(),!0),this.$j=!0),this.searchBox.startupNoAppend(),this.$h(this.menuNode),this.$4(n,this.menuNode),this.$i(),$(this.menuNode.get(0)).toggleClass("QFDropdownMenuAbove",this.$k),tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters"))){var e=this.menuNode.find(".tile"),r=tab.DomUtil.getIds(e).join(" "),u=this.$5();$(this.searchBox.get_queryBox()).attr("id",u).attr("aria-autocomplete","list").attr("aria-controls",r);f=u+" "+r;this.dropdown.attr("aria-owns",f);this.$d(!0)}},$5:function(){return this.parent.id+"_textbox"},$d:function(n){ss.isValue(this.dropdown)&&this.dropdown.attr("aria-expanded",n.toString())},$i:function(){if(ss.isValue(this.menuNode)&&tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")){this.updateTabIndexes(this.menuNode[0],!0);$(this.get_scrollNode()).off(h.$0).on(h.$0,ss.mkdel(this,this.$a));this.menuNode.off(h.$0).on(h.$0,ss.mkdel(this,this.$b));spiff.FocusManager.trapFocus(this.menuNode);this.menuNode[0].addEventListener("focus",this.listItemFocusHandler,!0)}},$b:function(n){switch(n.which){case 27:this.hideMenu();break;default:return}n.stopPropagation();n.preventDefault()},removeGlass:function(){ss.isValue(this.glass)&&(this.glass.remove_click(ss.mkdel(this,this.hideMenu)),this.glass.dispose(),this.glass=null)},$3:function(){ss.isValue(this.apply)&&ss.isValue(this.apply.element)&&this.apply.element.detach();ss.isValue(this.cancel)&&ss.isValue(this.apply.element)&&this.cancel.element.detach()},hideMenu:function(){this.searchBox.clearSearch(!1,!1);this.removeGlass();ss.isValue(this.menuNode)&&(this.menuNode[0].removeEventListener("focus",this.listItemFocusHandler,!0),this.$3(),this.menuNode.remove(),this.menuNode=null,this.focusedId=null,this.dropdown.focus());tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")&&(this.$d(!1),this.dropdown.removeAttr("aria-owns"))},$7:function(){return ss.isValue(this.menuNode)||ss.isValue(this.glass)},$6:function(){var n=this.dropdown.offset(),t=tab.DoubleUtil.roundToInt(this.dropdown.outerHeight());return{x:tab.DoubleUtil.roundToInt(n.left),y:tab.DoubleUtil.roundToInt(n.top)+t-1}},$4:function(n,t){ss.isNullOrUndefined(t)||(this.fillMenu(t),this.$k=this.$e(n,t),this.$k?$(this.searchBox.domNode).appendTo(t):$(this.searchBox.domNode).insertBefore(t.children().first()),this.$g(n,t),this.searchBox.get_isVisible()&&this.searchBox.showUI$1())},$a:function(n){if(n.which!==27)this.parent.onKeyDown(n)},$g:function(n,t){var f=this.dropdown.offset(),w=tab.DoubleUtil.roundToInt(this.dropdown.outerWidth())-2,c=document.body,r=t.find(".tile").eq(0),b=r.css("right"),k=ss.isValue(r[0])?r[0].style.width:"",u,l,e,s;r.css({right:"auto",width:""});u=tab.DoubleUtil.roundToInt(r.width())+20;r.css({right:b});r.css({width:k});u=Math.max(u,w);l=tab.DoubleUtil.roundToInt($(c).width());u=Math.min(u,l);t.width(u);var d=t.offset(),a=tab.DoubleUtil.roundToInt(d.left),g=a+tab.DoubleUtil.roundToInt(t.outerWidth()),v=$(c).find(".dashboardSpacer"),nt=v.offset(),tt=tab.DoubleUtil.roundToInt(nt.left)+tab.DoubleUtil.roundToInt(v.width()),y=g-tt;y>0&&(e=a-y,e=Math.max(e,0),t.css({left:e+"px"}));var it=30*this.get_lineHeight(),rt=3*this.get_lineHeight(),o=n.getVisibleRoom(tab.PointUtil.fromPosition(f),0),i=(this.$k?o.roomAbove:o.roomBelow-2)-20;i=i-parseInt(t.css("border-bottom-width"));i=Math.min(i,it);i=Math.max(i,rt);t.css({"max-height":i+"px"});s=tab.FullscreenUtil.centeringContainerOffset();this.$k?o.roomAbove>i-1?t.css({top:f.top-s-t.outerHeight()+"px"}):t.css({top:f.top-s-o.roomAbove+"px"}):t.css({top:f.top-s+this.dropdown.outerHeight()+"px"});var ut=ss.isValue(this.searchBox)&&this.searchBox.get_isVisible()?dojo.marginBox(this.searchBox.domNode).h:0,p=0,h=t.children(".CFInnerContainer");this.parent.shouldDeferChanges()&&ss.isValue(this.apply)&&!this.menuNode.hasClass("CFDropdownNoItems")&&(p=dojo.marginBox(this.apply.element.get(0)).h,this.layoutApplyButton(h));ss.isValue(h)&&(h.css({"max-height":t.get(0).clientHeight-ut-p+"px"}),this.tiledWidget.updateViewport(tab.DoubleUtil.roundToInt(h.height()),0));t.css({visibility:"visible"})},$e:function(n,t){var r=this.dropdown.offset(),u=30*this.get_lineHeight(),i=n.getVisibleRoom(tab.PointUtil.fromPosition(r),0);return Math.min(t.outerHeight(),u)>i.roomBelow&&i.roomAbove>i.roomBelow},fillMenu:function(n){if(!ss.isNullOrUndefined(n)){var t=$("<div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");tab.BrowserSupport.get_isFF()&&t.attr("tabindex","-1");n.append(t);this.fillListElement(t.get(0))}},$h:function(n){this.parent.get_oFilter().all||this.parent.get_oFilter().allNotChecked?n.addClass("CFAll"):n.removeClass("CFAll");this.parent.get_oFilter().exclude?n.addClass("CFExclusive"):n.removeClass("CFExclusive")},$8:function(){this.hideMenu()}},l,[ss.IDisposable]);ss.initClass(uf,t,{createTabbedNavigation:function(n,t){return new tableau.base.widget.TabbedNavigation(n,t)},createPageViewModel:function(n){return new ht(n)},createCategoricalLegendViewModel:function(n,t,i,u){return new r(n,t,i,u)},createQuantitativeColorLegendViewModel:function(n,t,i){return new ft(n,t,i)},createLegacyLegendViewModel:function(n,t,i){return new it(n,t,i)},createLegacyQuickFilterDisplayViewModel:function(n,t){return new st(n,t)},createParameterControlViewModel:function(n){return new ct(n)},createPageView:null,createLegacyQuickFilterDisplayView:null,createParameterControlView:null,createQuantitativeColorLegendView:function(n){return new at(n)},createContinuousSliderViewModel:function(n){return new et(n)},createLegacyLegendView:null,createContinuousSlider:null},null,[tab.ILegacyDojoUIModule]);ss.initClass(ci,t,{get_legendItems:function(){return this.$1}},spiff.Template,[ss.IDisposable]);ss.initClass(pt,t,{},spiff.Template,[ss.IDisposable]);ss.initClass(f,t,{get_contentArea:function(){return this.legendContentArea}},spiff.Template,[ss.IDisposable]);ss.initClass(ir,t,{},f,[ss.IDisposable]);ss.initClass(o,t,{get_docSize:function(){var n=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.legendSize;return{w:n.w,h:n.h}},get_focusableLegendItems:function(){return this.element.find(".tabLegendItem[tabindex]")},get_catLegendViewModel:function(){return this.get_viewModel()},get_catLegendTemplate:function(){return this.get_template()},get_scrollOffset:function(){var n=this.get_catLegendTemplate().columnsHolder.scrollLeft(),t=tab.DoubleUtil.roundToInt(this.get_catLegendTemplate().columnsHolder.scrollTop());return{x:n,y:t}},set_scrollOffset:function(n){this.get_catLegendTemplate().columnsHolder.scrollLeft(n.x);this.get_catLegendTemplate().columnsHolder.scrollTop(n.y)},onAddedToDom:function(){ss.makeGenericType(c,[r]).prototype.onAddedToDom.call(this);this.drawLegend(!0);this.element.attr("tabindex","-1").attr("role","listbox").attr("aria-multiselectable","true")},onKeyDown:function(n){var t=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.rowCount,i,r,u,f,e,o,s;switch(n.which){case 39:this.$v.length===1?(i=this.get_viewModel(),i.set_focusIndex(i.get_focusIndex()+1)):this.get_viewModel().get_focusIndex()+t<this.get_viewModel().get_numLegendItems()?(r=this.get_viewModel(),r.set_focusIndex(r.get_focusIndex()+t)):this.get_viewModel().set_focusIndex(this.get_viewModel().get_numLegendItems()-1);break;case 37:this.$v.length===1?(u=this.get_viewModel(),u.set_focusIndex(u.get_focusIndex()-1)):this.get_viewModel().get_focusIndex()>=t?(f=this.get_viewModel(),f.set_focusIndex(f.get_focusIndex()-t)):this.get_viewModel().set_focusIndex(0);break;case 40:e=this.get_viewModel();e.set_focusIndex(e.get_focusIndex()+1);break;case 38:o=this.get_viewModel();o.set_focusIndex(o.get_focusIndex()-1);break;case 36:this.get_viewModel().set_focusIndex(0);break;case 35:this.get_viewModel().set_focusIndex(this.get_viewModel().get_numLegendItems()-1);break;case 27:this.get_viewModel().selectNone("simple");break;case 32:s=this.get_catLegendViewModel().getLegendItem(this.get_viewModel().get_focusIndex());ss.isValue(s)&&this.get_viewModel().selectItem(s,"toggle");break;case 13:this.get_catLegendViewModel().get_shouldShowHighlighter()&&this.get_catLegendViewModel().toggleHighlighting();break;default:return}n.preventDefault();n.stopPropagation()},onFocus:function(n){var t=n.target;t.classList.contains("tabLegendItem")?this.get_viewModel().set_focusIndex(this.get_focusableLegendItems().index(t)):ss.referenceEquals(t,this.element[0])&&tab.DomUtil.focusWithoutScrolling(ss.mkdel(this,this.updateFocus),this.get_catLegendTemplate().columnsHolder);this.showOrHideTitleControls(!0)},onSelectionChanged:function(n){this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.colCount===this.$v.length&&(this.$i(n),this.$u())},onViewModelPropertyChanged:function(n,t){switch(t.get_propertyName()){case"isActiveZone":case"isReadyZone":break;case"Items":this.onSelectionChanged(null);break;case"ParentZoneSizeChanged":var i=this.get_catLegendViewModel().$4();i.w===tab.DoubleUtil.roundToInt(this.get_catLegendTemplate().panel.width())&&i.h===tab.DoubleUtil.roundToInt(this.get_catLegendTemplate().panel.height())||this.resetLegend(!1);this.$q();break;case"CustomShapesLoaded":this.get_catLegendViewModel().get_legendTypeEnum()==="shape"&&(ss.isValue(this.$y)&&tab.WindowHelper.cancelAnimationFrame(ss.unbox(this.$y)),this.$y=tab.WindowHelper.requestAnimationFrame(ss.mkdel(this,function(){this.$y=null;this.$i(null)})));break;case"FocusIndex":this.updateFocus();break;case"titleVisible":case null:this.resetLegend(!1);break;default:this.resetLegend(!0)}},$q:function(){var t,i,n,r;this.get_legendTooltip().get_isTooltipShown()&&(t=this.$e(),i=this.$l(),ss.isValue(i)&&!tab.RectXYUtil.isEmpty(t)?(this.scrollToShowBounds(t),n=tab.DomUtil.getRectXY(i.item),r={x:n.x+ss.Int32.div(n.w,2),y:n.y+ss.Int32.div(n.h,2)},this.get_legendTooltip().selectionMoved(r)):this.get_legendTooltip().repositionWithinRegion(tab.DomUtil.getRectXY(this.get_catLegendTemplate().panel)))},scrollToShowBounds:function(){},$e:function(){for(var u,n,f,e,t,s,i={x:0,y:0,w:0,h:0},h=this.get_catLegendViewModel().get_categoricalLegendPM(),o=h.catLegendLayout,r=0;r<o.colCount;++r)for(u=this.$v[r],n=0;n<o.rowCount&&n<u.get_legendItems().length;++n)f=u.get_legendItems()[n],e=f.domRoot.data("tabLegendItem"),ss.isValue(e)&&this.get_catLegendViewModel().isSelected(e)&&(t=tab.DomUtil.getMarginBoxJQ(f.item),s={x:t.l,y:t.t,w:t.w,h:t.h},i=tab.RectXYUtil.union(i,s));return i},$l:function(){for(var i,n,r,u,e=this.get_catLegendViewModel().get_categoricalLegendPM(),f=e.catLegendLayout,t=0;t<f.colCount;++t)for(i=this.$v[t],n=0;n<f.rowCount&&n<i.get_legendItems().length;++n)if(r=i.get_legendItems()[n],u=r.domRoot.data("tabLegendItem"),ss.isValue(u)&&this.get_catLegendViewModel().isSelected(u))return r;return null},getLegendItemFromEvent:function(n){var t=$(n.target);return t.hasClass("tabLegendItemLabelHolder")||t.hasClass("tabLegendItem")?null:t.parents(".tabLegendItem").addBack().first().data("tabLegendItem")},resetLegend:function(n){this.drawLegend(n)},getViewportPosition:function(n){var t=n.get_gestureInfo();return{x:t.pageX,y:t.pageY}},getDocumentPosition:function(n){var t={x:n.x,y:n.y},i=tab.DomUtil.getRectXY(this.get_catLegendTemplate().columnsHolder);return t.x+=this.get_catLegendTemplate().columnsHolder.scrollLeft()+this.viewportOffset.x-i.x,t.y+=tab.DoubleUtil.roundToInt(this.get_catLegendTemplate().columnsHolder.scrollTop())+this.viewportOffset.y-i.y,t},performSelectOnItem:function(n,t,i,r){if(this.get_catLegendViewModel().get_legendTypeEnum()!=="map"){if(tab.FeatureFlags.isEnabled("VizLegendHover")){switch(t){case"simple":case"range":ss.referenceEquals(this.$x,n)&&this.get_catLegendViewModel().selectItem(n,"toggle");this.get_catLegendViewModel().selectItem(n,t);break;case"toggle":ss.referenceEquals(this.$x,n)||this.get_catLegendViewModel().selectItem(n,t)}this.$x=null}else this.get_catLegendViewModel().selectItem(n,t);this.get_legendTooltip().singleSelectCoordinates(i,{x:r.x,y:r.y},this.get_legendViewModel().get_regionType(),"legenditem",this.$n())}},performHoverOnItem:function(n,t,i){if(this.get_catLegendViewModel().get_legendTypeEnum()!=="map"){var r=!0;tab.FeatureFlags.isEnabled("VizLegendHover")&&(ss.referenceEquals(this.$x,n)?r=!1:this.get_catLegendViewModel().isSelected(n)?this.clearPreviousHoveredItem():(this.hoverOnCurrentItem(n),this.$x=n,r=!1));r&&this.get_legendTooltip().hoverOverCoordinates(t,{x:i.x,y:i.y},"legenditem",this.get_legendViewModel().get_regionType(),this.$n(),null,!1)}},$n:function(){var t=0,i,n;for(ss.isValue(this.get_catLegendViewModel())&&ss.isValue(this.get_catLegendViewModel().get_categoricalLegendPM())&&ss.isValue(this.get_catLegendViewModel().get_categoricalLegendPM().legendNames)&&(t=this.get_catLegendViewModel().get_categoricalLegendPM().legendNames.length),i=new Array(t),n=0;n<t;n++)i[n]=this.get_catLegendViewModel().get_categoricalLegendPM().legendNames[n];return i},isValidPreviousHoveredItem:function(){return ss.isValue(this.$x)&&this.get_catLegendViewModel().isSelected(this.$x)},clearPreviousHoveredItem:function(){this.isValidPreviousHoveredItem()&&this.get_catLegendViewModel().selectItem(this.$x,"toggle")},hoverOnCurrentItem:function(n){var t=[];t.push(n);this.isValidPreviousHoveredItem()&&t.push(this.$x);this.get_catLegendViewModel().selectItems(t,"toggle")},clearHoverOnItem:function(){this.clearPreviousHoveredItem();this.$x=null},setContentSize:function(n,t){o.setDomNodeStyleSize(this.get_catLegendTemplate().columnsHolder,t,n)},onLegendHighlighterButtonTapped:function(){this.get_catLegendViewModel().toggleHighlighting()},showContextMenu:function(){this.get_catLegendViewModel().showWebCategoricalColorDialog()},showOrHideTitleControls:function(n){this.get_catLegendTemplate().titleControls.toggle(n)},drawLegend:function(n){var t=$.contains(this.element[0],document.activeElement);this.$r();this.drawTitle();this.element.attr("aria-label",tab.Strings.Legend+": "+this.get_catLegendTemplate().titleArea.text());this.setupPanelAndViewport();n&&this.$s();this.$o();this.$u();this.$i(null);t&&this.updateFocus()},updateFocus:function(){var n=this.get_focusableLegendItems();n.attr("tabindex","-1");n.eq(this.get_viewModel().get_focusIndex()).attr("tabindex","0").focus()},$r:function(){for(var t,n=0;n<this.$v.length;n++)t=this.$v[n],t.domRoot.remove();ss.clear(this.$v)},drawTitle:function(){ss.makeGenericType(c,[r]).prototype.drawTitle.call(this);this.$t()},$t:function(){if(this.get_catLegendViewModel().get_titleInline()){var n=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.rowHeight;this.get_baseLegendTemplate().titleArea.css("height",n+"px");this.get_baseLegendTemplate().titleArea.css("line-height",n+"px")}},setupPanelAndViewport:function(){var n=this.get_catLegendViewModel().$4().w,t=this.get_catLegendViewModel().$4().h;o.setDomNodeStyleSize(this.get_catLegendTemplate().panel,n,t);this.get_catLegendTemplate().panel.get(0).id=this.$p();this.$d(n,t);this.setContentSize(this.viewportHeight,this.viewportWidth)},$p:function(){return"tableau_base_legend_"+this.get_catLegendViewModel().get_regionType().toString()+(this.get_catLegendViewModel().get_shouldShowHighlighter()?"_q_":"_")+encodeURIComponent(this.get_catLegendViewModel().$7())},$d:function(n,t){var i=this.get_catLegendViewModel().$5();this.viewportWidth=n;this.viewportHeight=t;this.viewportOffset={x:0,y:0};this.get_catLegendViewModel().get_titleInline()?(this.viewportWidth-=i.w,this.viewportOffset.x+=i.w):(this.viewportHeight-=i.h,this.viewportOffset.y+=i.h)},$s:function(){var t=this.get_catLegendViewModel().get_categoricalLegendPM(),n=t.scrollOffset;ss.isNullOrUndefined(n)&&(n={},n.x=0,n.y=0);this.set_scrollOffset(tab.PointUtil.fromPresModel(n))},$o:function(){var n=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout,u=n.areaSize.w,f=n.areaSize.h,e=n.imageSize.w,o=n.imageSize.h,c=Math.ceil((u-e)/2),l=Math.ceil((f-o)/2),a={w:u,h:f},s=null,h=!1,i,r,t;for((this.get_catLegendViewModel().legendType==="color"||this.get_catLegendViewModel().legendType==="map")&&(s={l:c,t:l,w:e,h:o},h=ss.isValue(this.get_catLegendViewModel().$h().swatchBorderColor)),i=this.$m(n),r=0;r<n.colCount;++r)t=new ci(n.rowCount,i,n.rowHeight,a,s,h),this.$v.push(t),t.column.width(i),this.get_catLegendTemplate().columnHolder.append(t.domRoot)},$u:function(){this.get_catLegendTemplate().highlighterButton.toggleClass("tabHighlightEnabled",this.get_catLegendViewModel().$j());this.get_catLegendTemplate().highlighterButton.toggleClass("tabHighlightDisabled",!this.get_catLegendViewModel().$j())},$i:function(n){for(var e,i,r,u,c=ss.isNullOrUndefined(n),o=this.get_catLegendViewModel().get_categoricalLegendPM(),s=o.catLegendLayout,h=this.get_catLegendViewModel().get_numLegendItems(),t=0,f=0;f<s.colCount&&t<h;++f)for(e=this.$v[f],i=0;i<s.rowCount&&t<h&&i<e.get_legendItems().length;++i,++t)(c||ss.contains(n,t))&&(r=e.get_legendItems()[i],u=this.$g(t,r),ss.isValue(u)&&(this.$h(u,o,r),r.domRoot.data("tabLegendItem",u)));this.get_focusableLegendItems().eq(this.get_viewModel().get_focusIndex()).attr("tabindex","0")},$g:function(n,t){var i=null;switch(this.get_catLegendViewModel().legendType){case"color":case"map":i=this.$f(n,t);break;case"size":i=this.$k(n,t);break;case"shape":i=this.$j(n,t)}return i},$f:function(n,t){var f=this.get_catLegendViewModel().$h(),e=f.colorLegendItems[n],o=this.get_catLegendViewModel().$o(),i=tab.ColorModel.fromColorCode(e.color),s,h,r,u;return i=tab.ColorModel.alphaComposite(i,o),s=this.get_catLegendViewModel().isLegendItemGrayed(e),s&&(i=tab.SceneDataUtil.applyFoggingToColor(i,o)),h=i.toString(),t.itemSwatch.get(0).id=h,r={},r["background-color"]=h,ss.isValue(f.swatchBorderColor)&&(r["border-style"]="solid",u=tab.ColorModel.fromColorCode(f.swatchBorderColor),s&&(u=tab.SceneDataUtil.applyFoggingToColor(u,o)),r["border-color"]=u.toString()),t.itemSwatch.css(r),e},$j:function(n,t){var i=this.get_catLegendViewModel().$m(),r=i.shapeLegendItems[n],u=i.catLegendLayout.areaSize.w,f=i.catLegendLayout.areaSize.h,e=t.renderContext;return e.clearRect(0,0,u,f),(ss.isNullOrUndefined(this.$w)||!this.$w.containsShape(r.shapeId))&&(this.$w=new tab.HackyShapeSwatchRenderer(t.canvasElt,t.renderContext,u/2,f/2,i.catLegendLayout.imageSize.w,i.catLegendLayout.imageSize.h,this.get_catLegendViewModel().$o())),this.$w.renderSwatch(e,r.shapeId,this.get_catLegendViewModel().isLegendItemGrayed(r)),t.itemSwatch.get(0).id=r.shapeId.toString(),r},$k:function(n,t){var u=this.get_catLegendViewModel().$n(),r=u.sizeLegendItems[n],v=u.catLegendLayout.areaSize.w,s=u.catLegendLayout.areaSize.h,b=u.catLegendLayout.imageSize.h,k=Math.ceil((s-b)/2),i=t.renderContext,h,c,y,p,w,a;i.save();h=o.$5;c=o.$3;this.get_catLegendViewModel().isLegendItemGrayed(r)&&(y=this.get_catLegendViewModel().$o(),h=tab.SceneDataUtil.applyFoggingToColor(h,y),c=tab.SceneDataUtil.applyFoggingToColor(c,y));i.set_shapeFillStyle(h.toString());i.set_strokeStyle(c.toString());i.set_lineWidth(2);var f=v/2,l=s/2,e=r.size/2;i.clearRect(0,0,v,s);i.setClip({x:0,y:1,w:v,h:s-2});switch(u.primitiveType){case"shape":case"circle":case"pie":i.beginPath();i.arc(f,l,e,0,Math.PI*2,!1);i.closePath();i.fill();i.beginPath();i.arc(f,l,e,0,Math.PI*2,!1);i.closePath();i.stroke();break;case"line":case"gantt":case"bar":i.fillRect(f-e,k,r.size,b);break;case"square":p=f-e;w=l-e;i.fillRect(p,w,r.size,r.size);i.strokeRect(p,w,r.size,r.size);break;case"text":a=u.swatchTextStyle;typeof a=="undefined"&&(a=u.textStyle);tab.DisplayList2DRenderer.setTextProperties(i,a,r.size);i.set_textAlign("center");i.fillText1(tab.Strings.SizeLegendTextMarkSwatch,f,l)}return i.restore(),t.itemSwatch.get(0).id=u.primitiveType.toString()+"_"+r.size.toString(),r},$m:function(n){return n.legendLayout==="grid"&&n.legendSize.w<n.colWidth?n.legendSize.w:n.colWidth},$h:function(n,t,i){var u=t.textStyle,s=null,h="",c,o;this.get_catLegendViewModel().isSelected(n)?(u=t.selectedTextStyleModel,h=t.selectBgColor):this.get_catLegendViewModel().isLegendItemGrayed(n)&&(c=this.get_catLegendViewModel().$o(),s=tab.SceneDataUtil.applyFoggingToColor(tab.ColorModel.fromColorCode(u.color),c).toString());var v=t.catLegendLayout.textOrigin.y,f=t.catLegendLayout.textOrigin.x,l="left",e=this.$m(t.catLegendLayout),a=e-f,r={};u.halign==="h-align-right"||t.catLegendLayout.rightJustify?(l="right",r.overflow="inherit",o=Math.max(e-f-t.catLegendLayout.maxItemSpan,0),r.right=o+"px",a=e-o):r.left=f+"px";r.top=v+"px";r.width=a-1+"px";r.bottom="0px";r["text-align"]=l;i.itemLabelHolder.css(r);i.itemLabel.css("background-color",h);i.itemLabel.css(tab.FormattingConverters.makeFormatStyleDict(u,s));i.itemLabel.text(n.text);i.domRoot.attr("tabindex","-1").attr("role","option").attr("aria-selected",this.get_catLegendViewModel().isSelected(n).toString())}},ss.makeGenericType(c,[r]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[r]),ss.makeGenericType(tab.ICategoricalLegendView$1,[r])]);ss.initClass(v,t,{$4:function(){var n=null;return ss.isValue(this.$9)&&(n={w:this.$9.get_contentWidth(),h:this.$9.get_contentHeight()}),n},$5:function(){var n=null;return ss.isValue(this.$9)?(n=this.$9.get_titleSize(),n.h=Math.max(0,n.h-2*this.get_borderWidth()),n.w=Math.max(0,n.w-2*this.get_borderWidth())):n={w:0,h:0},n},$7:function(){return this.$b},$8:function(){return this.$9.get_zoneId()},$6:function(){return ss.isValue(this.get_visualModel())?this.$a.get_visualId():null},get_visualModel:function(){return ss.isNullOrUndefined(this.$a)&&(this.$a=tab.ModelUtils.getVisualModel(tab.ApplicationModel.get_instance(),this.$b)),this.$a},get_parentZoneVM:function(){return this.$9},get_hasTitle:function(){return this.get_parentZoneVM().get_hasTitle()},get_backgroundColor:function(){return tab.ColorModel.fromColorCode(this.get_parentZoneVM().get_contentContainerStyle().get_fillColor())},get_borderWidth:null,get_regionType:null,get_titleHtml:function(){return this.get_hasTitle()?this.get_presModelTitleHtml():""},get_presModelTitleHtml:null,get_titleInline:function(){var n=this.$5();return this.get_presModelTitleInline()===!1&&n.h===0&&n.w>0?!0:this.get_presModelTitleInline()},get_presModelTitleInline:null,get_titleHeight:function(){if(!this.get_hasTitle())return 0;var n=this.get_presModelTitleHeight();return n===0&&(n=this.$5().h),n},get_presModelTitleHeight:null,get_titleWidth:function(){if(!this.get_hasTitle())return 0;var n=this.get_presModelTitleWidth();return n===0&&(n=this.$5().w),n},get_presModelTitleWidth:null,dispose:function(){ss.isValue(this.$9)&&(this.$9.remove_propertyChanged(ss.mkdel(this,this.$2)),this.$9.remove_zoneResized(ss.mkdel(this,this.$3)));spiff.BaseViewModel.prototype.dispose.call(this)},$2:function(n,t){this.notifyPropertyChanged(t.get_propertyName())},$3:function(){this.notifyPropertyChanged("ParentZoneSizeChanged")}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel]);ss.initClass(r,t,{get_catLegendModel:function(){return this.$r},get_legendTypeEnum:function(){switch(this.legendType){case"color":return"color";case"shape":return"shape";case"size":return"size";case"map":return"map"}return"color"},get_categoricalLegendPM:function(){return this.$r.get_catLegendPresModel()},get_fieldNames:function(){return this.get_categoricalLegendPM().legendNames},get_numLegendItems:function(){var n=this.get_catLegendModel().get_items();return ss.isNullOrUndefined(n)?0:n.length},get_presModelTitleInline:function(){return this.get_categoricalLegendPM().catLegendLayout.titleInline},get_presModelTitleHtml:function(){return this.get_categoricalLegendPM().titleHtml},$l:function(){return this.get_catLegendModel().get_legendNames()},$o:function(){return this.$w||new tab.ColorModel(255,255,255,1)},$k:function(){var n=this.get_categoricalLegendPM().styledBox;return ss.isValue(n.fillColor)?tab.ColorModel.fromColorCode(n.fillColor):r.$1},$h:function(){return this.$r.get_catLegendPresModel()},$m:function(){return this.$r.get_catLegendPresModel()},$n:function(){return this.$r.get_catLegendPresModel()},get_regionType:function(){var n="color";switch(this.legendType){case"color":n="color";break;case"size":n="size";break;case"shape":n="shape";break;case"map":n="map"}return n},get_borderWidth:function(){var n=this.get_categoricalLegendPM().styledBox.uw;return this.get_categoricalLegendPM().styledBox.borderStyle==="bs-none"&&(n=0),n},get_presModelTitleHeight:function(){return this.get_categoricalLegendPM().catLegendLayout.titleHeight},get_presModelTitleWidth:function(){return this.get_categoricalLegendPM().catLegendLayout.titleWidth},$j:function(){return this.get_catLegendModel().get_isHighlightEnabled()},get_shouldShowContextMenu:function(){return this.get_catLegendModel().get_isContextMenuAllowed()},get_shouldShowHighlighter:function(){return this.get_catLegendModel().get_isHighlightAllowed()},$i:function(){return this.get_visualModel().get_selectionsModel().get_brushVizForNodeSelection()||!this.get_visualModel().get_selectionsModel().tupleSelection.isEmpty},get_focusIndex:function(){return this.get_numLegendItems()!==this.$q&&(this.$t=0,this.$q=this.get_numLegendItems()),this.$t},set_focusIndex:function(n){(this.$q=this.get_numLegendItems(),this.$t!==n)&&(this.$t=n%this.get_numLegendItems(),this.$t<0&&(this.$t+=this.get_numLegendItems()),this.notifyPropertyChanged("FocusIndex"))},dispose:function(){v.prototype.dispose.call(this);this.$r.remove_legendChanged(ss.mkdel(this,this.$f));this.$r.remove_legendNameChanged(ss.mkdel(this,this.$e));this.$v.remove_newSelection(ss.mkdel(this,this.$g));this.$p.remove_newSelection(ss.mkdel(this,this.$g));this.get_visualModel().get_selectionsModel().remove_newSelections(ss.mkdel(this,this.$g));this.get_visualModel().remove_emptyHighlightFogAllChanged(ss.mkdel(this,this.$d));ss.isValue(this.$s)&&this.$s.dispose()},isLegendItemGrayed:function(n){var t,i;return this.$j()?this.isSelected(n)||this.isBrushed(n)?!1:(t=this.get_visualModel(),ss.isNullOrUndefined(t))?!1:(i=ss.isValue(this.$p)&&!this.$p.isEmpty,t.get_emptyHighlightFogAll()||r.legendShouldBeGrayed(this.get_catLegendModel().get_isOneWay(),this.$i(),this.hasSelection(),i)):!1},hasSelection:function(){return!this.$v.isEmpty},isSelected:function(n){return this.$v.isLegendItemSelected(n)},isBrushed:function(n){return this.$p.isLegendItemSelected(n)},toggleHighlighting:function(){tab.SelectionClientCommands.toggleLegendHighlight(this.$8(),this.$6(),this.get_regionType(),this.$l(),null)},selectItem:function(n,t){var i=[];i.push(n);this.selectItems(i,t)},selectItems:function(n,t){tab.SelectionClientCommands.selectLegendItemsLocal(this.$8(),t,n,this.$6(),this.get_catLegendModel(),this.get_legendTypeEnum(),this.hasSelection())},selectNone:function(n){this.selectItems([],n)},getLegendItem:function(n){var t=this.get_catLegendModel().get_items();return ss.isNullOrUndefined(t)||n<0||n>=t.length?null:t[n]},$e:function(){this.$v.remove_newSelection(ss.mkdel(this,this.$g));this.$v=this.get_visualModel().get_selectionsModel().getLegendSelection(this.get_legendTypeEnum(),this.$l());this.$v.add_newSelection(ss.mkdel(this,this.$g));this.$p.remove_newSelection(ss.mkdel(this,this.$g));this.$p=this.get_visualModel().get_brushingsModel().getLegendSelection(this.get_legendTypeEnum(),this.$l());this.$p.add_newSelection(ss.mkdel(this,this.$g))},$f:function(){var t,i,n,r;if(this.legendType==="shape"){for(t=new Set,i=this.$m(),n=0;n<i.shapeLegendItems.length;n++)r=i.shapeLegendItems[n],tab.SceneDataUtil.isCustomShape(r.shapeId)&&t.add(r.shapeId);ss.isNullOrUndefined(this.$s)&&(this.$s=new tab.ShapeDependencyManager(ss.mkdel(this,function(){this.notifyPropertyChanged("CustomShapesLoaded")})));this.$s.initialize(tab.SetUtilities.getValues(ss.Int32).call(null,t))}this.$u=this.$c();this.notifyPropertyChanged(null)},$g:function(){var n=this.$c(),i=!this.$u.isSelectionStateTheSame(n),t;i&&(t=this.$u.computeChangedItems(n),this.notifySelectionChanged(t),this.$u=n)},notifySelectionChanged:function(n){ss.staticEquals(this.selectionChanged,null)||this.selectionChanged(n)},$d:function(){this.notifyPropertyChanged("Items")},$c:function(){return new dt(this.$v.get_ids(),this.$p.get_ids(),this.$j(),this.$i(),this.get_catLegendModel().get_isOneWay())},showWebCategoricalColorDialog:function(){var n=new tab.GetWebCategoricalColorDialogCmd;n.c.fieldVector=this.get_fieldNames();n.invoke()}},v,[ss.IDisposable,tab.IViewModel,tab.ICategoricalLegendViewModel]);ss.initClass(li,t,{get_selectedIndexes:function(){return this._selectedIndexes},clearRangeAnchor:function(){var t=this.$2.fetchChildNodeByIndex(this._anchorIndex),i;!t||(i=n.filterItem.getCssNode(t),!i||$(t).removeClass("anchorSelection"));this._anchorIndex=this._lastRangeSelectionIndex=-1},clearRangeAnchorAndSelection:function(){this.clearRangeAnchor();this._clearSelection()},refreshRangeAnchorAndSelection:function(){var i,r,t,u,f;for(this._anchorIndex>=0&&(i=this.$2.fetchChildNodeByIndex(this._anchorIndex),i?(r=n.filterItem.getCssNode(i),!r||$(r).addClass("anchorSelection")):this._anchorIndex=-1),t=this._selectedIndexes.length-1;t>=0;--t)u=this._selectedIndexes[t],f=this.$2.fetchChildNodeByIndex(u),f?this._selectItem(u):this._selectedIndexes.splice(t,1)},onListItemClick:function(t){var i=n.filterItem.getNodeFromEvent(t),h,f,r,c,u,e,l,o,v,a,y,s,p;if(!!i&&(h=$(t.target).is("input[type=checkbox]"),f=$(t.target).is("input[type=radio]"),f&&(t.target.checked=!0),(h||f)&&(n.filterItem.syncCssToCheckState(i),this.$2.handleItemClick(i)),r=n.filterItem.getIndex(i),!ss.isNullOrUndefined(r)&&!(r<0)))if(n.filterItem.isTypeInListItem(i))this.$0(t,r);else{if(!!this.changelist||(this.changelist=new wt),h||f){if(tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&!this.$2.shouldDeferChanges()&&(c=[],u=this.$2.get_filterTable(),!!u&&u.actual_size===u.tuples.length)){for(e=u.tuples,l=this._getCheckedIndexes(e,i,this.changelist),o=0,v=l.length;o<v;o++)a=l[o],y=e[a].d||e[a].t[0].v,c.push(y);s=this.$2.get_quickFilter();p=new tab.LegacyCategoricalQuickFilterData(s.get_oFilter().targetSheets,s.get_field(),s.get_oFilter().exclude,c);tab.FilterClientCommands.updateCategoricalFilter(p)}this.$1(i,t,r);this.$2.shouldDeferChanges()?(this.$2.applyChangesByChangelist(this.changelist),this.changelist.reset()):this.notifyChange(this.getDoChangeFunc())}this._updateRangeAnchor(r)}},$1:function(t,i,r){var u=new vt,f=n.filterItem.isChecked(t),e;n.filterItem.isTiled(t)?i.shiftKey===!0?(this._updateCheckboxRangeFromAnchorByIndex(r),e=this._anchorIndex>-1?this._anchorIndex:r,u.setRange(new tab.IntegerRange(e,r),f),this.changelist.addChange(u)):(u.setSingle(r,f),this.changelist.addChange(u)):i.shiftKey===!0&&this._anchorIndex>-1?this._updateCheckboxRangeFromAnchor(r):(u.setSingle(r,f),this.changelist.addChange(u))},$0:function(n,t){n.shiftKey&&this._anchorIndex>=0?this._selectRangeFromAnchor(t):(tab.BrowserSupport.get_isMac()?n.metaKey:n.ctrlKey)?(this._toggleItemSelection(t),this._updateRangeAnchor(t)):(this._clearSelection(),this._updateRangeAnchor(t),this._selectItem(t))},getDoChangeFunc:function(){return ss.mkdel(this,function(){this.$2.applyChangesByChangelist(this.changelist);this.changelist.reset()})},notifyChange:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.$2.updateStateIfNeeded();this._applyTimer=tab.WindowHelper.setTimeout(n,this.$2.get_applyDelay())},cancelPendingChange:function(){tab.MiscUtil.clearTimeout(this._applyTimer);this._applyTimer=null},_getCheckedIndexes:function(t,i,r){var f=[],e=this.$2.get_quickFilter(),o=e.get_mode()==="checklist"||e.get_mode()==="checkdropdown",a=o||e.get_mode()==="radiolist"||e.get_mode()==="dropdown",s=null,u,c,h,l;for(o&&(s=r.compileForChecklist(null)),u=0,c=t.length;u<c;u++)h=this.$2.fetchChildNodeByIndex(u),h?n.filterItem.isChecked(h)&&f.push(u):a&&(l=t[u].s,n.filterItem.getIndex(i)===u?n.filterItem.isChecked(i)&&f.push(u):o&&(ss.contains(s.select,u)?f.push(u):!ss.contains(s.deselect,u)&&l&&f.push(u)));return f},forEachSelected:function(n){var t,r,i,u;if(!ss.isNullOrUndefined(n)&&typeof n=="function")for(t=0,r=this._selectedIndexes.length;t<r;t++)i=this._selectedIndexes[t],u=this.$2.fetchChildNodeByIndex(i),n(i,u)},_selectRangeFromAnchor:function(n){for(var r,t=this._anchorIndex,u,f,e=this._lastRangeSelectionIndex>=0?this._lastRangeSelectionIndex:t,o=Math.min(t,n),s=Math.max(t,n),i=n;i<=Math.min(t,e);i++)this._selectItem(i);for(u=e;u<o;u++)this._deselectItem(u);for(r=Math.max(t,e);r<=n;r++)this._selectItem(r);for(f=s+1;f<=e;f++)this._deselectItem(f);this._lastRangeSelectionIndex=n},_toggleItemSelection:function(t){var i=this.$2.fetchChildNodeByIndex(t);n.filterItem.isSelected(i)?this._deselectItem(t):this._selectItem(t)},_selectItem:function(t){var r=this.$2.fetchChildNodeByIndex(t),i;n.filterItem.setSelected(r,!0);i=tableau.util.binarySearch(ss.Int32).call(null,t,this._selectedIndexes);i.found||this._selectedIndexes.splice(i.index,0,t)},_deselectItem:function(t){var r=this.$2.fetchChildNodeByIndex(t),i;n.filterItem.setSelected(r,!1);i=tableau.util.binarySearch(ss.Int32).call(null,t,this._selectedIndexes);i.found&&this._selectedIndexes.splice(i.index,1)},_clearSelection:function(){for(var n=this._selectedIndexes.length-1;n>=0;--n)this._deselectItem(this._selectedIndexes[n]);this._selectedIndexes=[]},_updateCheckboxRangeFromAnchor:function(t){for(var e=Math.min(this._anchorIndex,t),o=Math.max(this._anchorIndex,t),i=this.$2.fetchChildNodeByIndex(e),f=this.$2.fetchChildNodeByIndex(o),u=n.filterItem.isChecked(this.$2.fetchChildNodeByIndex(t)),r;!!i&&!ss.referenceEquals(i,f);)n.filterItem.setChecked(i,u),r=new vt,r.setSingle(n.filterItem.getIndex(i),u),this.changelist.addChange(r),i=i.nextSibling;n.filterItem.setChecked(f,u);r=new vt;r.setSingle(n.filterItem.getIndex(f),u);this.changelist.addChange(r)},_updateCheckboxRangeFromAnchorByIndex:function(t){for(var u=Math.min(this._anchorIndex,t),f=Math.max(this._anchorIndex,t),e=n.filterItem.isChecked(this.$2.fetchChildNodeByIndex(t)),r,i=u;i<=f;++i)r=this.$2.fetchChildNodeByIndex(i),!r||(this.$2.handleClickIfPending(r),n.filterItem.setChecked(r,e))},_updateRangeAnchor:function(t){if(!this.$2.isSingleSelect()&&(this._anchorIndex!==t||!(t>=0))){var i;this._anchorIndex>=0&&(i=this.$2.fetchChildNodeByIndex(this._anchorIndex),!i||$(n.filterItem.getCssNode(i)).removeClass("anchorSelection"));this._anchorIndex=t;i=this.$2.fetchChildNodeByIndex(t);i?$(n.filterItem.getCssNode(i)).addClass("anchorSelection"):this._anchorIndex=-1;this._lastRangeSelectionIndex=-1}}});ss.initClass(wt,t,{addChange:function(n){this.$0.push(n)},compileForChecklist:function(n){for(var t,u,i,f={},e=0;e<this.$0.length;++e){t=this.$0[e];switch(t.type){case 0:f[t.index]=t.checkState;break;case 1:var r=t.range,a=t.checkState,v=Math.min(r.get_from(),r.get_to()),y=Math.max(r.get_from(),r.get_to());for(u=v;u<=y;++u)f[u]=a}}var s=[],h=[],o=new ss.ObjectEnumerator(f);try{while(o.moveNext()){var c=o.current(),l=parseInt(c.key,10),p=c.value;p?s.push(l):h.push(l)}}finally{o.dispose()}return i=new ur,i.select=s,i.deselect=h,i.domain=n,i},compileForRadiolist:function(n){var i=this.$0.length-1,r=this.$0[i],t=new fr;return t.index=r.index,t.domain=n,t},reset:function(){ss.clear(this.$0)},appendChangelist:function(n){for(var t=0;t<n.$0.length;t++)this.$0.push(n.$0[t])}});ss.initEnum(ff,t,{single:0,range:1});ss.initClass(rr,t,{instantiate:function(){this.setUpForPendingChanges();this.inherited(arguments)},fillMenu:function(n){this.inherited(arguments);this.appendApplyCancelButtons(n)},createListElement:function(t,i,r,u){var f=$(t),e,o;if(this.shouldUseAllItem()&&i.length>0&&p.addAllItem(f,this.parent,r,u,p.shouldCheckAllItem(this.parent.get_oFilter(),this.pendingManager),ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml)),ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy(),this.tiledWidget=d.createChecklist(this.parent,i,t,r,this.get_lineHeight()),e=spiff.EventUtil.bindWithDispose(f,"click",ss.mkdel(this.parent,this.parent.onListItemClick)),this.disposables.add$1(e),o=spiff.EventUtil.bindWithDispose(f,"touchend",ss.mkdel(this.parent,this.parent.onListItemClick)),this.disposables.add$1(o),tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters"))f.on("keyup",ss.mkdel(this,this.$l));f.parent().toggleClass("CFDropdownNoItems",i.length===0);i.length===0&&f.text(tab.Strings.QuickFilterNoItems)},$l:function(n){switch(n.which){case 13:case 32:this.parent.onListItemClick(n);break;default:return}n.stopPropagation();n.preventDefault()},resetPendingVisuals:function(t){var u,f,r,i;if(u=ss.isValue(this.searchBox)&&this.searchBox.isShowingResults()?this.menuNode.children(".tiledContent"):this.menuNode.find(".tile"),!ss.isNullOrUndefined(u))for(f=u.children().get(),r=0;r<f.length;r++)i=f[r],n.filterItem.isPending(i)&&(n.filterItem.togglePendingState(i),t&&n.filterItem.setChecked(i,!n.filterItem.isChecked(i)))}},h,[ss.IDisposable]);ss.initClass(p,t,{get_scrollNode:function(){return this.checkListContainer},instantiate:function(n,t,i){var r,u,f;this.setUpForPendingChanges();this.div.innerHTML="";this.$3=this.parent.get_searchWidget();this.$3.setStyle(2);r=$(this.div);this.$3.startupAndAppendTo(r);this.$3.hideUI();r.addClass("CFOuterContainer");u=$("<div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");tab.BrowserSupport.get_isFF()&&u.attr("tabindex","-1");r.append(u);this.checkListContainer=u.get(0);this.createChecklist(this.checkListContainer,n,t,i);this.div.addEventListener("focus",this.listItemFocusHandler,!0);this.disposables.add(ss.mkdel(this,function(){this.div.removeEventListener("focus",this.listItemFocusHandler,!0)}));this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this.parent,this.parent.onListItemClick)));this.appendApplyCancelButtons($(this.div));f=this.checkListContainer.querySelector("[role=listbox]");ss.isValue(f)&&f.setAttribute("aria-labelledby",this.parent.get_titleDomId())},resetContent:function(n,t,i){var r=$(this.checkListContainer);r.empty();ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);this.createChecklist(this.checkListContainer,n,t,i);this.appendApplyCancelButtons($(this.div))},updateContent:function(n){var t=$.contains(this.div,document.activeElement),i=n.length>0?n.join(""):this.$3.get_noMatchHtml(),r=$(this.checkListContainer);ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);r.html(i);this.updateTabIndexes(this.div,t)},shouldNotReinstantiate:function(){return ss.isValue(this.$3)&&this.$3.isShowingResults()},layout:function(n){this.inherited(arguments);ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h);var i=ss.isValue(this.$3)&&this.$3.get_isVisible()?dojo.marginBox(this.$3.domNode).h:0,t=0;this.parent.shouldDeferChanges()&&(t=dojo.marginBox(this.apply.element.get(0)).h,this.layoutApplyButton($(this.checkListContainer)));ss.isValue(this.checkListContainer)&&(this.checkListContainer.style.height=this.div.clientHeight-i-t+"px")},destroy:function(){this.dispose();ss.isValue(this.$3)&&this.$3.destroy();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):null},createChecklist:function(t,i,r,u){this.shouldUseAllItem()&&i.length>0&&p.addAllItem($(t),this.parent,r,u,p.shouldCheckAllItem(this.parent.get_oFilter(),this.pendingManager),ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml));ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=d.createChecklist(this.parent,i,t,r,this.get_lineHeight())},fetchAllItem:function(){return ss.isValue(this.checkListContainer)?this.checkListContainer.firstChild:null},resetPendingVisuals:function(t){var u,f,r,i;if(u=ss.isValue(this.$3)&&this.$3.isShowingResults()?$(this.checkListContainer):$(this.checkListContainer).find(".tile"),!ss.isNullOrUndefined(u))for(f=u.children().get(),r=0;r<f.length;r++)i=f[r],n.filterItem.isPending(i)&&(n.filterItem.togglePendingState(i),t&&n.filterItem.setChecked(i,!n.filterItem.isChecked(i)))}},l,[ss.IDisposable]);ss.initInterface(fi,t,{destroy:null,format:null,isValid:null});ss.initClass(oi,t,{destroy:function(){},format:function(n,t,i){var r="",f=ss.safeCast(n,Array),u,e;if(ss.isNullOrUndefined(t)||ss.isNullOrUndefined(i)||!this.isValid(f))return r;for(r+=ss.formatString(this.tileHtml,t.y.toString(),tab.DomUtil.generateUniqueId()),u=0,e=i.get_from();u<f.length;++u,++e)r+=this.$1(this.$0,f[u],this.$2,e);return r+"<\/div>"},isValid:function(){return!0}},null,[fi]);ss.initClass(ti,t,{isValid:function(n){var t=ss.safeCast(n,Array);return ss.isValue(t)&&t.length!==0}},oi,[fi]);ss.initClass(ur,t,{});ss.initClass(fr,t,{});ss.initClass(er,t,{init:function(n,t){tab.MiscUtil.isNullOrEmpty$3(n)?this.domCondition.style.display="none":(this.domConditionText.innerHTML=n,this.domCondition.title=n);tab.MiscUtil.isNullOrEmpty$3(t)?this.domLimit.style.display="none":(this.domLimitText.innerHTML=t,this.domLimit.title=t);tab.MiscUtil.isNullOrEmpty$3(n)||tab.MiscUtil.isNullOrEmpty$3(t)||(this.domLimit.style.borderTop="solid 1px #FAFAFA")},postCreate:function(){this.$0()},$0:function(){this.domConditionTitle.innerHTML=tableau.format.escapeHTML(tab.Strings.QuickFilterConditionalsCondition);this.domLimitTitle.innerHTML=tableau.format.escapeHTML(tab.Strings.QuickFilterConditionalsLimit)}},Object);ss.initClass(or,t,{get_data:function(){return this.$0},get_tileIndex:function(){return this.$2},get_itemRange:function(){return this.$1}},ss.EventArgs);ss.initClass(ai,t,{get_widgetNode:function(){return this.element},applyChanges:function(n){this.viewModel.set_sliderCurrentValue(n)},dispose:function(){ss.makeGenericType(spiff.BaseView$1,[et]).prototype.dispose.call(this);this.viewModel=null},onAddedToDomShim:function(){this.onAddedToDom()}},ss.makeGenericType(spiff.BaseView$1,[et]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[et]),tab.IContinuousSlider]);ss.initClass(et,t,{add_intermediateChange:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_intermediateChange:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_sliderValueChange:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_sliderValueChange:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_enabledChanged:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_enabledChanged:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_sliderClassName:function(){return this.$8},set_sliderClassName:function(n){this.$8=n},get_pixelWidth:function(){return this.$5},set_pixelWidth:function(n){this.$5=n},get_ruleTickCount:function(){return this.$7},set_ruleTickCount:function(n){this.$7=n},get_currentFraction:function(){return this.$2},set_currentFraction:function(n){this.$2=n;this.$2$2(this.$2)},get_sliderIntermediateValue:function(){return this.$4*1e3},get_sliderCurrentValue:function(){return this.get_currentFraction()*1e3},set_sliderCurrentValue:function(n){this.currentFractionUpdated(n/1e3)},get_sliderMinimumValue:function(){return 0},get_sliderMaximumValue:function(){return 1e3},get_rangeModel:function(){return this.$6},get_enabled:function(){return this.$3},set_enabled:function(n){this.$3!==n&&(this.$3=n,this.raiseActionEvent(this.$2$3))},applyIntermediateChange:function(n){this.$4=n/1e3;ss.isValue(this.$2$1)&&this.$2$1(this.$4)},currentFractionUpdated:function(n){var i=tab.DoubleUtil.truncateTwoDecimalPlaces(this.$2),t=tab.DoubleUtil.truncateTwoDecimalPlaces(n);i!==t&&this.set_currentFraction(t)}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,spiff.IHasEnabledState,tab.IContinuousSliderViewModel]);ss.initClass(sr,t,{get_showTitle:function(){return ss.isValue(this.lTitle)&&this.lTitle.length!==0},get_shouldLayoutTitleOnSeparateLine:function(){return this.zoneTitleWidth===0},$5:function(){return Math.max(this.pages.length-1,0)},$3:function(n){return this.pages.length!==0&&n!==this.pages.length-1},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},startup:function(){var t,n;this.containerNode=this.domNode;this.titleSize={w:0,h:0};this.inherited(arguments);this.innerWrapper.startup();this.innerWrapper.domNode.style.overflow="visible";this.buttonsContainer.startup();this.refreshLayout();this.show_toggle&&(t=document.createElement("div"),t.className="fakeCheckBox",ss.isValue(this._showHistoryCb.domNode)&&this._showHistoryCb.domNode.appendChild(t),n=document.createElement("label"),n.innerHTML=tableau.format.escapeHTML(tab.Strings.CurrentPagePanelShowHistory),n.setAttribute("for",this._showHistoryCb.id),ss.isValue(this._checkboxPane.domNode)&&(this._checkboxPane.attr("title",tab.Strings.CurrentPagePanelShowHistory),this._checkboxPane.domNode.appendChild(n)));this._rightBtn.setAttribute("_scroll",!1);this._leftBtn.setAttribute("_scroll",!1);this._slider.setAttribute("_scroll",!1)},layout:function(){var u=0,o=0,h=0,n,t,i,r,s,f,e,c;ss.isNullOrUndefined(this.titleSize)||ss.isValue(this.lTitle)&&this.titleSize.w===0||(n=dojo.marginBox(this.containerNode),t=n.w-this.DOM_OFFSET,this.get_showTitle()&&(this.titleSize.w<n.w?(this.cpOrientation=n.h<this.getWidgetOffset()?"horizontal":"vertical",t-=this.titleSize.w,u=this.titleSize.w):(this.cpOrientation=n.h-this.titleSize.h<this.getWidgetOffset()?"horizontal":"vertical",o=ss.Int32.div(this.titleSize.h,2))),this.cpOrientation==="horizontal"?(this.show_toggle&&(t-=this.TOGGLE_WIDTH_OFFSET),i=this.show_dropdown?this.BUTTONS_HEIGHT:this.SLIDER_HEIGHT):(i=this.show_slider?this.SLIDER_HEIGHT:0,i+=this.show_dropdown?this.BUTTONS_HEIGHT:0,h=this.show_toggle?ss.Int32.div(this.TOGGLE_HEIGHT,2):0),this.innerWrapper.isHorizontal=this.cpOrientation==="horizontal",dojo.marginBox(this.innerWrapper.domNode,ss.mkdict(["w",t,"h",i])),this.innerWrapper.resize(),r=dojo.marginBox(this.sliderPane.domNode),ss.isValue(this._horizontalRule)&&r.w>0&&(dojo.marginBox(this._horizontalRule.domNode,ss.mkdict(["w",r.w])),this._horizontalRule.domNode.style.display=this.pages.length*2>r.w?"none":""),s=Math.min(ss.Int32.div(n.h-i,2)-o-h,3),f=s+2*o,$(this.innerWrapper.domNode).css(ss.mkdict(["top",Math.max(f,0)+"px","position","absolute","left",u+ss.Int32.div(this.DOM_OFFSET,2)+"px"])),this.cpOrientation==="vertical"?($(this.buttonsContainer.domNode).css(ss.mkdict(["height",this.ONLY_BUTTONS+"px","position","relative","top","","left","","padding","0 0 2px 0"])),this.buttonsContainer.resize(),$(this.sliderPane.domNode).css(ss.mkdict(["height",this.SLIDER_HEIGHT+"px","position","relative","top","","left",""])),$(this._checkboxPane.domNode).css(ss.mkdict(["width",Math.max(n.w-1,0)+"px","top",Math.max(f,0)+i+s+"px","position","absolute","left",u+"px"]))):(dojo.marginBox(this.sliderPane.domNode,ss.mkdict(["w",r.w-this.WIDGET_SPACE])),ss.isValue(this._horizontalRule)&&dojo.marginBox(this._horizontalRule.domNode,ss.mkdict(["w",r.w-this.WIDGET_SPACE-this.RULE_OFFSET])),e=dojo.marginBox(this._dropdown.domNode),dojo.marginBox(this._dropdown.domNode,ss.mkdict(["w",e.w-this.WIDGET_SPACE])),dojo.marginBox(this._rightBtn.domNode,ss.mkdict(["l",e.l+e.w-this.WIDGET_SPACE])),$(this.buttonsContainer.domNode).css(ss.mkdict(["height",this.ONLY_BUTTONS+"px","position","","top","","left","","padding","0 0 2px 0"])),this.buttonsContainer.resize(),$(this.sliderPane.domNode).css(ss.mkdict(["height",this.SLIDER_HEIGHT+"px","position","","top","","left",ss.Int32.div(t+this.DOM_OFFSET,2)+"px"])),$(this._checkboxPane.domNode).css(ss.mkdict(["top",Math.max(f,0)+"px","position","absolute","left",u+t+ss.Int32.div(this.DOM_OFFSET,2)+"px"]))),c=parseInt($(this._dropdown.domNode).css("width"))-24,dojo.marginBox(this._dropdown.containerNode,ss.mkdict(["w",c])))},getWidgetOffset:function(){var n=this.show_dropdown?this.BUTTONS_HEIGHT:0;return n+=this.show_slider?this.SLIDER_HEIGHT:0,n+(this.show_toggle?this.TOGGLE_HEIGHT:0)},postMixInProperties:function(){this.display_dropdown=this.show_dropdown?"block":"none";this.display_slider=this.show_slider?"block":"none";this.display_toggle=this.show_toggle?"block":"none";var n=this.pages.length;this.maximum=this.$5();this.discrete_values=n;this.show_ruler=this.show_slider?"block":"none";this.ruler_count=n;this.popupClass=n>this.SCROLL_PAGES?"cpPopupEx":"cpPopup";this.cpOrientation=this.cpHeight<this.getWidgetOffset()?"horizontal":"vertical"},postCreate:function(){this.inherited(arguments);this.timestamp=(new Date).getTime();this.show_dropdown||this.innerWrapper.removeChild(this.buttonsContainer);this.show_slider||this.innerWrapper.removeChild(this.sliderPane);this.show_toggle&&"attr"in this._showHistoryCb&&this._showHistoryCb.attr("checked",this.enable)},$4:function(n,t){tab.FeatureFlags.isEnabled("PageCardImprovements")?this.$2(n,t):(this.$1(),this.requestTimeout=window.setTimeout(ss.mkdel(this,function(){this.$2(n,t)}),500))},$1:function(){this.requestTimeout=tab.MiscUtil.clearTimeout(this.requestTimeout)},$0:function(){this.rebuildLayoutTimeout=tab.MiscUtil.clearTimeout(this.rebuildLayoutTimeout)},$2:function(n){this.$1();this.isDashboard?tab.PageServerCommands.syncedChangePage(this.pageViewModel.get_pageModel(),this.pageViewModel.get_visualId(),this.zid,n):tab.PageServerCommands.changePage(n,this.pageViewModel.get_visualId())},destroy:function(){this.$1();this.$0();this.inherited(arguments)},updateProperties:function(n){this.sheetid=n.sheetid;this.zid=n.zid;this.enable=n.enable;this.show_slider=n.show_slider;this.show_toggle=n.show_toggle;this.show_dropdown=n.show_dropdown;this.current_page=n.current_page;this.pages=n.pages;this.session=n.session;this.lTitle=n.lTitle;this.titleHtml=n.titleHtml;this.zoneTitleHeight=n.zoneTitleHeight;this.zoneTitleWidth=n.zoneTitleWidth;this.isDashboard=n.isDashboard;this.pageViewModel=n.pageViewModel},setTitle:function(){this._titlePane.innerHTML=this.titleHtml;this.setTitleSize()},setTitleSize:function(){var n=dojo.marginBox(this._titlePane);this.get_shouldLayoutTitleOnSeparateLine()?n.w=dojo.marginBox(this.containerNode).w:(n.w=this.zoneTitleWidth,dojo.marginBox(this._titlePane,n));n.h=this.zoneTitleHeight===0&&this.get_showTitle()?dojo.marginBox(this.containerNode).h:this.zoneTitleHeight;this.titleSize=n;$(this._titlePane).css(ss.mkdict(["height",this.titleSize.h+"px"]));this.layout(null);tableau.util.setupTitleEllipsis($(this._titlePane))},refreshLayout:function(){var i,r,u,t,n,f,e;if(this.refreshed=!1,i=!1,r=ss.mkdel(this,function(){this.refreshed=!0;this.refreshWidget(this.current_page)}),this.show_dropdown){if(u=this.pages.length,t=!1,u!==this._dropdown.options.length)t=!0;else for(n=0;n<u;n++)if(f=this._dropdown.options[n].label,!ss.referenceEquals(this.pages[n],f)){t=!0;break}t?(this.$0(),i=!0,this._dropdown.options=[],this.rebuildLayoutTimeout=window.setTimeout(ss.mkdel(this,function(){for(var t=[],n=0,i=this.pages.length;n<i;n++)t.push(ss.mkdict(["label",this.pages[n],"value",n.toString(10),"selected",n===this.current_page]));this._dropdown.addOption(t);this._dropdown.startup();r()}),1),this._dropdown.popupExtraClass=this.pages.length>this.SCROLL_PAGES?"cpPopupEx":"cpPopup"):this._dropdown.setValue(this.current_page)}this.show_slider&&(ss.isValue(this._horizontalRule)&&(this._horizontalRule.destroy(!1),this._horizontalRule=null),this._slider.maximum=this.$5(),this._slider.discreteValues=this.pages.length,dijit.setWaiState(this._slider.focusNode,"valuemax",this.pages.length),this.pages.length<1200&&(e=ss.mkdict(["style","width:100%; height:3px; margin-left:4px; margin-right:4px;","count",this.pages.length]),this._horizontalRule=new dijit.form.HorizontalRule(e,this._horizontalRuleNode),this._horizontalRule.placeAt(this.sliderPane.domNode,2),this._horizontalRule.startup()),this._slider.startup());this._showHistoryCb.attr("value",this.enable);this.setTitle();i||r()},refreshWidget:function(n){var t,i,r;this.updating=!0;this.show_dropdown&&ss.isValue(this._dropdown)&&(this._dropdown.setValue(n),t=!this.$3(n),i=n===0,this._rightBtn.setAttribute("disabled",t),this._rightBtn.attr("iconClass","dijitIcon cpRightArrow"+(t?"Grey":"Black")),this._leftBtn.setAttribute("disabled",i),this._leftBtn.attr("iconClass","dijitIcon cpLeftArrow"+(i?"Grey":"Black")));this.show_slider&&ss.isValue(this._slider)&&this._slider.setValue(n);"attr"in this._showHistoryCb&&(r=this.pageViewModel.get_isHistoryToggleInteractionDisabled()||this.pages.length===0,this._showHistoryCb.attr("disabled",r));this.updating=!1},prevPage:function(){this.current_page!==0&&(this.$4(this.current_page-1,this.current_page),tab.FeatureFlags.isEnabled("PageCardImprovements")||this.refreshWidget(this.current_page-1))},nextPage:function(){this.$3(this.current_page)&&(this.$4(this.current_page+1,this.current_page),tab.FeatureFlags.isEnabled("PageCardImprovements")||this.refreshWidget(this.current_page+1))},onCheckboxChange:function(){this.refreshed&&(this.enable=!this.enable,tab.PageServerCommands.toggleTrails(this.pageViewModel.get_visualId()))},onSelection:function(n){if(!this.updating){var t=parseInt(n.toString());(t=isNaN(t)?0:t,t!==this.current_page&&this._started&&this.refreshed)&&(this.$2(t,this.current_page),this.refreshWidget(t))}},onSliderChange:function(n){if(!this.updating){var t=parseInt(n);t!==this.current_page&&this.refreshed&&(this.$4(t,this.current_page),this.refreshWidget(t))}},destroyRecursiveShim$1:function(){this.destroyRecursive()},updatePropertiesShim:function(n){this.updateProperties(n)},refreshLayoutShim:function(){this.refreshLayout()}},Object,[tab.ILegacyWidgetShim,tab.ICurrentPagePanelWidgetShim]);ss.initClass(k,t,{updateFilterProperties:function(n){this.titleHTML=n.titleHTML;this.format=n.format;this.backgroundColor=n.backgroundColor},hideEmptyTitlebar:function(){return ss.isNullOrEmptyString(this.titleHTML)},unformattedDisplayName:function(){return this.hideEmptyTitlebar()?"":tableau.format.formatColumnDisplayName(this.oFilter,!1,!1)},updateTitleBar:function(){this.domTitleBar.innerHTML=this.titleHTML;tab.FormattingConverters.cleanUpFontFamilyStyles($(this.domTitleBar))},setTitleSize:function(n,t){this.titleH=n;this.titleW=t},layoutTitleBar:function(){var n=dojo.marginBox(this.domTitleBar),t;return this.$0(),t=this.titleH===0&&this.titleW===0,(this.titleH>0||t)&&(n.h=this.titleH,s.setMarginBoxHeight(this.domTitleBar,n.h)),(this.titleW>0||t)&&(n.w=this.titleW,s.setMarginBoxWidth(this.domTitleBar,n.w)),tableau.util.setupTitleEllipsis($(this.domTitleBar)),n},$0:function(){ss.isValue(this.domTitleBar)&&$(this.domTitleBar).css({height:"auto",width:"auto"})}},Object);ss.initClass(ii,t,{setRangeType:function(n,t){var i,r,u;switch(n){case"curr":i=0;r=0;u=!0;break;case"todate":i=0;r=0;u=!1;break;case"last":i=-1;r=-1;u=!0;break;case"next":i=1;r=1;u=!0;break;case"lastn":i=1-t;r=0;u=!0;break;case"nextn":i=0;r=t-1;u=!0;break;default:return}this.firstPeriod=i;this.lastPeriod=r;this.isFutureIncluded=u},getRangeType:function(){var i=this.isFutureIncluded,n=this.firstPeriod,t=this.lastPeriod;return n===0&&t===0&&i?"curr":n!==0||t!==0||i?n===-1&&t===-1&&i?"last":n===1&&t===1&&i?"next":n<0&&t===0&&i?"lastn":n===0&&t>0&&i?"nextn":n>0&&t>0&&!i?"invalid":n>t?"invalid":n===t?"other":"othern":"todate"},adjustLastDate:function(n){var t=null;switch(this.periodType){case"year":case"quarter":case"month":case"week":case"day":t=new Date(n.getFullYear(),n.getMonth(),n.getDate());t=new Date(t.getTime()-tab.DateUtil.oneSecond);break;case"hour":case"minute":case"second":t=new Date(n.getTime()-tab.DateUtil.oneSecond)}return t},getPeriods:function(){return this.lastPeriod-this.firstPeriod+1},roundToPeriod:function(n,t,i){var r=n.getMonth(),u=n.getFullYear(),e,f,o,s;switch(this.periodType){case"year":return r<t&&(u-=1),new Date(u,t,1);case"quarter":return r>=t?(e=Math.floor((r-t)/3),r=t+e*3):(e=Math.floor((r+12-t)/3),f=(t+e*3)%12,f===0&&(f=12),f>r&&--u,r=f),new Date(u,r,1);case"month":return new Date(u,r,1);case"week":return o=(7+(1+n.getDay())-i)%7,s=new Date(u,r,n.getDate(),12),new Date(s.getTime()-o*tab.DateUtil.oneDay);case"day":return new Date(u,r,n.getDate());case"hour":return new Date(u,r,n.getDate(),n.getHours());case"minute":return new Date(u,r,n.getDate(),n.getHours(),n.getMinutes());case"second":return new Date(u,r,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())}return null},getEffectiveAnchor:function(){return ss.staticEquals(this.anchorDateTime,null)?new Date:this.anchorDateTime},getAnchorPeriod:function(n){return this.roundToPeriod(n,this.fy,this.startOfWeek)},evaluateFirstDate:function(n){return tab.DateUtil.adjustDateByPeriod(n,this.periodType,this.firstPeriod)},evaluateLastDate:function(n,t){var r=tab.DateUtil.adjustDateByPeriod(t,this.periodType,this.lastPeriod+1),i=this.adjustLastDate(r);return this.isFutureIncluded||(i=new Date(Math.min(n.getTime(),i.getTime()))),i},setPYear:function(){this.setPeriod("year")},setPQuarter:function(){this.setPeriod("quarter")},setPMonth:function(){this.setPeriod("month")},setPWeek:function(){this.setPeriod("week")},setPDay:function(){this.setPeriod("day")},setPHour:function(){this.setPeriod("hour")},setPMinute:function(){this.setPeriod("minute")},setPSecond:function(){this.setPeriod("second")},onTypingLast:function(){this.onTyping(this.inputLastn)},onTypingNext:function(){this.onTyping(this.inputNextn)},setRLast:function(){this.setRange("last")},setRCurr:function(){this.setRange("curr")},setRNext:function(){this.setRange("next")},setRLastn:function(){this.setRange("lastn",parseInt(this.inputLastn.value))},setRNextn:function(){this.setRange("nextn",parseInt(this.inputNextn.value))},setRTodate:function(){this.setRange("todate")},setRange:function(n,t){t=t||0;n!==this.rangeType&&(this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer),this.rangeType=n,this.setRangeType(n,t),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY));this.setRangeUI(n,t);this.setPreviewUI()},applyChanges:null,setRangeUI:null,setPeriod:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.setPeriodUI(n);n!==this.periodType&&(this.periodType=n,this.updateVisibilityOfDayToAnchor(),this.setPreviewUI(),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY*2))},updateVisibilityOfDayToAnchor:function(){this.oFilter.noTime&&this.periodType==="day"?(this.radioTodate.style.display="none",this.textTodate.style.display="none",$(this.textTodate).parent().find(".fakeRadio").css("display","none"),this.rangeType==="todate"&&this.setRCurr()):(this.radioTodate.style.display="",this.textTodate.style.display="",$(this.textTodate).parent().find(".fakeRadio").css("display",""))},onTyping:function(n){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);n.value=n.value.replace(new RegExp("/[^0-9]/g"),"");n.value.length>0&&parseInt(n.value)!==this.oFilter.rangeN&&(this.rangeN=parseInt(n.value),this.rangeType=ss.referenceEquals(n,this.inputLastn)?"lastn":"nextn",this.setRangeType(this.rangeType,this.rangeN),this._applyTimer=window.setTimeout(ss.mkdel(this,this.applyChanges),this.UPDATE_DELAY));this.setPreviewUI()},updateRangeButtons:null,setPeriodUI:function(n){var r,u,t,f,e;this.updateRangeButtons(n);t=ss.staticEquals(this.anchorDateTime,null)?i.get_nonAnchoredDescriptions()[n]:i.get_anchoredDescriptions()[n];this.textLast.innerHTML=t.last;this.textCurr.innerHTML=t.curr;this.textNext.innerHTML=t.next;f=t.lastn.split("%");this.textLastn1.innerHTML=f[0];this.textLastn2.innerHTML=f[1];e=t.nextn.split("%");this.textNextn1.innerHTML=e[0];this.textNextn2.innerHTML=e[1];this.textTodate.innerHTML=t.todate;r=parseFloat($(this.textLastn1).css("width"));u=parseFloat($(this.textNextn1).css("width"));r>u?this.textNextn1.style.width=r+"px":r<u&&(this.textLastn1.style.width=u+"px")},$1:function(){var n=null;return ss.isValue(this.oFilter)&&ss.isValue(this.oFilter.default_format)&&(n=this.oFilter.default_format),ss.isValue(n)&&n.length===3?n[0]:"*M/d/yyyy"},$2:function(){var n=null;return ss.isValue(this.oFilter)&&ss.isValue(this.oFilter.default_format)&&(n=this.oFilter.default_format),ss.isValue(n)&&n.length===3?n[1].substr(1):"hh:nn:ss ampm"},setPreviewUI:function(){this.domPreview.innerHTML=this.getPreviewMessage()},getPreviewMessage:function(){var o=this.getEffectiveAnchor(),s=this.$1(),h=this.$2(),u,c=this.getAnchorPeriod(o),n=this.evaluateFirstDate(c),l=s+" "+h,t=this.evaluateLastDate(o,c),i,r,e;if(this.isRangeValid(n,t)){var a=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds())),v=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())),f={};if(f.format=s,i=tableau.format.formatCustomJsDateTime(a,f,0,null),r=tableau.format.formatCustomJsDateTime(v,f,0,null),this.periodType==="hour"||this.periodType==="minute"||this.periodType==="second"||this.periodType==="day"&&!this.isFutureIncluded){var p=l,w=ss.referenceEquals(i,r)?h:l,y={};y.format=p;e={};e.format=w;i=tableau.format.formatCustomJsDateTime(a,y,0,null);r=tableau.format.formatCustomJsDateTime(v,e,0,null)}u=tab.Strings.RelDateFilterPreview(i,r)}else u="Invalid relative date",this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);return u},isRangeValid:function(n,t){var i=!0;return isNaN(n.getTime())||isNaN(t.getTime())?i=!1:this.firstPeriod>this.lastPeriod||this.firstPeriod>0&&!this.isFutureIncluded?i=!1:!!n&&!!t?(n<this.lowestAllowedDate||t>this.highestAllowedDate)&&(i=!1):i=!1,i}},k);ss.initClass(s,t,{});ss.initClass(lt,t,{});ss.initClass(hr,t,{get_tileIndex:function(){return this.$2},get_range:function(){return this.$0},get_rangeType:function(){return this.$1}});ss.initInterface(yr,t,{add_contentFetched:null,remove_contentFetched:null,destroy:null,fetch:null,isTilePending:null});ss.initClass(cr,t,{add_contentFetched:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_contentFetched:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},destroy:function(){},fetch:function(n){for(var i,r,t=0;t<n.length;++t)(i=n[t],ss.contains(this.$7,i.get_tileIndex()))||(this.$7.push(i.get_tileIndex()),this.$8.push(i));while(this.$8.length>this.$6)r=this.$8[0],ss.remove(this.$7,r.get_tileIndex()),ss.remove(this.$8,r);this.$2()},isTilePending:function(n){return ss.contains(this.$7,n)},$0:function(n){return ss.mkdel(this,function(){this.$1(n)})},$1:function(n){var t=ss.mkdel(this,function(t){this.$5=!1;ss.remove(this.$7,n.get_tileIndex());var i=new or(n.get_tileIndex(),n.get_range(),t);this.$1$1(this,i);this.$2()}),i=ss.mkdel(this,function(){this.$5=!1;ss.remove(this.$7,n.get_tileIndex());this.$2()});this.$9.getFilterItems(this.$4,this.$3,n.get_range(),t,i)},$2:function(){var n,t,i;this.$8.length>0&&!this.$5&&(this.$5=!0,n=this.$8.length-1,t=this.$8[n],ss.removeAt(this.$8,n),i=this.$0(t),window.setTimeout(i,0))}},null,[yr]);ss.initClass(e,t,{add_hidden:function(n){this.$3$1=ss.delegateCombine(this.$3$1,n)},remove_hidden:function(n){this.$3$1=ss.delegateRemove(this.$3$1,n)},add_escapeKeyPressed:function(n){this.$3$2=ss.delegateCombine(this.$3$2,n)},remove_escapeKeyPressed:function(n){this.$3$2=ss.delegateRemove(this.$3$2,n)},get_domXButton:function(){return this.domXButton},get_isVisible:function(){return this.isVisible},set_isVisible:function(n){this.isVisible=n},get_qf:function(){return this.qf},set_qf:function(n){this.qf=n},get_dijitDomNode:function(){return this.domNode},get_oResults:function(){return this.oResults},set_oResults:function(n){this.oResults=n},get_applyDelay:null,get_dijitClassName:function(){return this.declaredClass},postMixInProperties:function(){this.inherited(arguments);this.busy_gif_url=tableau.util.assetUrl("/images/busy.gif")},postCreate:function(){this._isTypeInList=!!this.get_qf()&&this.get_qf().get_isTypeInList()},resize:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},onQueryBoxKeyDown:function(n){var t=this.getOnQueryBoxKeyDownBehavior(n);!t||(t.stopEvent&&spiff.EventUtil.stopEvent(n),!t.functionToCall||window.setTimeout(t.functionToCall,10))},getOnQueryBoxKeyDownBehavior:function(n){var i={},t;i.functionToCall=null;i.stopEvent=!1;t=i;switch(n.keyCode){case 13:t.stopEvent=!0;break;case 27:t.stopEvent=!0;tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")&&tab.MiscUtil.isNullOrEmpty$3(this.getQuery())&&(ss.staticEquals(this.$3$2,null)||this.$3$2());this.onXButtonClick(null);break;case 16:t.stopEvent=!0;break;case 17:t.stopEvent=!0;break;default:(n.keyCode>=32||n.keyCode===8)&&(t.functionToCall=ss.mkdel(this,this.handleQueryTextChanged))}return t},handleQueryTextChanged:function(){this.$0()},onXButtonClick:function(){if(this._isTypeInList)this.clearSearch(!1,!1);else{var n=this.getQuery();this.hideUI();n!==""&&this.showUI$1()}},onButtonHover:function(n){$(n.target).addClass("Hover")},onButtonUnhover:function(n){$(n.target).removeClass("Hover")},toggleUI:function(){this.get_isVisible()?this.hideUI():this.showUI$1()},applyChangesByChangelist:function(){throw new ss.NotSupportedException;},isShowingResults:function(){return this.isVisible&&this.resultCount>0},focusQueryBox:null,getQuery:null,setQuery:null,updateSearch:null,notifyParentFilterOfChanged:function(){},showUI$1:function(){this.showUI(!1)},showUI:function(n){this.get_isVisible()||($(this.domNode).css("display","block"),this.isVisible=!0,n||this.get_qf().layout(null),this.focusQueryBox())},hideUI:function(){this.get_isVisible()&&(this.clearSearch(!1,!0),$(this.domNode).css("display","none"),ss.staticEquals(this.$3$1,null)||this.$3$1(),this.isVisible=!1,this.get_qf().layout(null))},clearSearch:function(n,t){n||(this.setQuery(""),this.$0());this.resultCount=0;this.get_qf().layout(null);t||this.focusQueryBox()},doCategoricalSearch:function(t){var i=this.get_qf().get_oFilter(),r=this.makeUniqueSearchItemIdPrefix(),u=ss.mkdel(this,function(t,i,u){return n.filterItem.getSearchResultHtml(this.get_qf(),t,r,u)});return gt.findMatches(t,i,ss.mkdel(this,this.formatTuple),u)},$0:function(){this.get_domXButton().title=ss.isNullOrEmptyString(this.getQuery())&&!this._isTypeInList?this.XBUTTON_CLOSE_TOOLTIP:this.XBUTTON_CLEAR_TOOLTIP},formatTuple:function(n){return tableau.format.formatTupleDisplayName(n,!0,this.get_qf().get_oFilter().role)},isSingleSelect:function(){return this.get_qf().isSingleSelect()},makeUniqueSearchItemIdPrefix:function(){return n.getBaseItemName(this.get_qf(),"SI")},currentDomain:function(){var n=tableau.types.QFDomain.QFD_ALL;return!this.get_qf().get_attributes()||(n=this.get_qf().get_attributes().values),n},doAjaxRemoteSearch:function(n,t,i,r,u){return this.get_qf().get_session().searchFilter(this.get_qf().get_field(),n,t,i,this.currentDomain(),r,u)}},Object);ss.initClass(ri,t,{get_noMatchHtml:function(){return this.NO_MATCHES},get_queryBox:function(){return this.domQueryBox},$5:function(){return this.get_qf()},setStyle:function(n){this.$8=n;var t=$(this.domNode);this.$8===1?(t.addClass("FilteringDropdown"),t.addClass("SearchCleared")):this.$8===2&&t.addClass("FilteringInline")},get_applyDelay:function(){return 0},startupAndAppendTo:function(n){n.append(this.domNode);this.startupNoAppend()},startupNoAppend:function(){this.startup()},layout:function(){},hideUI:function(){this.domNode.style.display="none";e.prototype.hideUI.call(this)},showUI:function(n){e.prototype.showUI.call(this,n);tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")||this.focusQueryBox()},focusQueryBox:function(){this.domQueryBox.focus()},getQuery:function(){return this.domQueryBox.value},setQuery:function(n){this.domQueryBox.value=n},onXButtonClick:function(n){this.$8===1?(this.clearSearch(!1,!1),$(this.get_domXButton()).removeClass("Hover")):e.prototype.onXButtonClick.call(this,n)},updateSearch:function(){this.get_isVisible()&&this.searchWithQuery(this.getQuery())},searchWithQuery:function(n){n.length<=0?this.clearSearch(!1,!1):this.get_qf().get_oFilter().isTiled?this.doRemoteSearch(n,!0):this.$2(this.doCategoricalSearch(n))},doRemoteSearch:function(n,t){this.doAjaxRemoteSearch(n,this.$6,t,ss.mkdel(this,this.$2),ss.mkdel(this,this.$3))},getOnQueryBoxKeyDownBehavior:function(n){var t,i;t=this.inherited(arguments);switch(n.keyCode){case 9:tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters")||(t.functionToCall=null,t.stopEvent=!0);break;case 37:case 39:case 38:t.functionToCall=null;t.stopEvent=!1;break;case 40:i=$(this.domNode.parentElement);i.find(".FIItem").eq(0).focus();t.functionToCall=null;t.stopEvent=!0;break;case 13:t.stopEvent=!0;t.functionToCall=ss.mkdel(this,this.$1)}return t},clearSearch:function(n,t){$(this.domNode).addClass("SearchCleared");$(this.domScreenReaderStatus).empty();this.resultCount===-1?t||this.focusQueryBox():(e.prototype.clearSearch.call(this,n,t),this.$5().filterBySearchResults(null),this.resultCount=-1)},handleQueryTextChanged:function(n){var t=500;$(this.domNode).removeClass("SearchCleared");e.prototype.handleQueryTextChanged.call(this,n);switch(this.domQueryBox.value.length){case 1:t=Math.round(t*1.5);break;case 2:t=Math.round(t*1.25)}this.$7=tab.MiscUtil.clearTimeout(this.$7);this.$7=window.setTimeout(ss.mkdel(this,this.updateSearch),t)},$1:function(){this.updateSearch()},$2:function(n){ss.isValue(n.length)?this.resultCount=n.length:ss.isValue(n.tuples)&&(this.resultCount=n.tuples.length,n=this.$4(n));this.$5().filterBySearchResults(n);$(this.domScreenReaderStatus).text(this.resultCount>0?tab.Strings.QuickFilterSearchFoundMatches(this.resultCount):tab.Strings.QuickFilterSearchNoMatches)},$4:function(t){for(var f=this.makeUniqueSearchItemIdPrefix(),r=t.tuples,e=t.indices,u=[],i=0;i<r.length;i++)u.push(n.filterItem.getSearchResultHtml(this.get_qf(),r[i],f,e[i]));return u},$3:function(){}},e);ss.initEnum(ef,t,{invalid:0,dropdown:1,inline:2});ss.initClass(bt,t,{getSearchResultHtml:null,formatChecklistFilterItemHtml:null,getCheckHtml:null,formatRadiolistFilterItemHtml:null,getRadioHtml:null,formatDropdownListFilterItemHtml:null,getDropdownHtml:null,getDropdownNoneHtml:null,getTypeInHtml:null,getSelectHtml:function(n,t,i,r){var u=['<option value="',"",'" ',"",">","","<\/option>"];return u[1]=tableau.format.escapeHTML(n),u[3]=i&&!r?"SELECTED":"",u[5]=tableau.format.escapeHTML(t),u.join("")},getCssNode:null,isPending:null,togglePendingState:null,setChecked:null,isChecked:null,syncCssToCheckState:null,setSelected:null,isSelected:null,isTiled:function(n){var t=n.parentNode;return ss.isValue(t)?$(t).hasClass("tile"):!1},getNodeFromEvent:null,getIndex:null,isTypeInListItem:null,isAllItem:null,getCheckboxOrRadio:function(n){var t=tableau.util.findElementByTagName(n,"input",ss.mkdict(["type","checkbox"]));return ss.isValue(t)?t:tableau.util.findElementByTagName(n,"input",ss.mkdict(["type","radio"]))}});ss.initClass(lr,t,{$1:function(n,t,i,r,u){var f=["<div tabindex='-1' role='option' class=\"","",'" id="',"",'"><div class="facet">',"",'<\/div><div class="facetOverflow"><a title="',"",'">',"","<\/a><\/div><\/div>"];return f[1]="FIItem FISimpleDropdownItem"+(u?" FINone":""),f[3]=n,f[7]=f[9]=t,f[5]=r?i:"",f.join("")},getSearchResultHtml:function(n,t,i,r){switch(n.get_mode()){case"checklist":case"checkdropdown":case"typeinlist":return this.formatChecklistFilterItemHtml(n,t,i,r);case"radiolist":return this.formatRadiolistFilterItemHtml(n,t,i,r);case"dropdown":return this.formatDropdownListFilterItemHtml(n,t,i,r)}return""},formatChecklistFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=n.shouldCheckFilterItemMultiValue(i,t),o=tableau.format.formatTupleDisplayName(i,!0,t.get_oFilter().role),s=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),h=n.showFacets(t),c=t.get_viewModel().get_filterType()!=="Hierarchical"&&ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(i,u);return this.getCheckHtml(f,o,e,s,h,c)},getCheckHtml:function(n,t,i,r,u,f){var e=['<div role="checkbox" tabindex="-1"',' class="','" id="',"",'"><div class="facet">',"",'<\/div><div class="facetOverflow"><input tabindex="-1" type="checkbox" class="FICheckRadio" name="',"",'" ',"",'><div class="fakeCheckBox"><\/div><a class="FIText" title="',"",'">',"","<\/a><\/div><\/div>"],o=f?"FIItem FIPending":"FIItem";return e[1]+=o,e[3]=e[7]=tableau.format.escapeHTML(n),e[9]="",e[11]=e[13]=tableau.format.escapeHTML(t),e[5]=u?r:"",i&&!f||!i&&f?(e[0]+=' aria-checked="true" ',e[1]+=" FIChecked",e[9]+=' checked="checked" '):e[0]+=' aria-checked="false" ',e.join("")},formatRadiolistFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=n.shouldCheckFilterItemSingleValue(i,t),o=tableau.format.formatTupleDisplayName(i,!0,t.get_oFilter().role),s=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),h=n.showFacets(t);return this.getRadioHtml(f,r,o,e,s,h)},getRadioHtml:function(n,t,i,r,u,f){var e=['<div role="radio" tabindex="-1"',' class="','" id="',"",'"><div class="facet">',"",'<\/div><div class="facetOverflow"><input tabindex="-1" type="radio" class="FICheckRadio" name="',"",'" ',"",'><div class="fakeRadio"><\/div><a class="FIText" title="',"",'">',"","<\/a><\/div><\/div>"];return e[1]+="FIItem",e[3]=tableau.format.escapeHTML(n),e[7]=tableau.format.escapeHTML(t),e[9]="",e[11]=e[13]=tableau.format.escapeHTML(i),e[5]=f?u:"",r?(e[0]+=' aria-checked="true" ',e[1]+=" FIChecked",e[9]+=' checked="checked" '):e[0]+=' aria-checked="false" ',e.join("")},formatDropdownListFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role),o=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),s=n.showFacets(t);return this.getDropdownHtml(f,e,o,s)},getDropdownNoneHtml:function(n,t,i,r){return this.$1(n,t,i,r,!0)},getDropdownHtml:function(n,t,i,r){return this.$1(n,t,i,r,!1)},getTypeInHtml:function(n,t){var i=['<div tabindex="0" class="FIItem FITypeInItem FIChecked" id="',"",'" title="',"",'">',"","<\/div>"];return i[1]=tableau.format.escapeHTML(n),i[3]=i[5]=tableau.format.escapeHTML(t),i.join("")},getCssNode:function(t){return n.getClassElement(t,"FIItem")},isPending:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FIPending")},togglePendingState:function(n){var t=this.getCssNode(n);$(t).toggleClass("FIPending")},setChecked:function(n,t,i){var u=this.getCssNode(n),r;return $(u).toggleClass("FIChecked",t).filter("[aria-checked]").attr("aria-checked",t),r=this.getCheckboxOrRadio(n),ss.isValue(r)&&(r.checked=t),ss.isValue(i)&&(i.s=t),$(r).is("input[type=radio]:checked")&&this.$0(u),i},$0:function(n){var t=$(n).siblings(".FIChecked").toArray();t.map(ss.mkdel(this,function(n){return this.setChecked(n,!1)}))},isChecked:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FIChecked")},syncCssToCheckState:function(n){var t=this.getCheckboxOrRadio(n);ss.isValue(t)&&this.setChecked(n,t.checked,null)},setSelected:function(n,t){var i=this.getCssNode(n);$(i).toggleClass("FISelected",t)},isSelected:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FISelected")},getNodeFromEvent:function(n){if(ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.target))return null;for(var t=n.target;ss.isValue(t)&&t.tagName!=="OPTION"&&!$(t).hasClass("FIItem");)t=t.parentNode;return t},getIndex:function(t){return n.getIndexFromId(t.id)},isTypeInListItem:function(n){var t=this.getCssNode(n);return ss.isValue(t)&&$(t).hasClass("FITypeInItem")},isAllItem:function(t){return ss.isNullOrUndefined(t)||this.isTypeInListItem(t)?!1:n.isAllItemId(t.id)}},bt);ss.initClass(ot,t,{$0:function(n,t,i,r,u){var f="";return r&&(f=i),['<div class="FIMContainer FIMDropdown'+(u?" FINone":"")+'" id="',n,'"><div class="facet">',f,'<\/div><span class="FIMCheckLabel tab-ctrl-formatted-fixedsize">',t,"<\/span><\/div>"].join("")},getSearchResultHtml:function(n,t,i,r){switch(n.get_mode()){case"checklist":case"checkdropdown":case"typeinlist":return this.formatChecklistFilterItemHtml(n,t,i,r);case"radiolist":return this.formatRadiolistFilterItemHtml(n,t,i,r);case"dropdown":return this.formatDropdownListFilterItemHtml(n,t,i,r)}return""},formatChecklistFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=n.shouldCheckFilterItemMultiValue(i,t),o=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role),s=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),h=n.showFacets(t),c=ss.isValue(t.get_modeContents().pendingManager)&&t.get_modeContents().pendingManager.isPending(i,u);return this.getCheckHtml(f,o,e,s,h,c)},getCheckHtml:function(n,t,i,r,u,f){var e="",s=f?"FIMPending":"",o="";return(i&&!f||!i&&f)&&(e=" FIMChecked"),u&&(o=r),['<div class="FIMContainer '+s+' facetOverflow" id="',n,'"><div class="facet">',o,'<\/div><span class="FIMCheckMark',e,'"><\/span><span class="FIMCheckLabel tab-ctrl-formatted-text',e,'">',t,"<\/span><\/div>"].join("")},formatRadiolistFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=n.shouldCheckFilterItemSingleValue(i,t),o=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role),s=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),h=n.showFacets(t);return this.getRadioHtml(f,null,o,e,s,h)},getRadioHtml:function(n,t,i,r,u,f){var e="",o="";return r&&(e=" FIMRadiolist FIMChecked"),f&&(o=u),['<div class="FIMContainer facetOverflow" id="',n,'"><div class="facet">',o,'<\/div><span class="FIMCheckMark',e,'"><\/span><span class="FIMCheckLabel tab-ctrl-formatted-text',e,'">',i,"<\/span><\/div>"].join("")},formatDropdownListFilterItemHtml:function(t,i,r,u){var f=n.getItemId(r,u),e=tableau.format.formatTupleDisplayName(i,!1,t.get_oFilter().role),o=tableau.format.formatTupleDisplayFacet(i,!1,t.get_oFilter().role),s=n.showFacets(t);return this.getDropdownHtml(f,e,o,s)},getDropdownNoneHtml:function(n,t,i,r){return this.$0(n,t,i,r,!0)},getDropdownHtml:function(n,t,i,r){return this.$0(n,t,i,r,!1)},getTypeInHtml:function(n,t){return['<div class="FIMContainer FIMTypeIn" id="',n,'"><span class="FIMCheckLabel tab-ctrl-formatted-text">',t,"<\/span><\/div>"].join("")},getCssNode:function(t){return n.getClassElement(t,"FIMContainer")},setChecked:function(n,t,i){var r=$(n).find(".FIMCheckMark"),u=$(n).find(".FIMCheckLabel");return ss.isValue(r)&&ss.isValue(u)&&(t?(r.addClass("FIMChecked"),u.addClass("FIMChecked")):(r.removeClass("FIMChecked"),u.removeClass("FIMChecked"))),ss.isValue(i)&&(i.s=t===!0),i},isChecked:function(n){if(ss.isValue(n)&&$(n).hasClass("FIMContainer")){var t=$(n).find(".FIMCheckMark");return ss.isValue(t)?t.hasClass("FIMChecked"):!1}return!1},isPending:function(n){return ss.isValue(n)?$(n).hasClass("FIMPending"):!1},togglePendingState:function(n){$(n).toggleClass("FIMPending")},syncCssToCheckState:function(n){var t=this.getCheckboxOrRadio(n);ss.isValue(t)&&this.setChecked(n,t.checked)},setSelected:function(n,t){var i=this.getCssNode(n);t?$(i).addClass("FIMSelected"):$(i).removeClass("FIMSelected")},isSelected:function(n){var t=this.getCssNode(n);return $(t).hasClass("FIMSelected")},getNodeFromEvent:function(n){if(ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.target))return null;for(var t=n.target;ss.isValue(t)&&t.tagName!=="OPTION"&&!$(t).hasClass("FIMContainer");)t=t.parentNode;return t},getIndex:function(t){return n.getIndexFromId(t.id)},isTypeInListItem:function(n){var t=this.getCssNode(n);return $(t).hasClass("FIMTypeIn")},isAllItem:function(t){return this.isTypeInListItem(t)?!1:n.isAllItemId(t.id)}},bt);ss.initClass(n,t,{});ss.initInterface(br,t,{add_scrolled:null,remove_scrolled:null,destroy:null,setContent:null,getTileElement:null,getItemElement:null});ss.initClass(ui,t,{add_scrolled:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_scrolled:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},get_windowNode:function(){return this.$6},get_tileContainerNode:function(){return this.$4},destroy:function(){this.$6.off("scroll");this.$4.remove()},setContent:function(n,t){var i=$(t);this.$4.append(i);this.$5[n]=i},getTileElement:function(n){return n<0||n>=this.$5.length?null:this.$5[n].get(0)},getItemElement:function(n,t){var r=this.getTileElement(n),i;return ss.isNullOrUndefined(r)?null:(i=r.children,i.length<t||t<0)?null:i[t]},$0:function(){var r=(new Date).getTime(),t=tab.DoubleUtil.roundToInt(this.$6.parent().offset().top)-tab.DoubleUtil.roundToInt(this.$4.offset().top),u=0,f,e,n,i;ss.isValue(this.$3)&&(f=Math.abs(this.$2-t),e=r-this.$1,u=f/Math.min(e,1e3));n=new au({x:0,y:t});this.$2=t;this.$1=r;this.$3=n;i=ss.mkdel(this,function(){ss.referenceEquals(n,this.$3)&&this.$1$1(this,n)});u>ui.$0?window.setTimeout(i,100):i()}},null,[br]);ss.initClass(ar,t,{$5:function(){return this.quickFilterDisplayViewModel.get_quickFilterDisplayModel()},get_getFilterModeMatrix:function(){return ss.isValue(this.$5())&&ss.isValue(this.$5().get_quickFilterModeMatrix())?this.$5().get_quickFilterModeMatrix():null},postCreate:function(){this.metricsOnly},dispose:function(){this.requestSetAttributes=null;this.$6.dispose()},updateFilterProperties:function(n){this.titleHTML=n.titleHTML;this.attributes=n.attributes;this.format=n.format;this.layoutSession=n.layoutSession;this.width=n.width;this.textStyle=n.textStyle;this.backgroundColor=n.backgroundColor},destroy:function(){this.dispose();this.inherited(arguments)},makeQuantitativeFilter:function(n){return new tableau.base.widget.LegacyQuantitativeQuickFilter(n)},makeQuantitativeDateFilter:function(n){return new tableau.base.widget.LegacyQuantitativeDateQuickFilter(n)},makeHierarchicalFilter:function(n){return new tableau.base.widget.LegacyHierarchicalQuickFilter(n)},makeCategoricalFilter:function(n){return new tableau.base.widget.LegacyCategoricalQuickFilter(n)},makeRelativeDateFilter:function(n){return new tableau.base.widget.LegacyRelativeDateQuickFilter(n)},makeRelativeDatePickFilter:function(n){return new tableau.base.widget.RelativeDatePickFilter(n)},setupEventHandlers:function(){var i=$(this.filter.domNode),n,t;this.$6.add$1(spiff.EventUtil.bindWithDispose(i,"mouseenter",ss.mkdel(this,this.$2)));this.$6.add$1(spiff.EventUtil.bindWithDispose(i,"mouseleave",ss.mkdel(this,this.$3)));n=ss.mkdel(this,function(){this.$4()});t=ss.mkdel(this,function(){window.setTimeout(ss.mkdel(this,function(){tab.DomUtil.isAncestorOf(this.domNode,document.activeElement)||this.hideControls()}),200)});this.domNode.addEventListener("focus",n,!0);this.domNode.addEventListener("blur",t,!0);this.$6.add(ss.mkdel(this,function(){this.domNode.removeEventListener("focus",n,!0);this.domNode.removeEventListener("blur",t,!0)}))},$1:function(n){var t={};return t.presModel=this.$5().get_quickFilterDisplayPresModel(),t.backgroundColor=this.$5().get_contentStyle().get_fillColor(),t.textStyle=this.textStyle,t.field=this.field,t.oFilter=n,t.filterViewModel=this.quickFilterDisplayViewModel.get_filterTypeViewModel(),t.layoutSession=this.layoutSession,t.zid=this.zid,t.format=this.format,t.attributes=this.attributes||{},t.requestSetAttributes=this.requestSetAttributes,t.titleH=this.$8,t.titleW=this.$9,t.titleHTML=this.titleHTML,t.width=this.width,t.getContextMenuCommands=ss.mkdel(this,function(){return this.getContextMenuCommands()}),t.showContextMenu=ss.mkdel(this,function(n){ss.isNullOrUndefined(this.get_getFilterModeMatrix())?this.showContextMenu(n):this.showFilterPicker()}),ss.isValue(this.session)?t.session=this.session:t.metricsOnly=!0,t},updateFilterState:function(n){if(ss.referenceEquals(this.field,tableau.format.formatQualifiedName(n.name))){!this.filter||ss.referenceEquals(this.filter.oFilter.type,n.type)&&(n.type!=="RD"||n.showRelDatePick===this.filter.oFilter.showRelDatePick)&&(n.type!=="C"||ss.referenceEquals(n.mode,this.filter.oFilter.mode))||(this.filter.destroy(!1),this.filter=null);this.textStyle=this.quickFilterDisplayViewModel.get_quickFilterDisplayPresModel().textStyle;var t=this.$1(n);ss.isNullOrUndefined(this.filter)?this.createFilterWidget(n,t):(this.filter.attributes=ss.isNullOrUndefined(this.attributes)?{}:this.attributes,this.filter.oFilter=n,this.filter.setTitleSize(this.$8,this.$9),this.filter.initFromState(),this.$0())}},createFilterWidget:function(n,t){ss.isNullOrUndefined(t)&&(t=this.$1(n));switch(n.type){case"Q":this.filter=tab.LegacyFilterModel.isQuantitativeDateFilter(n)?this.makeQuantitativeDateFilter(t):this.makeQuantitativeFilter(t);break;case"H":this.filter=this.makeHierarchicalFilter(t);break;case"C":this.filter=this.makeCategoricalFilter(t);break;case"RD":this.filter=n.showRelDatePick?this.makeRelativeDatePickFilter(t):this.makeRelativeDateFilter(t);break;default:this.domNode.style.display="none";return}this.addChild(this.filter);this.setupEventHandlers();this.filter.setTitleSize(this.$8,this.$9);this.$0();this.hideControls()},$0:function(){var n=this.$5().get_quickFilterDisplayPresModel().lineHeight;ss.isValue(this.session)&&dojo.marginBox(this.filter.domNode,dojo.contentBox(this.domNode));y.applyFormatting(this.domNode,this.textStyle,this.backgroundColor,n,!1);this.filter.layout(null)},$4:function(){this.$8>0&&$(this.filter.domControls).removeClass("HideControls")},hideControls:function(){$(this.filter.domControls).addClass("HideControls")},$2:function(){this.$4()},$3:function(n){var t=dojo.coords(this.filter.domNode,!0);(t.x>n.pageX||t.x+t.w<=n.pageX||t.y>n.pageY||t.y+t.h<=n.pageY)&&this.hideControls()},setTitleSize:function(n,t){this.$8=n;this.$9=t},resize:function(){this.$7=dojo.marginBox(this.domNode);this.inherited(arguments)},layout:function(){if(!!this.filter){var n=dojo.marginBox(this.domNode),t=_.isEqual(this.$7,n);t||(dojo.marginBox(this.filter.domNode,dojo.contentBox(this.domNode)),this.filter.setTitleSize(this.$8,this.$9),this.filter.layout(null))}},updateAttributes:function(n){this.attributes=ss.isNullOrUndefined(n)?{}:n},updateSubWidget:function(n){if(ss.isValue(this.filter)){var t=this.$1(n);this.filter.setTitleSize(t.titleH,t.titleW);this.filter.updateFilterProperties(t)}},getContextMenuCommands:function(){return ss.isValue(this.$5())&&ss.isValue(this.$5().get_quickFilterCommands())?this.$5().get_quickFilterCommands():{}},showContextMenu:function(n){var e=this.getContextMenuCommands(),r=[],f,t;tab.WidgetUtil.newMenuItemsFromCommands(r,e,function(n){return function(){var t=tab.CommandItemWrapper.create(n),i=tab.CommandSerializer.deserialize(t.get_command());tab.ServerCommands.executeServerCommand(i,"immediately")}});var o=function(n){var t=n.data;t()},i=spiff.MenuViewModel.createForMenu(new spiff.Menu(r),o),u=new spiff.ShowMenuOptions($(n),!1);u.additionalMenuClass="tabQFContextMenu";f=u;i.show(f);t=null;t=ss.mkdel(this,function(){i.remove_hidden(t);this.$4();$(n).find(":focusable").first().focus()});i.add_hidden(t)},showFilterPicker:function(){},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},updateAttributesShim:function(n){this.updateAttributes(n)},updateFilterStateShim:function(n){this.updateFilterState(n)},setTitleSizeShim:function(n,t){this.setTitleSize(n,t)},updateFilterPropertiesShim:function(n){this.updateFilterProperties(n)},updateSubWidgetShim:function(n){this.updateSubWidget(n)}},Object,[ss.IDisposable,tab.ILegacyWidgetShim,tab.IFilterPanelWidgetShim]);ss.initClass(vr,t,{get_textStyleModel:function(){return this.$2},get_backgroundColor:function(){return this.$0},get_lineHeight:function(){return this.$1}});ss.initInterface(vi,t,{get_filterTable:null,get_quickFilter:null,shouldDeferChanges:null,updateStateIfNeeded:null,clearRangeAnchorAndSelection:null,forEachSelected:null,onListItemClick:null,fetchChildNodeByIndex:null,handleItemClick:null,handleClickIfPending:null});ss.initClass(pr,t,{_getMenuItemForOption:function(n){if(ss.isNullOrEmptyString(n.value))return new dijit.MenuSeparator;var i=ss.mkdel(this,function(){this._setValueAttr(n)}),t={};return t.option=n,t.label=n.label,t.onClick=i,t.disabled=n.disabled||!1,new tableau.base.widget.ui.iMenuItem(t)}},Object);ss.initClass(ut,t,{postCreate:function(){if(this.inherited(arguments),this.$3)var n=new tableau.util.NoClickDelay(this.domNode)},$0:function(){this.getParent().focusChild(this)},$1:function(n){this.$2=tab.MiscUtil.clearTimeout(this.$2);this.$2=window.setTimeout(n,75)},_onClick:function(n){if(this.$3){if(!this._isReasonableEvent(n))return;var t=ss.mkdel(this,function(){this.getParent().onItemClick(this,n);spiff.EventUtil.stopEvent(n)});this.$0();this.$1(t)}else this.inherited(arguments)},_onHover:function(n){this.$3?this._onClick(n):this.inherited(arguments)}},dijit.MenuItem);ss.initClass(hi,t,{},ut);ss.initClass(of,t,{},hi);ss.initInterface(wr,t,{get_totalHeight:null,get_viewportHeight:null,get_itemHeight:null,get_tileCount:null,destroy:null,updateViewport:null,getTileStatus:null,updateTileStatus:null,getTilePosition:null,getTileRange:null,getTileRangeType:null,pixelToTileRange:null,itemToTileIndex:null,globalToLocalItemIndex:null});ss.initClass(a,t,{get_domBox:function(){return this.domBox},get_resetButton:function(){return this.resetButton},get_shouldDisableResetButton:function(){return ss.isValue(this.get_oFilter().all)&&this.get_oFilter().all},get_applyDelay:function(){return this.applyDelay},get_isTypeInList:function(){return this.isTypeInList},get_oFilter:function(){return this.oFilter},get_quickFilterViewModel:function(){return this.filterViewModel},get_viewModel:function(){return this.filterViewModel},get_dijitDeclaredClass:function(){return this.declaredClass},get_mode:function(){return this.mode},set_mode:function(n){this.mode=n},get_session:function(){return this.session},set_session:function(n){this.session=n},get_attributes:function(){return this.attributes},set_attributes:function(n){this.attributes=n},get_field:function(){return this.field},get_stateId:function(){return this.stateId},set_stateId:function(n){this.stateId=n},get_modeContents:function(){return this.modeContents},get_domContent:function(){return this.domContent},set_domContent:function(n){this.domContent=n},get_dijitDomNode:function(){return this.domNode},set_dijitDomNode:function(n){this.domNode=n},get_domain:function(){var n=null;return!this.get_attributes().values||(n=this.get_attributes().values),n},get_searchWidget:function(){return this.$i},set_searchWidget:function(n){this.$i=n},get_presModel:function(){return this.presModel},get_backgroundColor:function(){return this.backgroundColor},$e:function(){return this.$h},$f:function(n){this.$h=n},get_quickFilter:function(){return this},get_filterTable:function(){return this.get_quickFilterViewModel().get_catFilterTable()},get_canShowApplyAndCancelButtons:function(){return this.get_attributes()["show-apply"]==="true"},get_titleDomId:function(){return this.$4$1},set_titleDomId:function(n){this.$4$1=n},getCheckDropdownCatmodeClass:function(){return tableau.base.widget.catmode.CheckDropdown},getChecklistCatmodeClass:function(){return tableau.base.widget.catmode.Checklist},getRadiolistCatmodeClass:function(){return tableau.base.widget.catmode.Radiolist},getSliderCatmodeClass:function(){return tableau.base.widget.catmode.Slider},getDropdownCatmodeClass:function(){return tableau.base.widget.catmode.SimpleDropdown},getPatternCatmodeClass:function(){return tableau.base.widget.catmode.Pattern},getTypeInListCatmodeClass:function(){return tableau.base.widget.catmode.TypeIn},makeSmallSearchWidget:function(n,t){return new tableau.base.widget.SmallSearchWidget(n,t)},makeSearchWidget:function(n,t){return new tableau.base.widget.SearchWidget(n,t)},makeFilteringSearchWidget:function(n){return new tableau.base.widget.FilteringSearchWidget(n)},makePendingChangesManager:function(){return new eu(this.get_modeContents(),this.oFilter.table.actual_size,this.oFilter.exclude,this.oFilter.all)},postCreate:function(){this.getSID=ss.mkdel(this,function(){return this.get_stateId()});this.$6();this.$a();this.mode!=="pattern"&&s.disableTextSelection(this.get_domContent());this.filterViewModel.get_filterType()!=="Categorical";var n={};n.qf=this;this.mode==="slider"?this.set_searchWidget(this.makeSmallSearchWidget(n,this.searchDiv)):this.$d()?(this.set_searchWidget(this.makeFilteringSearchWidget(n)),this.get_searchWidget().add_hidden(ss.mkdel(this,this.$5))):this.set_searchWidget(this.makeSearchWidget(n,this.searchDiv));this.get_searchWidget().startup();this.initFromState(!0,!1)},processControlButtons:function(){if(!this.metricsOnly){var i=this.mode==="checkdropdown"||this.mode==="dropdown"||this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideSearchButton(),r=this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideDomainButton(),u=this.shouldHideContextMenu(),f=this.mode==="pattern"||this.mode==="typeinlist"||this.shouldHideResetButton(),t=0,n=function(n,i){i?($(n.domNode).removeClass("CFButtonR1 CFButtonR2 CFButtonR3 CFButtonR4"),n.domNode.classList.add("CFButtonHide")):(t+=1,n.domNode.classList.remove("CFButtonHide"),n.domNode.classList.add("CFButtonR"+t))};n(this.menuButton,u);n(this.domainButton,r);n(this.searchButton,i);n(this.resetButton,f);this.domControls.classList.add("CF"+t+"Button");$(this.menuButton.domNode).css("background-color",this.backgroundColor);$(this.domainButton.domNode).css("background-color",this.backgroundColor);$(this.searchButton.domNode).css("background-color",this.backgroundColor);$(this.resetButton.domNode).css("background-color",this.backgroundColor)}},updateStateIfNeeded:function(){this.set_stateId(this.get_stateId()+1)},handleClickIfPending:function(t){this.shouldDeferChanges()&&this.get_modeContents().pendingManager.handleItemClicked(n.filterItem.getIndex(t),t)},shouldDeferChanges:function(){var n=this.get_mode()==="checklist"||this.get_mode()==="checkdropdown";return this.get_canShowApplyAndCancelButtons()&&n},shouldHideResetButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-all"]==="false"||this.get_attributes()["show-filter-state"]==="false"},shouldHideSearchButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-search"]==="false"},shouldHideIncludeExclude:function(){return tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring||this.hideEmptyTitlebar()||this.get_attributes()["show-exclude"]==="false"},shouldHideDomainButton:function(){return this.hideEmptyTitlebar()||this.get_attributes()["show-morefewerbutton"]!=="true"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},$9:function(){return $(this.domNode).hasClass("CFInlineTitle")},resize$1:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},destroy:function(){ss.isValue(this.get_modeContents())&&typeof this.get_modeContents().destroy=="function"&&(this.get_modeContents().destroy(),this.modeContents=null);ss.isValue(this.get_searchWidget())&&(this.get_searchWidget().remove_hidden(ss.mkdel(this,this.$5)),this.get_searchWidget().destroy(),this.set_searchWidget(null));ss.isValue(this.$g)&&this.$g.cancelPendingChange();this.requestSetAttributes=null;this.getContextMenuCommands=null;this.showContextMenu=null;this.get_domContent().innerHTML="";this.domContent=null;this.inherited(arguments)},handleItemClick:function(t){if(ss.isValue(this.get_modeContents().pendingManager)&&this.get_modeContents().pendingManager.handleItemClicked(n.filterItem.getIndex(t),t),n.filterItem.isAllItem(t)){this.doSelectAll(this.isSingleSelect()||n.filterItem.isChecked(t));return}},$6:function(){this.mode=ss.coalesce(this.get_oFilter().mode,"checklist");ss.isNullOrEmptyString(this.get_oFilter().pattern)||(this.mode="pattern");this.isTypeInList=this.mode==="typeinlist"},initFromState:function(t,i,r){var f,u,e,o=tableau.format.formatColumnDisplayName(this.get_oFilter(),!1,!0),l=0,s="",k=this.get_oFilter().showFacets&&this.width>100,h,v=0,y=0,d=$.contains(this.domNode,document.activeElement),c;this.processControlButtons();c=ss.isValue(this.get_modeContents())&&this.$d();ss.isValue(this.get_modeContents())&&ss.isValue(this.get_modeContents().get_scrollNode())&&this.get_modeContents().get_scrollNode().scrollTop>0&&(v=this.get_modeContents().get_scrollNode().scrollTop);var p=ss.isValue(this.modeContents)&&ss.isValue(this.get_modeContents().pendingManager),g=p&&ss.isValue(this.get_modeContents().pendingManager.get_allItemCheckState()),nt=p&&ss.coalesce(this.get_modeContents().pendingManager.get_allItemCheckState(),!1),w=g?nt:this.get_oFilter().all||this.get_oFilter().allNotChecked,b=$(this.domNode);if(b.toggleClass("CFAll",w),b.toggleClass("CFValue",!w),this.get_oFilter().exclude?this.domNode.classList.add("CFExclusive"):this.domNode.classList.remove("CFExclusive"),this.updateResetButtonState(),this.updateDomainButton(),ss.isValue(this.get_modeContents())&&this.get_modeContents().shouldNotReinstantiate()){var tt=a.$0(this.$e(),this.get_oFilter()),it=this.$e().exclude!==this.get_oFilter().exclude,rt=a.$1(this.$e(),this.get_oFilter());this.$f(this.get_oFilter());ss.isValue(this.get_oFilter().domains)&&ss.contains(this.get_oFilter().domains,"relevant")&&tt||it?this.updateSearch():rt&&this.get_searchWidget().get_isVisible()&&this.get_searchWidget().toggleUI();return}if(this.$f(this.get_oFilter()),this.$6(),this.get_oFilter().exclude&&(o=tab.Strings.QuickFilterTitleBarExclusive(o)),this.domTitleBar.setAttribute("title",o),this.domTitleBar.setAttribute("id",this.get_titleDomId()),this.updateTitleBar(),c||(this.get_domContent().innerHTML=""),e=n.getBaseItemName(this,"FI"),f=this.mode==="pattern"?this.get_oFilter().pattern:this.get_oFilter().table.tuples,k&&(this.mode==="slider"||this.mode==="checklist"||this.mode==="checkdropdown"||this.mode==="radiolist"||this.mode==="dropdown")){for(h=this.get_oFilter().table.tuples,u=0;u<h.length;u++)l+=parseInt(h[u].f[0].v,10);s=l.toString()}c?(!r&&ss.isValue(this.modeContents.pendingManager)&&(this.get_modeContents().pendingManager.resetFilterInfo(this.get_oFilter().table.actual_size,this.get_oFilter().exclude,this.get_oFilter().all),this.get_modeContents().pendingManager.resetPendingChanges()),this.get_modeContents().resetContent(f,e,s)):(ss.isValue(this.get_modeContents())&&typeof this.get_modeContents().destroy=="function"&&(this.get_modeContents().destroy(),this.modeContents=null),this.$7(),this.get_modeContents().set_width(this.width),this.get_modeContents().instantiate(f,e,s));this.$g.refreshRangeAnchorAndSelection();this.conditionals.init(this.get_oFilter().condition,this.get_oFilter().limit);t||this.layout(null);!(!i&!this.$d())||this.updateSearch();ss.isValue(this.get_modeContents())&&ss.isValue(this.get_modeContents().get_scrollNode())&&(this.get_modeContents().updateTabIndexes(this.domNode,d),y=this.get_modeContents().get_scrollNode().scrollHeight-this.get_modeContents().get_scrollNode().clientHeight,this.get_modeContents().get_scrollNode().scrollTop=Math.min(v,y));$(this.domNode).off(a.$2).on(a.$2,ss.mkdel(this,this.onKeyDown))},onKeyDown:function(n){var r=$(document.activeElement);if(!r.is("input, textarea, button")){var i=r.filter(".FIItem"),t=i.length>0?$(n.currentTarget).find(".FIItem"):$([]),u=t.index(i[0]);switch(n.which){case 37:case 38:t.eq(u-1).focus();break;case 39:case 40:t.eq((u+1)%t.length).focus();break;case 36:t.first().focus();break;case 35:t.last().focus();break;case 32:i.find("input:first").click();break;case 27:if(this.get_shouldDisableResetButton())return;this.toggleReset();break;case 13:if(this.get_canShowApplyAndCancelButtons()){this.applyPendingChangesByChangelist();break}else return;default:return}n.preventDefault();n.stopPropagation()}},updateResetButtonState:function(){this.get_shouldDisableResetButton()?nt.disableResetButton(this.get_resetButton()):nt.enableResetButton(this.get_resetButton())},$2:function(){var n=null;(this.mode==="checkdropdown"?n=this.getCheckDropdownCatmodeClass():this.mode==="checklist"?n=this.getChecklistCatmodeClass():this.mode==="radiolist"?n=this.getRadiolistCatmodeClass():this.mode==="slider"?n=this.getSliderCatmodeClass():this.mode==="dropdown"?n=this.getDropdownCatmodeClass():this.mode==="pattern"?n=this.getPatternCatmodeClass():this.mode==="typeinlist"&&(n=this.getTypeInListCatmodeClass()),ss.isNullOrUndefined(n))||(this.modeContents=new n(this,this.get_domContent(),this.get_attributes()))},$7:function(){this.$2()},updateSearch:function(){this.get_searchWidget().updateSearch()},applyChanges:function(){this.get_modeContents().applyChanges()},applyChangesByChangelist:function(n){this.shouldDeferChanges()?(this.get_modeContents().pendingManager.processChanges(n),ss.isValue(this.get_modeContents().pendingManager.get_allItemCheckState())&&(ss.unbox(this.get_modeContents().pendingManager.get_allItemCheckState())?this.domNode.classList.add("CFAll"):this.domNode.classList.remove("CFAll"))):this.get_modeContents().applyChangesByChangelist(n,this.mode)},applyPendingChangesByChangelist:function(){if(this.get_modeContents().pendingManager.isSelectAll())this.$1(!0);else if(this.get_modeContents().pendingManager.isDeSelectAll())this.$1(!1);else{var n=this.get_modeContents().pendingManager.get_pendingChangelist();this.get_modeContents().applyChangesByChangelist(n,this.mode)}this.get_modeContents().pendingManager.resetPendingChanges()},cancelPendingChangesByChangelist:function(){this.get_modeContents().pendingManager.resetPendingChanges();this.initFromState(!1,!0,!0)},$d:function(){return this.mode==="checklist"||this.mode==="radiolist"||this.mode==="checkdropdown"||this.mode==="dropdown"},filterBySearchResults:function(n){ss.isNullOrUndefined(n)?this.initFromState(!1,!0,!0):this.$d()&&(this.modeContents.updateContent(n),this.$g.clearRangeAnchor())},updateStateFromSearch:function(n){var t=this.get_isTypeInList();this.get_isTypeInList()&&this.$c(n);this.initFromState(!1,t)},$c:function(t){for(var f,c={},e,h,r,u=this.get_oFilter().table.tuples,o,s,i=0;i<u.length;i++)e={},e.node=this.fetchChildNodeByIndex(i),e.tuple=u[i],o=u[i].d,ss.isNullOrUndefined(o)&&(o=u[i].t[0].v),c[o]=e;for(i=0;i<t.tuples.length;i++)r=t.tuples[i],s=r.d,ss.isNullOrUndefined(s)&&(s=r.t[0].v),f=c[s],ss.isValue(f)&&ss.isValue(f.node)?n.filterItem.setChecked(f.node,r.s,f.tuple):(h=tableau.util.binarySearch(Object).call(null,r,u,0,null,ss.mkdel(this,this.$b)),h.found||u.splice(h.index,0,r))},$b:function(n,t){var i=tableau.format.formatTupleDisplayName(n),r=tableau.format.formatTupleDisplayName(t);return ss.referenceEquals(i,r)?0:ss.compareStrings(i,r)<0?-1:1},fetchChildNodeByIndex:function(n){return this.get_modeContents().fetchChildNodeByIndex(n)},isSingleSelect:function(){return this.mode!=="checklist"&&this.mode!=="checkdropdown"&&this.mode!=="typeinlist"},updateDomainButton:function(){if(ss.isNullOrUndefined(this.get_oFilter().domains)||this.get_oFilter().domains.length<=1){this.domainButton.domNode.style.display="none";return}var n=this.domainButton.iconNode.classList;n.remove("wcIconDomainAll");n.remove("wcIconDomainContext");n.remove("wcIconDomainRelevant");this.get_attributes().values===tableau.types.QFDomain.QFD_RELEVANT?(this.domainButton.attr("label",tab.Strings.QuickFilterDomainShowMoreValues),n.add("wcIconDomainRelevant")):this.get_attributes().values===tableau.types.QFDomain.QFD_CONTEXT?(this.domainButton.attr("label",tab.Strings.QuickFilterDomainShowFewerValues),n.add("wcIconDomainContext")):(this.domainButton.attr("label",tab.Strings.QuickFilterDomainShowFewerValues),n.add("wcIconDomainAll"))},doMenu:function(){this.showContextMenu(this.menuButton.domNode)},toggleReset:function(){nt.disableResetButton(this.resetButton);this.doSelectAll(!0,!0)},toggleDomain:function(){var n=function(n){return n===tableau.types.QFDomain.QFD_CONTEXT};this.get_attributes().values===tableau.types.QFDomain.QFD_RELEVANT?this.$3(ss.mkdict(["values",tableau.types.QFDomain.QFD_ALL]),!1):this.get_attributes().values===tableau.types.QFDomain.QFD_CONTEXT?this.$3(ss.mkdict(["values",tableau.types.QFDomain.QFD_RELEVANT]),!1):_.any(this.get_oFilter().domains,n)?this.$3(ss.mkdict(["values",tableau.types.QFDomain.QFD_CONTEXT]),!1):this.$3(ss.mkdict(["values",tableau.types.QFDomain.QFD_RELEVANT]),!1)},getTheAllItemNode:function(){return this.get_modeContents().fetchAllItem()},doSelectAll:function(n,t){this.shouldDeferChanges()?(this.get_modeContents().pendingManager.processAll(n),n?this.domNode.classList.add("CFAll"):this.domNode.classList.remove("CFAll"),t&&this.applyPendingChangesByChangelist()):this.$1(n)},$1:function(t){var i,e,r,u,f,o;if((this.mode==="checklist"||this.mode==="checkdropdown")&&$(this.get_domContent()).find(".tiledContent").length>0)for(e=this.get_oFilter().table.actual_size,o=this.get_oFilter().exclude?!t:t,i=0;i<e;++i)u=this.fetchChildNodeByIndex(i),ss.isValue(u)&&n.filterItem.setChecked(u,o);if(tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&(f=new tab.LegacyCategoricalQuickFilterData(this.get_oFilter().targetSheets,this.get_field(),this.get_oFilter().exclude,null),t&&f.set_includeAll(!0),tab.FilterClientCommands.updateCategoricalFilter(f)),t)tab.FilterClientCommands.setCategoricalFilterValues(this.get_session().get_visualId(),this.get_field(),"filter-all",null,null);else if(this.mode==="checklist"||this.mode==="checkdropdown"){if(nt.enableResetButton(this.resetButton),r={},r.schema=this.get_oFilter().table.schema,r.tuples=[],this.get_oFilter().exclude){this.$4();return}tab.FilterClientCommands.setCategoricalFilterValues(this.get_session().get_visualId(),this.get_field(),"filter-replace",[],null)}},$4:function(){var i,t,r=0,u=this.get_oFilter().table.actual_size-1,f=new wt,e=new vt;if($(this.get_domContent()).find(".tiledContent").length>0)for(t=r;t<=u;t++)i=this.get_modeContents().fetchChildNodeByIndex(t),ss.isValue(i)&&n.filterItem.setChecked(i,!0);e.setRange(new tab.IntegerRange(r,u),!0);f.addChange(e);this.get_modeContents().applyChangesByChangelist(f,this.mode)},toggleSearchUI:function(){this.get_searchWidget().toggleUI()},$3:function(n,t){this.requestSetAttributes(n,t)},doscrollHoriz:function(){this.get_domContent().scrollLeft=this.domHorizScroll.scrollLeft},$8:function(){return this.mode==="slider"||this.mode==="dropdown"||this.mode==="checkdropdown"||this.mode==="pattern"},getTitleOffset:function(){return $(this.domNode).hasClass("CFInlineTitle")?0:dojo.marginBox(this.domTitleBar).h},_getSearchWidgetDim:function(){var t=this.get_searchWidget().get_dijitDomNode(),n;return $(t).css("display")==="none"||this.$d()?(n={},n.h=0,n.l=0,n.t=0,n.w=0,n):dojo.marginBox(t)},layoutVertical:function(n){var t,r=ss.mkdict(["h",0]),i=ss.mkdict(["h",0]);this._layoutSearchWidget(n);i=this._getSearchWidgetDim();t=n.h-r.h-i.h;this.get_modeContents().layout({w:n.w,h:t},!1)},_getContentFloatingElement:function(){return this.get_isTypeInList()?this.get_searchWidget().get_dijitDomNode():this.get_domContent()},_layoutSearchWidget:function(n){var t,i;this.get_searchWidget().get_isVisible()&&(i=ss.mkdict(["h",0]),t=n.h-i.h,this.get_searchWidget().layout(t))},_layoutTypeInList:function(n){this.$9()?dojo.marginBox(this.get_searchWidget().get_dijitDomNode(),n):$(this.get_searchWidget().get_dijitDomNode()).css({height:"auto",width:"auto"});this.layoutVertical(n)},_layoutCompactFilter:function(n){this.domNode.classList.add("CFHorizontal");this._layoutSearchWidget(n);this.get_modeContents().layout({w:n.w,h:n.h},!1)},updateTitleBar:function(){this.inherited(arguments);var n=this.get_oFilter().exclude?tab.Strings.QuickFilterExclusive:tab.Strings.QuickFilterInclusive;$("<span>").addClass("sr-only").text(tab.Strings.Filter+" ").prependTo(this.domTitleBar);$("<span>").addClass("sr-only").text(" "+n).appendTo(this.domTitleBar)},layout:function(){var i,r,t,n;(this.updateTitleBar(),ss.isNullOrUndefined(this.domNode.parentNode))||(this.domNode.classList.remove("CFHorizontal"),this.domNode.classList.remove("CFInlineTitle"),this.domHorizScroll.style.display="none",r=this.layoutTitleBar(),t=dojo.contentBox(this.domNode),n={w:t.w,h:t.h},this.metricsOnly||(i=this._getContentFloatingElement(),this.hideEmptyTitlebar()?i.style.cssFloat="none":this.titleW>0?(n.w=t.w-r.w,this.domTitleBar.style.cssFloat="left",i.style.cssFloat="left",this.domNode.classList.add("CFInlineTitle")):(n.h=t.h-r.h,this.domTitleBar.style.cssFloat="none",i.style.cssFloat="none")),this.$8()?this._layoutCompactFilter(n):this.get_isTypeInList()?this._layoutTypeInList(n):this.layoutVertical(n))},$a:function(){s.localizeDojoLabeledControls([{item1:this.searchButton,item2:"QuickFilterSearch"},{item1:this.domainButton,item2:"QuickFilterDomainShowFewerValues"},{item1:this.menuButton,item2:"QuickFilterShowContextMenu"}])},clearRangeAnchorAndSelection:function(){this.$g.clearRangeAnchorAndSelection()},forEachSelected:function(n){var i,t,u,r,f;if(!ss.isNullOrUndefined(n)&&$.isFunction(n))for(i=this.$g.get_selectedIndexes(),t=0,u=i.length;t<u;t++)r=i[t],f=this.fetchChildNodeByIndex(r),n(r,f)},onListItemClick:function(n){this.$g.onListItemClick(n)},notifyChange:function(n){this.$g.notifyChange(n)},$5:function(){ss.isValue(this.domNode)&&$.contains(this.domNode,document.activeElement)&&this.modeContents.updateTabIndexes(this.domNode,!0)}},k,[vi]);ss.initClass(kr,t,{get_filterType:function(){return this.$2.get_filterType()},get_legacyCategoricalQuickFilterModel:function(){return this.$2},get_mode:function(){return this.$2.get_mode()},get_pattern:function(){return this.$2.get_pattern()},get_isAllMode:function(){return this.$2.get_isAllMode()},get_allItemsAreChecked:function(){return this.$2.get_allItemsAreChecked()},get_noItemsAreChecked:function(){return this.$2.get_noItemsAreChecked()},get_exclude:function(){return this.$2.get_exclude()},get_isTiled:function(){return this.$2.get_isTiled()},get_isSearchable:function(){return this.$2.get_isSearchable()},get_summary:function(){return this.$2.get_summary()},get_underlyingDataSourceIsCube:function(){return this.$2.get_underlyingDataSourceIsCube()},get_condition:function(){return this.$2.get_condition()},get_limit:function(){return this.$2.get_limit()},get_rangeType:function(){return this.$2.get_rangeType()},get_catFilterTable:function(){return this.$2.get_catFilterTable()},get_domainActualSize:function(){return this.$2.get_domainActualSize()},get_tuples:function(){return this.$2.get_tuples()},handleUpdateFilterContent:function(){},dispose:function(){this.$2.remove_filterUpdated(ss.mkdel(this,this.handleUpdateFilterContent));this.$2=null;spiff.BaseViewModel.prototype.dispose.call(this)}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IFilterTypeViewModel]);ss.initClass(kt,t,{});ss.initClass(u,t,{get_applyDelay:function(){throw new ss.NotSupportedException;},get_isTypeInList:function(){return!1},get_oFilter:function(){return this.oFilter},get_quickFilterViewModel:function(){return this.filterViewModel},get_viewModel:function(){return this.filterViewModel},get_dijitDeclaredClass:function(){return this.declaredClass},get_mode:function(){return this.$d},set_mode:function(){window.alert(tab.Strings.noLoc("Bad interface call to set LegacyHierarchicalQuickFilter.Mode"))},get_session:function(){return this.session},set_session:function(n){this.session=n},get_domain:function(){var n=null;return!this.get_attributes().values||(n=this.get_attributes().values),n},get_attributes:function(){return this.attributes},set_attributes:function(n){this.attributes=n},get_field:function(){return this.field},get_stateId:function(){return this.stateId},set_stateId:function(n){this.stateId=n},get_modeContents:function(){return null},get_domContent:function(){return this.domContent},set_domContent:function(n){this.domContent=n},get_dijitDomNode:function(){return this.domNode},set_dijitDomNode:function(n){this.domNode=n},get_searchWidget:function(){return this.searchWidget},set_searchWidget:function(n){this.searchWidget=n},destroy:function(){this.tree.remove_notifyChangeCalled(ss.mkdel(this,this.$9));this.searchWidget.destroy();this.searchWidget=null;this.tree.destroy();this.tree=null;this.inherited(arguments)},applyChangesByChangelist:function(){window.alert(tab.Strings.noLoc("Bad interface call on LegacyHierarchicalQuickFilter.ApplyChangesByChangelist"))},postCreate:function(){var n,t;this.filterViewModel.get_filterType()!=="Hierarchical";this.$b=ss.mkdel(this,function(){return this.stateId});n={};n.qf=this;this.searchWidget=new tableau.base.widget.SearchWidget(n,this.searchDiv);this.searchWidget.startup();this.initFromState(!0);this.$8();t=this.tree;_.each(this.tree.rootNode.getChildren(),function(n){n.isExpandable&&t._expandNode(n)});u.$0(this.textStyle,this.backgroundColor)},$3:function(){if(!!tab.BrowserSupport.get_isIE()){var n=$(this.domContent);n.css("zoom","1");tab.WindowHelper.requestAnimationFrame(function(){tab.RenderUtil.manualFadeAnimation(n,96,100,8,3875,!0)})}},shouldHideLevelButtons:function(){return this.attributes["show-levels"]==="false"},shouldHideSearchButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-search"]==="false"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},resize:function(n){dojo.marginBox(this.domNode,n);this.layout(null)},isSingleSelect:function(){return this.$d!=="checklist"},initMode:function(){this.$d=this.$6()},$6:function(){var n="checklist";return ss.keyExists(this.attributes,"mode")&&(n=this.attributes.mode),n},createTreeDom:function(){var n=new tableau.base.widget.hsm.TreeModel(this.session,this.field,this.oFilter.levels.length,this.isSingleSelect()),t;n.onChildrenChange(n.root,n.itemsFromTable(this.oFilter.table[0],0));t={};t.model=n;t.showRoot=!1;this.tree=new tableau.base.widget.hsm.Tree(t);this.tree.add_notifyChangeCalled(ss.mkdel(this,this.$9));this.connect(this.tree,"_onTreeFocus",ss.mkdel(this,this.updateRangeAnchor));this.domContent.appendChild(this.tree.domNode)},initFromState:function(n){var r,t,i;ss.referenceEquals(this.$6(),this.$d)||$(this.domContent).empty();this.domContent.hasChildNodes()||(this.initMode(),this.createTreeDom());r=tableau.format.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",r);this.updateTitleBar();ss.isValue(this.domLevelContainer)&&$(this.domLevelContainer).empty();this.shouldHideLevelButtons()?ss.isValue(this.domLevelBox)&&this.domLevelBox.setAttribute("display","none"):this.$4();n||this.tree.model.refresh(this.oFilter.table);ss.isValue(this.tree.anchor)?(this.tree.anchor.labelNode.classList.add("anchorSelection"),this.tree.anchor.domNode.classList.add("anchorSelectionNode")):this.tree.anchor=null;this.conditionals.init(this.oFilter.condition,this.oFilter.limit);this.layout(null);ss.isValue(this.searchWidget)&&this.searchWidget.updateSearch();t=0;this.metricsOnly||(i=ss.mkdel(this,function(n,i){this._hasDomNode(n)&&(i?($(n.domNode).removeClass("HFButtonR1 HFButtonR2"),n.domNode.classList.add("HFButtonHide")):(t+=1,n.domNode.classList.remove("HFButtonHide"),n.domNode.classList.add("HFButtonR"+t)),$(n.domNode).css("background-color",this.backgroundColor))}),i(this.menuButton,this.shouldHideContextMenu()),i(this.searchButton,this.shouldHideSearchButton()),this.domControls.classList.add("HF"+t+"Button"))},$4:function(){var n,t;if(!ss.isNullOrUndefined(this.domLevelBox))for(n=document.createElement("td"),n.appendChild(document.createTextNode(" ")),n.classList.add("HFLevelSpacer"),t=0;t<this.oFilter.levels.length;t++)n=document.createElement("td"),n.appendChild(document.createTextNode(t.toString())),this.domLevelContainer.appendChild(n),this.$d!=="radiolist"&&(this.oFilter.levels[t]===0?n.classList.add("HFLevelAllSelected"):this.oFilter.levels[t]===1?n.classList.add("HFLevelNoneSelected"):n.classList.add("HFLevelSomeSelected")),t===0?n.classList.add("HFLevelFirst"):t<this.oFilter.levels.length-1?n.classList.add("HFLevelNonLeaf"):n.classList.add("HFLevelLast"),this.connect(n,"onclick",ss.mkdel(this,this.onLevelClick))},doMenu:function(){this.showContextMenu(this.menuButton.domNode)},$1:function(){var o=[],f=[],i=[].concat.apply([],this.tree.rootNode.getChildren()),s="filter-delta",h=[],c=[],n,t,r,u,l,e;if(i.length!==0){do{if(n=i.shift(),t=n.item.tuple,n.item.schema.length>o.length&&(o=n.item.schema),n.isChecked&&!t.s){if(t.s=!0,f.push(t),this.isSingleSelect()){s="filter-replace";break}}else!n.isChecked&&t.s&&(delete t.s,f.push(t));i=i.concat.apply(i,n.getChildren())}while(i.length!==0);if(r=f,r.length!==0){for(u=0;u<r.length;u++)l=r[u].t.length-1,e=r[u].t[l].v,r[u].s?h.push(e):c.push(e);tab.FilterClientCommands.doMemberHierarchialFilter(this.session.get_visualId(),this.field,h,c,s)}}},$2:function(n,t){if(!ss.isNullOrUndefined(n)&&!ss.isNullOrUndefined(t)){var h=this.tree.getDepth(t),u=this.tree.findEarlierNode(t,n,h),c=ss.referenceEquals(u,t)?n:t,f=u.item.tuple.t,e=c.item.tuple.t,o=f[f.length-1].v,s=e[e.length-1].v,i={},r={};n.isChecked?(i[this.RANGE_START]=o,i[this.RANGE_END]=s):(r[this.RANGE_START]=o,r[this.RANGE_END]=s);tab.FilterClientCommands.doRangeHierarchialFilter(this.session.get_visualId(),this.field,i,r,"filter-delta")}},updateStateFromSearch:function(n){for(var i,o={},f=n.tuples,u=0;u<f.length;u++)o[f[u].d]=f[u].s===!0;for(i=[].concat.apply([],this.tree.rootNode.getChildren());i.length!==0;){var t=i.shift(),r=t.item.tuple,e=o[r.d];ss.isValue(e)?e!==r.s&&(e?(t.isChecked=!0,t.labelNode.firstChild.checked=!0,r.s=!0):(t.isChecked=!1,t.labelNode.firstChild.checked=!1,delete r.s)):this.isSingleSelect()&&r.s&&(t.isChecked=!1,t.labelNode.firstChild.checked=!1,delete r.s);i=i.concat.apply(i,t.getChildren())}},updateRangeAnchor:function(n){this.isSingleSelect()||ss.referenceEquals(this.tree.anchor,n)||(ss.isValue(this.tree.anchor)&&(this.tree.anchor.labelNode.classList.remove("anchorSelection"),this.tree.anchor.domNode.classList.remove("anchorSelectionNode"),this.tree.anchor.labelNode.classList.remove("dijitTreeLabelFocused"),this.tree.prev_anchor=this.tree.anchor),this.tree.anchor=n,this.tree.anchor.labelNode.classList.add("anchorSelection"),this.tree.anchor.domNode.classList.add("anchorSelectionNode"))},$9:function(n){if(n.target.tagName.toLowerCase()==="input"){this._applyTimer=tab.MiscUtil.clearTimeout(this._applyTimer);this.stateId++;var t=dijit.getEnclosingWidget(n.target.parentNode);ss.referenceEquals(this.tree.anchor,t)||this.updateRangeAnchor(t);n.shiftKey===!0&&ss.isValue(this.tree.prev_anchor)&&this.tree.getDepth(this.tree.prev_anchor)===this.tree.getDepth(this.tree.anchor)&&!this.isSingleSelect()?(this.updateCheckboxRange(this.tree.anchor,this.tree.prev_anchor),this.$2(this.tree.anchor,this.tree.prev_anchor)):this._applyTimer=window.setTimeout(ss.mkdel(this,this.$1),this.$a)}},updateCheckboxRange:function(n,t){var e=this.tree.getDepth(t),u=this.tree.findEarlierNode(t,n,e),f=ss.referenceEquals(u,t)?n:t,r=n.isChecked,i=u;for(this.tree.anchorIsStart=!ss.referenceEquals(u,t);ss.isValue(i)&&i.isTreeNode&&!ss.referenceEquals(i,f);)i.labelNode.firstChild.checked=r,i.isChecked=r,i=this.$7(i,e);f.labelNode.firstChild.checked=r;f.isChecked=r},$7:function(n,t){var r=t,u=n,i=n.getNextSibling(),f;if(ss.isValue(i))return i;while(ss.isNullOrUndefined(i)&&r>=0)for(u=u.getParent(),r-=1,i=u.getNextSibling();ss.isValue(i);){if(f=this.$5(i,r,t),ss.isValue(f))return f;i=i.getNextSibling()}return r>=0?i:null},$5:function(n,t,i){var u,e,r,f;if(ss.isNullOrUndefined(n)||t<0||t>i)return null;if(t===i)return n;if(n.hasChildren())for(u=n.getChildren(),e=u.length,r=0;r<e;r++)if(f=this.$5(u[r],t+1,i),ss.isValue(f))return f;return null},toggleSearchUI:function(){ss.isValue(this.searchWidget)&&this.searchWidget.toggleUI()},onLevelClick:function(n){var t=n.target,r,u=[],f=[],i;t.tagName.toLowerCase()==="td"&&((spiff.EventUtil.stopEvent(n),this.isSingleSelect())||(i=parseInt(t.textContent,10),this.oFilter.levels[i]===0?(r=!1,t.classList.remove("HFLevelAllSelected"),t.classList.remove("HFLevelSomeSelected"),t.classList.add("HFLevelNoneSelected")):(r=!0,t.classList.remove("HFLevelNoneSelected"),t.classList.remove("HFLevelSomeSelected"),t.classList.add("HFLevelAllSelected")),r?u.push(i):f.push(i),(u.length>0||f.length>0)&&tab.FilterClientCommands.doLevelHierarchialFilter(this.session.get_visualId(),this.field,u,f,"filter-delta")))},layout:function(){var u=$(this.domContent),c,r;u.hide();this.domNode.classList.remove("HFHorizontal");var t=dojo.contentBox(this.domNode),f=ss.isValue(this.domLevelBox)?dojo.marginBox(this.domLevelBox):ss.mkdict(["w",0,"h",0]),e=dojo.marginBox(this.conditionals.domNode),o=ss.mkdict(["h",0]);this.updateTitleBar();var h=this.layoutTitleBar(),i=h.h,n=t.w;!this.hideEmptyTitlebar()&&this.titleW>0?(this.domNode.classList.add("HFHorizontal"),this.domTitleBar.style.cssFloat="left",ss.isValue(this.domLevelBox)&&(this.domLevelBox.style.cssFloat="left"),this._hasDomNode(this.menuButton)&&this.menuButton.domNode.classList.add("HFButtonHide"),this._hasDomNode(this.searchButton)&&this.searchButton.domNode.classList.add("HFButtonHide"),n-=h.w,i=0):(!this.shouldHideContextMenu()&&this._hasDomNode(this.menuButton)&&this.menuButton.domNode.classList.remove("HFButtonHide"),!this.shouldHideSearchButton()&&this._hasDomNode(this.searchButton)&&this.searchButton.domNode.classList.remove("HFButtonHide"),this.domTitleBar.style.cssFloat="none",ss.isValue(this.domLevelBox)&&(this.domLevelBox.style.cssFloat="none"));ss.isValue(this.searchWidget)&&this.searchWidget.get_isVisible()&&(c=t.h-i-f.h-e.h,this.searchWidget.layout(c),o=dojo.marginBox(this.searchWidget.get_dijitDomNode()));r=t.h-i-f.h-e.h-o.h;ss.isValue(this.domLevelBox)&&dojo.marginBox(this.domLevelBox,ss.mkdict(["w",n]));tab.FeatureFlags.isEnabled("MobileQFZoneInteractiveRedesign")&&tsConfig.is_mobile?(s.setMarginBoxWidth(this.domContent,n),this.domContent.style.maxHeight=r+"px"):dojo.marginBox(this.domContent,ss.mkdict(["h",r,"w",n]));this.$3();u.show()},_hasDomNode:function(n){return ss.isValue(n)&&ss.isValue(n.domNode)},$8:function(){s.localizeDojoLabeledControls([{item1:this.searchButton,item2:"QuickFilterSearch"}])}},k);ss.initClass(dr,t,{get_filterType:function(){return this.$2.get_filterType()},get_legacyHierarchicalQuickFilterModel:function(){return this.$2},get_hierarchyTables:function(){return this.$2.get_hierarchyTables()},get_levels:function(){return this.$2.get_levels()},get_isSearchable:function(){return this.$2.get_isSearchable()}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IFilterTypeViewModel]);ss.initClass(sf,t,{},f,[ss.IDisposable]);ss.initClass(hf,t,{get_domRoot:function(){return this.get_template().domRoot},get_domNode:function(){return this.get_template().domRoot.get(0)},$h:function(){return this.legacyLegendViewModel.get_viewSession()},get_serverRenderedModel:function(){return this.legacyLegendViewModel.get_presModel()},get_legendTemplate:function(){return this.get_template()},$d:function(){this.get_legendTemplate().domRoot.addClass("hover")},$e:function(){this.get_legendTemplate().domRoot.removeClass("hover")},showContextMenu:function(){this.legacyLegendViewModel.showEditColorsDialog()},onAddedToDom:function(){ss.makeGenericType(c,[it]).prototype.onAddedToDom.call(this);this.$k=(new Date).getTime();this.eventHandler=this.makeViewerInputHandler(this.get_legendTemplate().get_contentArea().get(0));this.get_viewModel().get_viewController().add_refreshLegacyLegendImages(ss.mkdel(this,this.refreshImages));tab.ViewController.add_selectionChanged(ss.mkdel(this,this.onSelectionChanged));this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.get_viewModel().get_viewController().remove_refreshLegacyLegendImages(ss.mkdel(this,this.refreshImages));tab.ViewController.remove_selectionChanged(ss.mkdel(this,this.onSelectionChanged))})));this.iterButtons=new tab.IteratorButtons(this.get_legendTemplate().get_contentArea(),!0,12);this.updateHighlightStatus();this.disposables.add$1(spiff.ClickHandler.targetAndClick(this.get_legendTemplate().highlighterButton,ss.mkdel(this,this.toggleHighlight)));this.disposables.add$1(spiff.ClickHandler.targetAndClick(this.get_legendTemplate().contextMenuButton,ss.mkdel(this,this.showContextMenu)));this.get_legendTemplate().domImageBody.on("load",ss.mkdel(this,function(){this.$f();this.setBodySize()}));this.get_legendTemplate().domImageBody.on("error",ss.mkdel(this,function(){this.onImageLoadFailed()}));this.refreshImages();this.get_legendTemplate().highlighterButton.attr("title",tab.Strings.LegendPanelHighlightSelectedItems);this.get_legendTemplate().contextMenuButton.attr("title",tab.Strings.TabAuthColorEditButton);var n=tsConfig.allow_highlight&&this.get_serverRenderedModel().isVisuallyCat&&this.get_serverRenderedModel().isHighlightAllowed;this.get_legendTemplate().highlighterButton.toggle(n);this.get_legendTemplate().contextMenuButton.toggle(this.legacyLegendViewModel.get_shouldShowContextMenu())},dispose:function(){this.legacyLegendViewModel.remove_newLegacyLegend(ss.mkdel(this,this.handleNewLegacyLegend));ss.isValue(this.eventHandler)&&(this.eventHandler.dispose(),this.eventHandler=null);this.iterButtons.dispose();ss.makeGenericType(c,[it]).prototype.dispose.call(this)},handleNewLegacyLegend:function(){var n=this.legacyLegendViewModel.get_presModel();ss.isValue(this.get_serverRenderedModel())&&this.get_serverRenderedModel().fieldNameId===n.fieldNameId&&ss.referenceEquals(this.get_serverRenderedModel().fieldName,n.fieldName)?(this.$f(),this.updateHighlightStatus()):this.refreshImages();this.layout()},handleValidStateChanged:function(){this.legacyLegendViewModel.$g()&&this.refreshImages()},onViewModelPropertyChanged:function(n,t){ss.compareStrings(t.get_propertyName(),"urlCacheInfo",!1)===0||(ss.compareStrings(t.get_propertyName(),"ParentZoneSizeChanged",!1)===0?(this.$g(),this.get_legendTooltip().get_isTooltipShown()&&this.get_legendTooltip().repositionWithinRegion(tab.DomUtil.getRectXY(this.get_legendTemplate().domBox))):ss.referenceEquals(t.get_propertyName(),"titleVisible")&&this.handleNewLegacyLegend())},$g:function(){var n=this.legacyLegendViewModel.$4();ss.isValue(n)&&!tab.SizeUtil.equals(n,this.$i)&&(this.get_legendTemplate().domBox.css(ss.mkdict(["width",n.w+"px","height",n.h+"px"])),this.$i=n)},get_visualId:function(){return tab.ModelUtils.getVisualId(this.legacyLegendViewModel.get_sheetName())},allowHover:function(){},disallowHover:function(){},addMouseBindings:function(){},cancelHover:function(){},updateHighlightStatus:function(){this.get_legendTemplate().highlighterButton.toggleClass("tabHighlightEnabled",this.get_serverRenderedModel().isHighlightEnabled);this.get_legendTemplate().highlighterButton.toggleClass("tabHighlightDisabled",!this.get_serverRenderedModel().isHighlightEnabled)},refreshImages:function(){var r=this.get_viewModel().$f(),n,t,i;this.$j+=1;this.bodySize=null;n=this.$j+"Z"+this.$k;t=ss.isValue(this.get_serverRenderedModel().fieldNameId)?this.get_serverRenderedModel().fieldNameId.toString():"";this.disallowHover();this.get_legendTemplate().domBox.addClass("LegendBusy");(tab.BrowserSupport.get_isSafari()||this.get_serverRenderedModel().isVisuallyCat)&&this.get_legendTemplate().get_contentArea().css("overflow","hidden");i=this.$h().formatLegendRegionTileURL(r,this.get_serverRenderedModel().legendType+"-body",this.get_serverRenderedModel().fieldName,t,n);this.get_legendTemplate().domImageBody.attr("src",i)},onImageLoadFailed:function(){this.get_legendTemplate().domContent.css("visibility","hidden")},onSelectionChanged:function(n,t){ss.referenceEquals(n,this.get_viewModel().get_viewController().get_sheetName())&&(ss.isNullOrUndefined(t)||this.allowHover())},getDocumentPoint:function(n){var t={x:0,y:0};return this.get_legendViewModel().get_titleInline()&&!this.get_serverRenderedModel().titleInline&&(t.x=-this.get_legendViewModel().get_titleWidth(),t.y=this.get_legendViewModel().get_titleHeight()),{x:n.pageX+t.x,y:n.pageY+t.y}},documentPointToContentPoint:function(n){var t=this.get_legendTemplate().get_contentArea().offset();return{x:n.x-tab.DoubleUtil.roundToInt(t.left)+this.get_legendTemplate().get_contentArea().scrollLeft()+this.bodyOffset.x,y:n.y-tab.DoubleUtil.roundToInt(t.top)+tab.DoubleUtil.roundToInt(this.get_legendTemplate().get_contentArea().scrollTop())+this.bodyOffset.y}},onHover:function(n){var t=this.getDocumentPoint(n),i=this.documentPointToContentPoint(t);"map"!==this.get_serverRenderedModel().legendType&&this.get_legendTooltip().hoverOverCoordinates(t,i,"legenditem",this.legacyLegendViewModel.get_regionType(),this.getFieldNameVec(),null,!1)},toggleHighlight:function(){this.get_serverRenderedModel().isHighlightEnabled=!this.get_serverRenderedModel().isHighlightEnabled;this.updateHighlightStatus();var t=this.legacyLegendViewModel.get_regionType(),i=this.get_serverRenderedModel().fieldName,r=i.split("\n"),n=tab.ModelUtils.getZoneIdForSheetName(this.$h().sheetId);n!==-1&&tab.SelectionClientCommands.toggleLegendHighlight(n,this.$h().get_visualId(),t,r,null)},setBodySize:function(){this.get_legendTemplate().domContent.css("visibility","");this.allowHover();this.get_legendTemplate().domBox.removeClass("LegendBusy");this.bodySize={w:tab.DoubleUtil.roundToInt(this.get_legendTemplate().domImageBody.width()),h:tab.DoubleUtil.roundToInt(this.get_legendTemplate().domImageBody.height())};this.layout()},layout:function(){if(!!this.bodySize){this.drawTitle();this.get_domRoot().removeClass("LegendHorizontal");this.get_serverRenderedModel().isVisuallyCat?this.get_domRoot().addClass("CategoricalLegend"):this.get_domRoot().addClass("QuantitativeLegend");var n=this.$i,t={w:n.w,h:n.h};this.bodyOffset={x:0,y:0};this.get_legendViewModel().get_titleInline()?(t.w=n.w-this.get_legendViewModel().get_titleWidth(),this.bodyOffset.x=this.get_legendViewModel().get_titleWidth()):(t.h=n.h-this.get_legendViewModel().get_titleHeight(),this.bodyOffset.y=this.get_serverRenderedModel().isVisuallyCat?this.get_legendViewModel().get_titleHeight():this.get_serverRenderedModel().rectRamp.y);this.get_serverRenderedModel().isVisuallyCat||(this.get_legendTemplate().domContent.css("position","absolute"),this.get_legendTemplate().domContent.css("top",this.get_serverRenderedModel().rectRamp.y+"px"));this.layoutButtons(t)}},getFieldNameVec:function(){return ss.isValue(this.get_serverRenderedModel().fieldName)?this.get_serverRenderedModel().fieldName.toString().split("\n"):null},$f:function(){var n=this.get_serverRenderedModel(),t;n.isVisuallyCat?this.get_serverRenderedModel().legendLayout!=="vertical"?(t=n.regionHeight,!!!n.titleInline&&this.get_legendViewModel().get_hasTitle()&&ss.isValue(n.titleHeight)&&n.titleHeight!==0&&(t-=n.titleHeight+1),this.get_legendTemplate().domImageBody.css("height",t+"px"),this.get_legendTemplate().domImageBody.css("width","")):(this.get_legendTemplate().domImageBody.css("width",n.regionWidth+"px"),this.get_legendTemplate().domImageBody.css("height","")):this.get_legendTemplate().domImageBody.css("width","inherit")},layoutButtons:null,makeViewerInputHandler:null},ss.makeGenericType(c,[it]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[it]),ss.makeGenericType(tab.ILegacyLegendView$1,[it])]);ss.initClass(it,t,{add_newLegacyLegend:function(n){this.$3$1=ss.delegateCombine(this.$3$1,n)},remove_newLegacyLegend:function(n){this.$3$1=ss.delegateRemove(this.$3$1,n)},add_validStateChanged:function(n){this.$3$2=ss.delegateCombine(this.$3$2,n)},remove_validStateChanged:function(n){this.$3$2=ss.delegateRemove(this.$3$2,n)},get_presModel:function(){return this.$h.pm},get_viewId:function(){return tab.ModelUtils.findContentDashboard().getViewId(this.get_sheetName())},get_sessionId:function(){return tab.CommandController.get().get_legacySession().get_id()},get_sheetName:function(){return this.get_parentZoneVM().get_associatedSheet()},get_viewSession:function(){return tab.ModelUtils.getViewSession(this.get_sheetName())},get_viewController:function(){return ss.isNullOrUndefined(this.$i)&&(this.$i=_.find(tab.Application.get_instance().get_client().get_viewControllers(),ss.mkdel(this,function(n){return ss.referenceEquals(n.get_sheetName(),this.get_sheetName())}))),this.$i},$f:function(){return this.get_visualModel().get_cacheUrlInfo()},$g:function(){return this.get_parentZoneVM().get_valid()},get_presModelTitleHtml:function(){return this.get_presModel().titleHtml},get_presModelTitleInline:function(){return this.get_presModel().titleInline},get_regionType:function(){var n="color";switch(this.get_presModel().legendType){case"color":n="color";break;case"size":n="size";break;case"shape":n="shape";break;case"map":n="map"}return n},get_borderWidth:function(){return ss.isValue(this.get_parentZoneVM())?this.get_parentZoneVM().get_model().contentBorderWidth():0},get_presModelTitleHeight:function(){return this.get_presModel().titleHeight},get_presModelTitleWidth:function(){return this.get_presModel().isVisuallyCat?this.get_presModel().titleWidth:this.$5().w},get_shouldShowContextMenu:function(){return this.get_presModel().isContextMenuAllowed},handleZoneValidStateChanged:function(){this.$e()},dispose:function(){this.$h.remove_newLegacyLegend(ss.mkdel(this,this.handleNewLegacyLegend));this.get_visualModel().remove_urlInfoCacheChange(ss.mkdel(this,this.$c));this.$j.remove_validStateChanged(ss.mkdel(this,this.handleZoneValidStateChanged));v.prototype.dispose.call(this)},handleNewLegacyLegend:function(){this.$d()},showEditColorsDialog:function(){var n,t;this.get_presModel().isVisuallyCat?(n=new tab.GetWebCategoricalColorDialogCmd,n.c.fieldVector=this.get_presModel().legendNames,n.invoke()):(t=new tab.GetWebQuantitativeColorDialogCmd,t.c.fieldVector=this.get_presModel().legendNames,t.invoke())},$d:function(){ss.isValue(this.$3$1)&&this.$3$1()},$e:function(){ss.isValue(this.$3$2)&&this.$3$2()},$c:function(){this.notifyPropertyChanged("urlCacheInfo")}},v,[ss.IDisposable,tab.IViewModel,tab.ILegacyLegendViewModel]);ss.initClass(rt,t,{get_attributes:function(){return this.attributes},get_presModel:function(){return this.presModel},get_oCurrentMin:function(){return this.oCurrentMin},get_oCurrentMax:function(){return this.oCurrentMax},get_editingFormat:function(){return ss.isNullOrUndefined(this.$f)&&(this.$f=tableau.format.deriveNumberEditingFormat(this.oFilter.format)),this.$f},get_quickFilterViewModel:function(){return this.filterViewModel},get_visualId:function(){return this.session.get_visualId()},get_field:function(){return this.field},$c:function(){return this.oFilter.table.included},$1:function(){ss.isValue(this.domNode)&&this.$h&&this.layout(null)},postCreate:function(){var t,n;this.filterViewModel.get_filterType()!=="Quantitative";this.domLowerInput.style.display="none";this.domUpperInput.style.display="none";$(this.domLowerInput).on("blur",ss.mkdel(this,this.hideLowerInput)).on("keydown",ss.mkdel(this,this.lowerInputKeyDown)).on("keypress",ss.mkdel(this,this.checkLowerEnter));$(this.domUpperInput).on("blur",ss.mkdel(this,this.hideUpperInput)).on("keydown",ss.mkdel(this,this.upperInputKeyDown)).on("keypress",ss.mkdel(this,this.checkUpperEnter));$(document.body).on("mousedown."+this.domNode.id,ss.mkdel(this,function(n){ss.referenceEquals(n.target,this.domLowerInput)||this.domLowerInput.blur();ss.referenceEquals(n.target,this.domUpperInput)||this.domUpperInput.blur()}));this.timestamp=(new Date).getTime();this.localize();t=tableau.format.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",t);this.updateTitleBar();this.$9();n=this.oFilter.table;this.$3(n.min.v,n.max.v)},$9:function(){if(!this.metricsOnly){var n=0,t=ss.mkdel(this,function(t,i){i?($(t.domNode).removeClass(this.classQFButtonR+"1 "+this.classQFButtonR+"2 "+this.classQFButtonR+"3"),t.domNode.classList.add(this.classQFButtonHide)):(n+=1,t.domNode.classList.remove(this.classQFButtonHide),t.domNode.classList.add(this.classQFButtonR+n))});t(this.menuButton,this.shouldHideContextMenu());t(this.domainButton,this.shouldHideDomainButton());t(this.resetButton,this.shouldHideResetButton());this.domControls.classList.add(this.classQF+n+"Button");$(this.menuButton.domNode).css("background-color",this.backgroundColor);$(this.domainButton.domNode).css("background-color",this.backgroundColor);$(this.resetButton.domNode).css("background-color",this.backgroundColor)}},$3:function(n,t){this.isMaxRange(n,t)?nt.disableResetButton(this.resetButton):nt.enableResetButton(this.resetButton)},isMaxRange:function(n,t){var u=ss.isValue(n),f=ss.isValue(t),i,r;return u&&f&&this.$c()!=="include-all"?!1:(i=this.oFilter.range.min.v,r=this.oFilter.range.max.v,u||(n=i),f||(t=r),ss.isValue(i)&&ss.isValue(n)&&tab.DoubleUtil.isLessThanOrApproximatelyEqual(ss.unbox(n),ss.unbox(i))&&ss.isValue(r)&&ss.isValue(t)&&tab.DoubleUtil.isGreaterThanOrApproximatelyEqual(ss.unbox(t),ss.unbox(r)))},postMixInProperties:function(){this.inherited(arguments);this.templateRoot=dojo.moduleUrl("tableau.base.widget","templates").toString()},destroy:function(){ss.isValue(this.$i)&&this.$i.dispose();$(this.domLowerInput).off("blur").off("keydown").off("keypress");$(this.domUpperInput).off("blur").off("keydown").off("keypress");$(document.body).off("mousedown."+this.domNode.id);this.showContextMenu=null;this.requestSetAttributes=null;this.getContextMenuCommands=null;tab.ServerFontLoader.get_instance().remove_fontPreparationComplete(ss.mkdel(this,this.$1));this.inherited(arguments)},showFullDateTimes:function(){return 0},getPrecision:function(){return this.precision},hasCurrentMin:function(){return tab.LegacyFilterModel.isNormalValue(this.oCurrentMin)},hasCurrentMax:function(){return tab.LegacyFilterModel.isNormalValue(this.oCurrentMax)},getRangeMin:function(){return ss.isValue(this.rangeMinOverride)?this.rangeMinOverride:this.oRangeMin.v},getRangeMax:function(){return ss.isValue(this.rangeMaxOverride)?this.rangeMaxOverride:this.oRangeMax.v},getRange:function(){var n=this.getRangeMin(),t=this.getRangeMax();return ss.isValue(n)&&ss.isValue(t)?ss.Nullable$1.sub(t,n):null},hasDataMin:function(){var n=this.presModel.quickFilter;return tab.LegacyFilterModel.isNormalValue(this.oDataMin)&&ss.keyExists(n,"dataMin".toString())},hasDataMax:function(){var n=this.presModel.quickFilter;return tab.LegacyFilterModel.isNormalValue(this.oDataMax)&&ss.keyExists(n,"dataMax".toString())},getDataMin:function(){return this.oDataMin.v},getDataMax:function(){return this.oDataMax.v},getCurMin:function(){return this.oCurrentMin.v},getCurMax:function(){return this.oCurrentMax.v},getMinText:function(){return this.speciallyFormatDataValueForQuantitativeQF(this.oCurrentMin)},getMaxText:function(){return this.speciallyFormatDataValueForQuantitativeQF(this.oCurrentMax)},getLowerPos:function(){return this.domLowerImg.offsetLeft-this.oMetrics.absOffset+(this.$g-1)},setLowerPos:function(n){this.domLowerImg.style.left=n+this.oMetrics.absOffset-(this.$g-1)+"px"},$4:function(){return this.lastLowerOffset!==this.domLowerImg.offsetLeft},$2:function(){return this.domUpperImg.offsetLeft-this.oMetrics.absOffset},setUpperPos:function(n){this.domUpperImg.style.left=n+this.oMetrics.absOffset+"px"},$5:function(){return this.lastUpperOffset!==this.domUpperImg.offsetLeft},isRange:function(){switch(this.$c()){case"include-all":case"include-null":case"include-non-null":return!1;default:return!0}},shouldHideDomainButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-morefewerbutton"]!=="true"},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},shouldHideResetButton:function(){return this.hideEmptyTitlebar()||this.attributes["show-all"]==="false"||this.attributes["show-filter-state"]==="false"},computePrecision:function(n){var i=this.getRange(),r=ss.isValue(i)&&n!==0?ss.unbox(i)/n:1,t=Math.log(r)/Math.log(10);this.precision=t>0?Math.ceil(t):Math.floor(t);(this.precision===Number.NEGATIVE_INFINITY||isNaN(this.precision))&&(this.precision=5)},$a:function(n,t,i){var r,u=n*ss.coalesce(this.getRange(),0)/t;return this.precision>=0?Math.round(i+u):(r=Math.pow(10,-this.precision),Math.round((i+u)*r)/r)},clearDataRange:function(){ss.isValue(this.oDataMin)&&(this.oDataMin=null);ss.isValue(this.oDataMax)&&(this.oDataMax=null);this.domHighlight.style.visibility="hidden"},setMinValue:function(n){if(!ss.isNullOrUndefined(n)&&!isNaN(n)){this.hasCurrentMax()&&ss.Nullable$1.gt(n,this.getCurMax())&&(n=ss.unbox(this.getCurMax()));this.oCurrentMin.v=this.oCurrentMin.t==="i"?Math.round(n):n;this.domLowerText.textContent=this.getMinText();var t=this.getRangeMin();this.hasCurrentMin()&&(!ss.isValue(t)||ss.Nullable$1.lt(this.getCurMin(),t))&&(this.rangeMinOverride=this.getCurMin())}},setMaxValue:function(n){if(!ss.isNullOrUndefined(n)&&!isNaN(n)){this.hasCurrentMin()&&ss.Nullable$1.lt(n,this.getCurMin())&&(n=ss.unbox(this.getCurMin()));this.oCurrentMax.v=this.oCurrentMax.t==="i"?Math.round(n):n;this.domUpperText.textContent=this.getMaxText();var t=this.getRangeMax();this.hasCurrentMax()&&(!ss.isValue(t)||ss.Nullable$1.gt(this.getCurMax(),t))&&(this.rangeMaxOverride=this.getCurMax())}},removeRangeOverride:function(){this.rangeMinOverride=null;this.rangeMaxOverride=null},getValueFromInput:function(n,t){var i={t:t.t,v:ss.unbox(t.v)};return tableau.format.parseQuantitativeDataValue(n.value,t.t,this.get_editingFormat(),this.showFullDateTimes(this.get_editingFormat()),i)},speciallyFormatDataValueForQuantitativeQF:function(n){return tableau.format.formatDataValue(n,this.oFilter.role,this.oFilter.format,null,0)},initValues:function(){this.oRangeMin=$.extend({},this.oFilter.range.min);this.oRangeMax=$.extend({},this.oFilter.range.max);this.oDataMin=$.extend({},this.oFilter.data.min);this.oDataMax=$.extend({},this.oFilter.data.max);this.isRange()&&(ss.isValue(this.oFilter.table.min.v)||ss.isValue(this.oFilter.table.max.v))?(this.oCurrentMin=$.extend({},this.oFilter.table.min),this.oCurrentMax=$.extend({},this.oFilter.table.max)):(this.oCurrentMin=$.extend({},this.oFilter.range.min),this.oCurrentMax=$.extend({},this.oFilter.range.max));this.oMetrics={};this.domLowerInput.value=tableau.format.formatDataValue(this.oCurrentMin,this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat()));this.domUpperInput.value=tableau.format.formatDataValue(this.oCurrentMax,this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat()))},resize:function(n){tab.DomUtil.setMarginBox(this.domNode,n);this.layout(null)},layout:function(){var u,h,r,f,e,o,c,s,l,a;this.$h=!0;u=200;this.initValues();this.updateTitleBar();this.hasCurrentMin()?(this.domLowerText.textContent=this.getMinText(),this.domLowerText.parentNode.classList.remove(this.classQFDisabled),this.domLowerText.parentNode.classList.add("tab-ctrl-formatted-border-hover")):(this.domLowerText.textContent=this.speciallyFormatDataValueForQuantitativeQF(this.oRangeMin),this.domLowerText.parentNode.classList.add(this.classQFDisabled),this.domLowerText.parentNode.classList.remove("tab-ctrl-formatted-border-hover"));this.hasCurrentMax()?(this.domUpperText.textContent=this.getMaxText(),this.domUpperText.parentNode.classList.remove(this.classQFDisabled),this.domUpperText.parentNode.classList.add("tab-ctrl-formatted-border-hover")):(this.domUpperText.textContent=this.speciallyFormatDataValueForQuantitativeQF(this.oRangeMax),this.domUpperText.parentNode.classList.add(this.classQFDisabled),this.domUpperText.parentNode.classList.remove("tab-ctrl-formatted-border-hover"));this.domNode.classList.add(this.classQFHideButtons);this.domNode.classList.remove(this.classQFCenterText);var t=this.layoutTitleBar(),i=dojo.contentBox(this.domNode),n={w:i.w,h:i.h};this.metricsOnly||(this.titleW>0?(n.w=i.w-t.w,this.domContent.style.top="",this.domContent.style.left=t.w+"px"):this.titleH>0?(this.domNode.classList.remove(this.classQFHideButtons),n.h=i.h-t.h,this.domContent.style.top=t.h+"px",this.domContent.style.left=""):(this.domNode.classList.remove(this.classQFHideButtons),this.domContent.style.top="",this.domContent.style.left=""));dojo.marginBox(this.domContent,ss.mkdict(["w",n.w,"h",n.h]));this.attributes["show-slider"]!=="false"&&this.attributes["show-readout"]!=="false"?(this.domNode.classList.remove(this.classQFHideReadout),this.domNode.classList.remove(this.classQFHideSlider),h=dojo.contentBox(this.domLowerBound).h+dojo.contentBox(this.domLowerImg).h+8,n.h<h&&n.w>200?(this.domNode.classList.add(this.classQFCenterText),r=this.contentBox(this.domLowerText).w,f=this.contentBox(this.domUpperText).w,this.domLowerBound.style.width="",this.domUpperBound.style.width="",this.domLowerBound.style.top="0",this.domUpperBound.style.top="0",e=n.w-(r+dojo.contentBox(this.domLowerImg).w)-(f+dojo.contentBox(this.domUpperImg).w)-16,e<=0?this.domNode.classList.add(this.classQFHideSlider):(dojo.marginBox(this.domBar,ss.mkdict(["w",e])),this.domBar.style.top="7px",this.domBar.style.left=r+tab.DomUtil.getContentBox(this.domLowerImg).w+8+"px",this.domLowerInput.style.width=r+"px",this.domUpperInput.style.width=f+"px")):(o=Math.min(u,Math.floor(n.w/2-4)),dojo.marginBox(this.domLowerBound,ss.mkdict(["w",o])),dojo.marginBox(this.domUpperBound,ss.mkdict(["w",o])),this.domLowerInput.style.width=dojo.contentBox(this.domLowerBound).w+"px",this.domUpperInput.style.width=dojo.contentBox(this.domUpperBound).w+"px",c=this.domLowerBound.offsetTop+this.domLowerBound.offsetHeight+8,dojo.marginBox(this.domBar,ss.mkdict(["w",n.w-24])),this.domBar.style.top=c+"px",this.domBar.style.left="12px")):this.attributes["show-slider"]!=="false"?(this.domNode.classList.add(this.classQFHideReadout),this.domNode.classList.remove(this.classQFHideSlider),dojo.marginBox(this.domBar,ss.mkdict(["w",n.w-24])),this.domBar.style.left="12px"):this.attributes["show-readout"]!=="false"?(this.domNode.classList.remove(this.classQFHideReadout),this.domNode.classList.add(this.classQFHideSlider),s=Math.min(u,Math.floor(n.w/2-4)),dojo.marginBox(this.domLowerBound,ss.mkdict(["w",s])),dojo.marginBox(this.domUpperBound,ss.mkdict(["w",s])),this.domLowerInput.style.width=tab.DomUtil.getContentBox(this.domLowerBound).w+"px",this.domUpperInput.style.width=tab.DomUtil.getContentBox(this.domUpperBound).w+"px"):(this.domNode.classList.add(this.classQFHideSlider),this.domNode.classList.add(this.classQFHideReadout));this.oMetrics.top=this.domBar.offsetTop-2;this.oMetrics.absOffset=this.domBar.offsetLeft;this.oMetrics.left=0;this.oMetrics.right=this.domBar.offsetWidth;this.hasCurrentMin()?(this.domLowerImg.style.top=this.oMetrics.top-4+"px",this.domLowerImg.style.visibility="visible"):this.domLowerImg.style.visibility="hidden";this.hasCurrentMax()?(this.domUpperImg.style.top=this.oMetrics.top-4+"px",this.domUpperImg.style.visibility="visible"):this.domUpperImg.style.visibility="hidden";l=this.shouldShowDomContent()?"visible":"hidden";this.domContent.style.visibility=l;this.oMetrics.width=this.oMetrics.right-this.oMetrics.left;this.computePrecision(this.oMetrics.width);a=this.hasDataMin()||this.hasDataMax();this.domHighlight.style.visibility=a?"visible":"hidden";this.updateMinAndMax(this.oCurrentMin.v,this.oCurrentMax.v);this.updateDomainButton()},shouldShowDomContent:function(){return this.hasCurrentMax()||this.hasCurrentMin()},updateFromIcons:function(){var n,i,t,r,u;this.hasCurrentMin()&&this.$4()&&(r=this.getLowerPos(),n=r-this.oMetrics.left,t=n===0?this.getRangeMin():n===this.oMetrics.width?this.getRangeMax():this.hasCurrentMax()&&this.getLowerPos()===this.$2()?this.getCurMax():this.$a(n,this.oMetrics.width,ss.unbox(this.getRangeMin())||0),ss.isValue(t)&&this.setMinValue(ss.unbox(t)),this.lastLowerOffset=this.domLowerImg.offsetLeft,this.domRange.style.left=r+"px");i=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left;this.hasCurrentMax()?(u=this.$2()-i,this.$5()&&(n=this.oMetrics.right-this.$2(),t=n===0?this.getRangeMax():n===this.oMetrics.width?this.getRangeMin():this.hasCurrentMin()&&this.getLowerPos()===this.$2()?this.getCurMin():this.$a(-n,this.oMetrics.width,ss.unbox(this.getRangeMax())||0),ss.isValue(t)&&this.setMaxValue(ss.unbox(t)),this.lastUpperOffset=this.domUpperImg.offsetLeft),this.domRange.style.width=u+"px"):this.domRange.style.width=this.oMetrics.right-i+"px";this.updateDataBar()},doMenu:function(){this.showContextMenu(this.menuButton.domNode)},updateFromOneInput:function(n){var t,i;ss.referenceEquals(n,this.domLowerInput)?(t=this.hasCurrentMin()?this.getValueFromInput(this.domLowerInput,this.oCurrentMin):Number.MIN_VALUE,i=this.oCurrentMax.v):(t=this.oCurrentMin.v,i=this.hasCurrentMax()?this.getValueFromInput(this.domUpperInput,this.oCurrentMax):Number.MAX_VALUE);this.updateMinAndMax(t,i)},updateMinAndMax:function(n,t){var r,e,i,u,o,f;ss.isValue(n)&&ss.isValue(t)&&ss.unbox(n)>ss.unbox(t)&&(e=n,n=t,t=e);this.removeRangeOverride();this.hasCurrentMin()&&ss.isValue(n)&&!isNaN(ss.unbox(n))&&this.setMinValue(ss.unbox(n));this.hasCurrentMax()&&ss.isValue(t)&&!isNaN(ss.unbox(t))&&this.setMaxValue(ss.unbox(t));i=this.getRange();r=this.oMetrics.left;this.hasCurrentMin()?(u=ss.isValue(i)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(i))?Math.round((ss.coalesce(this.getCurMin(),0)-ss.coalesce(this.getRangeMin(),0))*this.oMetrics.width/ss.unbox(i)):0,this.oMetrics.left+u>this.oMetrics.width&&(u=this.oMetrics.left+this.oMetrics.width),this.setLowerPos(this.oMetrics.left+u),this.lastLowerOffset=this.domLowerImg.offsetLeft,this.domRange.style.left=this.oMetrics.left+u+"px",r=this.getLowerPos()):this.domRange.style.left=r+"px";this.hasCurrentMax()?(o=this.hasCurrentMin()?this.getCurMin():this.getRangeMin(),f=ss.isValue(i)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(i))?Math.round((ss.coalesce(this.getCurMax(),0)-ss.unbox(o))*this.oMetrics.width/ss.unbox(i)):this.oMetrics.width,this.setUpperPos(r+f),this.lastUpperOffset=this.domUpperImg.offsetLeft,this.domRange.style.width=Math.max(f,0)+"px"):this.domRange.style.width=Math.max(this.oMetrics.right-r,0)+"px";this.updateDataBar()},updateDataBar:function(){var i=0,t,r,n=this.getRange(),u,f;ss.isValue(n)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(n))&&this.hasDataMin()&&(u=ss.coalesce(this.hasCurrentMin()?this.getCurMin():this.getRangeMin(),0),i=Math.round((ss.coalesce(this.getDataMin(),0)-u)*this.oMetrics.width/ss.unbox(n)));this.domHighlight.style.left=i+"px";r=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left;t=(this.hasCurrentMax()?this.$2():this.oMetrics.right)-r;ss.isValue(n)&&this.hasDataMax()&&(f=this.hasDataMin()?this.getDataMin():this.getRangeMin(),tab.DoubleUtil.isApproximatelyZero(ss.unbox(n))||(t=Math.round((ss.coalesce(this.getDataMax(),0)-ss.unbox(f))*this.oMetrics.width/ss.unbox(n))),t=Math.max(t,2));this.domHighlight.style.width=Math.max(t,0)+"px"},startUpperCapture:function(n){this.startCapture(n,!1,this.domUpperImg)},startLowerCapture:function(n){this.startCapture(n,!1,this.domLowerImg)},startRangeCapture:function(n){this.hasCurrentMin()&&this.hasCurrentMax()&&this.startCapture(n,!0,this.domRange)},startCapture:function(n,t,i){var u,r;(this.savePreviousMinAndMaxVals(),u=t?ss.mkdel(this,this.$8):ss.mkdel(this,this.onMouseMove),spiff.EventUtil.stopEvent(n),r=this.getRange(),ss.isValue(r)&&!tab.DoubleUtil.isApproximatelyZero(ss.unbox(r)))&&(this.captureInfo={x:n.pageX,y:n.pageY,xStart:i.offsetLeft,isRangeCapture:t,oImg:i},t&&(this.captureInfo.lowerStart=this.getLowerPos(),this.captureInfo.upperStart=this.$2()),ss.isValue(this.$i)&&this.$i.dispose(),this.$i=new tab.DisposableHolder,this.$i.add$1(spiff.EventUtil.bindWithDispose($(document),"mousemove",u)),this.$i.add$1(spiff.EventUtil.bindWithDispose($(document),"mouseup",ss.mkdel(this,this.$b))),this.$i.add$1(spiff.EventUtil.bindWithDispose($(document),"mouseleave",ss.mkdel(this,this.$b))))},onMouseMove:function(n){var r=this.hasCurrentMin()?this.getLowerPos():this.oMetrics.left,u=this.hasCurrentMax()?this.$2():this.oMetrics.right,f=ss.referenceEquals(this.captureInfo.oImg,this.domLowerImg)?this.oMetrics.left-this.$g:r,e=ss.referenceEquals(this.captureInfo.oImg,this.domUpperImg)?this.oMetrics.right:u-this.$g,t=n.pageX-this.captureInfo.x+this.captureInfo.xStart-this.oMetrics.absOffset,i;spiff.EventUtil.stopEvent(n);t=Math.min(e,Math.max(f,t));i=!1;ss.referenceEquals(this.captureInfo.oImg,this.domLowerImg)?(i=t+this.$g!==r,this.setLowerPos(t+this.$g)):(i=t!==u,this.setUpperPos(t));this.updateFromIcons();i&&this.applyQuantFilter(this.getCurMin(),this.getCurMax())},applyQuantFilter:function(n,t){if(tab.ApplicationModel.get_instance().get_isLocalRenderMode()){var i=new tab.QuantitativeFilterData(this.oFilter.targetSheets,this.get_field(),n,t,this.previousMinVal,this.previousMaxVal);tab.FilterClientCommands.updateQuantitativeFilter(i)}},savePreviousMinAndMaxVals:function(){this.previousMinVal=this.getCurMin();this.previousMaxVal=this.getCurMax()},$8:function(n){var i=this.captureInfo.x-(this.captureInfo.lowerStart-this.oMetrics.left),r=this.captureInfo.x+(this.oMetrics.right-this.captureInfo.upperStart),t=n.pageX;t=Math.min(r,Math.max(i,t));spiff.EventUtil.stopEvent(n);this.setLowerPos(this.captureInfo.lowerStart+(t-this.captureInfo.x));this.setUpperPos(this.captureInfo.upperStart+(t-this.captureInfo.x));tab.ModelUtils.invalidateVisuals(this.oFilter.targetSheets);this.updateFromIcons()},$b:function(n){ss.isValue(this.$i)&&this.$i.dispose();this.$i=null;spiff.EventUtil.stopEvent(n);this.captureInfo.x!==n.pageX&&(this.removeRangeOverride(),this.updateFromIcons(),this.notifyChange())},showLowerInput:function(n){this.hasCurrentMin()&&(this.showInput(n,this.oCurrentMin,this.domLowerInput),this.domLowerBound.classList.add("active"),this.savePreviousMinAndMaxVals())},showUpperInput:function(n){this.hasCurrentMax()&&(this.showInput(n,this.oCurrentMax,this.domUpperInput),this.domUpperBound.classList.add("active"),this.savePreviousMinAndMaxVals())},showInput:function(n,t,i){(spiff.EventUtil.stopEvent(n),$(i).css("display")==="none")&&(i.value=tableau.format.formatDataValue(t,this.oFilter.role,this.get_editingFormat(),null,this.showFullDateTimes(this.get_editingFormat())),this.showInputStartValue=this.getValueFromInput(i,t),$(i).show().siblings(".readoutText").hide(),i.focus(),i.select())},lowerInputKeyDown:function(n){this.$7(n,this.domLowerInput)},upperInputKeyDown:function(n){this.$7(n,this.domUpperInput)},$7:function(n,t){n.which===27&&($(t).val(""),t.blur())},checkLowerEnter:function(n){rt.$0(n,this.domLowerInput)},checkUpperEnter:function(n){rt.$0(n,this.domUpperInput)},hideLowerInput:function(n){this.$6(n,this.oCurrentMin,this.domLowerInput,this.domLowerBound)},hideUpperInput:function(n){this.$6(n,this.oCurrentMax,this.domUpperInput,this.domUpperBound)},$6:function(n,t,i,r){var u=this.getValueFromInput(i,t);spiff.EventUtil.stopEvent(n);this.applyInputValue(t,i,r,u,ss.mkdel(this,function(){this.updateFromOneInput(i)}))},applyInputValue:function(n,t,i,r,u){var f={},e,o;f=$.extend({},n);e=null;ss.isNullOrUndefined(r)||isNaN(ss.unbox(r))?r=this.showInputStartValue:(f.v=ss.unbox(r),e=this.speciallyFormatDataValueForQuantitativeQF(f));o=$(t).hide().siblings(".readoutText").show();ss.isValue(r)&&ss.isValue(this.showInputStartValue)&&!tab.DoubleUtil.isApproximatelyEqual(ss.unbox(this.showInputStartValue),ss.unbox(r))&&(o.text(e),u(),this.notifyChange());this.showInputStartValue=null;i.classList.remove("active")},applyChanges:function(){var t=!1,n=$.extend(!1,{},this.oFilter.table);if(!this.hasCurrentMin()||ss.isValue(n.min.v)&&tab.DoubleUtil.isApproximatelyEqual(ss.unbox(n.min.v),ss.unbox(this.getCurMin()))||(t=!0,n.min=$.extend({},this.oCurrentMin)),!this.hasCurrentMax()||ss.isValue(n.max.v)&&tab.DoubleUtil.isApproximatelyEqual(ss.unbox(n.max.v),ss.unbox(this.getCurMax()))||(t=!0,n.max=$.extend({},this.oCurrentMax)),!t){tab.FilterClientCommands.resetQuantitativeFilter(this.get_field(),this.oFilter.targetSheets);return}this.clearDataRange();++this.rid;this.isRange()||(n.included=this.$c()==="include-non-null"?"include-range":"include-range-or-null");tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),n.min.v,n.max.v,n.included);this.$3(n.min.v,n.max.v)},updateDomainButton:function(){var n,t;if(!ss.isValue(this.oFilter.domains)||this.oFilter.domains.length<=1){this.domainButton.domNode.style.display="none";return}n=this.domainButton.iconNode.classList;n.remove("wcIconDomainAll");n.remove("wcIconDomainContext");n.remove("wcIconDomainRelevant");t=this.attributes.values;switch(t){case"relevant":this.domainButton.attr("label",tab.Strings.QuickFilterShowLargerRange);n.add("wcIconDomainRelevant");break;case"context":this.domainButton.attr("label",tab.Strings.QuickFilterShowSmallerRange);n.add("wcIconDomainContext");break;case"all":default:this.domainButton.attr("label",tab.Strings.QuickFilterShowSmallerRange);n.add("wcIconDomainAll")}},toggleReset:function(){var r=this.oFilter.table,n=ss.isValue(r.min.v),u=ss.isValue(r.max.v),t,i;!n&&u||!u&&n?(t=null,i=null,n?t=this.getRangeMin():i=this.getRangeMax(),tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),t,i,this.$c())):tab.FilterClientCommands.setQuantitativeFilterRange(this.get_visualId(),this.get_field(),this.oRangeMin.v,this.oRangeMax.v,"include-all");nt.disableResetButton(this.resetButton)},toggleDomain:function(){var t=function(n){return n==="context"},n,i=this.attributes.values;switch(i){case"relevant":n="all";break;case"context":n="relevant";break;case"all":default:n=_.any(this.oFilter.domains,t)?"context":"relevant"}this.doRequestSetAttributes(ss.mkdict(["values",n.toString()]),!1)},doRequestSetAttributes:function(n,t){var i=ss.getEnumerator(Object.keys(n)),r;try{while(i.moveNext())r=i.current(),this.attributes[r]=n[r]}finally{i.dispose()}tab.BaseSession.autoUpdate||this.initFromState();this.requestSetAttributes(n,t)},notifyChange:function(){this.$e=tab.MiscUtil.clearTimeout(this.$e);this.$e=window.setTimeout(ss.mkdel(this,this.applyChanges),this.$d)},initFromState:function(){this.$9();this.layout(null)},localize:function(){},contentBox:function(n){var t=$(n).css("display"),i;return t==="none"&&(n.style.display=""),i=dojo.contentBox(n),n.style.display=t,i}},k);ss.initClass(ei,t,{get_editingFormat:function(){return this.oFilter.editing_format},postCreate:function(){var i;this.inherited(arguments);var f=this.oFilter.date_format,n=f.locale_formatting_strings,o=this.get_editingFormat(),s=n.narrowDay.filter(function(n){return!ss.isNullOrEmptyString(n)}),t=this.oFilter.first_day_of_week;ss.isValue(t)&&(t=t-1);var r=new Date,e=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),u={};u.format=tableau.format.mapIcuToOleFormat(f.yearMonthFormat);u.locale_formatting_strings=n;i={};i.format=o.format;i.locale_formatting_strings=n;this.$q=new tab.DatePicker(new tab.DatePickerSettings(e,e,null,null,t,s,n.todayFormatTemplate,function(n){return tableau.format.formatCustomJsDateTime(n,u,0,"d")},function(n){return tableau.format.formatCustomJsDateTime(n,i,0,"d")}));this.$q.element.on("dateSelected",ss.mkdel(this,this.$k)).on("mousedown",ss.mkdel(this,this.$j)).appendTo(document.body);this.$p=!1},destroy:function(){this.$q.dispose();this.$q=null;this.inherited(arguments)},showFullDateTimes:function(n,t){return this.$s=tab.QuickFilterDateFormatUtil.getDateTimeFormatMode([this.oCurrentMin,this.oCurrentMax,this.oRangeMin,this.oRangeMax,t],this.get_presModel().aggregation,n,this.$s),this.$s},speciallyFormatDataValueForQuantitativeQF:function(n){return tableau.format.formatDataValue(n,this.oFilter.role,this.oFilter.date_format,null,this.showFullDateTimes(this.oFilter.date_format,n))},$m:function(){return tab.QuickFilterDateFormatUtil.isPureTime([this.oCurrentMin,this.oCurrentMax,this.oRangeMin,this.oRangeMax],this.get_presModel().aggregation)},showInput:function(n,t,i){if(this.inherited(arguments),this.get_presModel().aggregation!=="trunc-month"&&this.get_presModel().aggregation!=="trunc-year"&&!this.$m()&&(!ss.referenceEquals(this.$r,i)||this.$q.element.is(":hidden"))){var r=tab.LegacyFilterModel.isNormalValue(t)&&!isNaN(ss.unbox(t.v))?new Date(tableau.types.JsDateFromOleDate(ss.unbox(t.v))):null;this.$q.show(r);this.$r=i;this.$n()}},layout:function(){this.inherited(arguments);this.$n()},$n:function(){if(!ss.isNullOrUndefined(this.$r)){var n=$(ss.referenceEquals(this.$r,this.domLowerInput)?this.domLowerBound:this.domUpperBound);this.$q.positionCalendarByElement(n)}},$k:function(n,t){this.$q.hide();var i=ss.referenceEquals(this.$r,this.domLowerInput),r=i?this.oCurrentMin:this.oCurrentMax,f=i?this.domLowerBound:this.domUpperBound,e=ei.mergeDateWithTime(t,new Date(tableau.types.JsDateFromOleDate(ss.unbox(r.v)))),u=tableau.types.OleDateFromJsDate(e.getTime());this.applyInputValue(r,this.$r,f,u,ss.mkdel(this,function(){this.$o(i,u)}))},$o:function(n,t){n?this.updateMinAndMax(t,this.oCurrentMax.v):this.updateMinAndMax(this.oCurrentMin.v,t)},$j:function(){this.$p=!0},hideLowerInput:function(n){this.$l(n,this.domLowerInput,ss.mkdel(this,function(n){rt.prototype.hideLowerInput.call(this,n)}))},hideUpperInput:function(n){this.$l(n,this.domUpperInput,ss.mkdel(this,function(n){rt.prototype.hideUpperInput.call(this,n)}))},$l:function(n,t,i){this.$p?(spiff.EventUtil.stopEvent(n),this.$p=!1,window.setTimeout(function(){$(t).is(":visible")&&t.focus()},0)):(i(n),this.$q.hide(),ss.referenceEquals(this.$r,t)&&(this.$r=null))}},rt);ss.initClass(gr,t,{get_filterType:function(){return this.$2.get_filterType()},get_legacyQuantitativeQuickFilterModel:function(){return this.$2},get_range:function(){return this.$2.get_range()},get_data:function(){return this.$2.get_data()},get_dateFormat:function(){return this.$2.get_dateFormat()},get_editingFormat:function(){return this.$2.get_editingFormat()},get_format:function(){return this.$2.get_format()},get_calendarControlStartOfWeek:function(){return this.$2.get_calendarControlStartOfWeek()},get_dataSourceStartOfWeek:function(){return this.$2.get_dataSourceStartOfWeek()},get_quantitativeFilterTable:function(){return this.$2.get_quantitativeFilterTable()},get_column:function(){return this.get_quantitativeFilterTable().column},get_included:function(){return this.get_quantitativeFilterTable().included},get_min:function(){return this.get_quantitativeFilterTable().min},get_max:function(){return this.get_quantitativeFilterTable().max}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IFilterTypeViewModel]);ss.initClass(cf,t,{get_zoneModel:function(){return this.$h().get_zoneModel()},get_domRoot:function(){return this.get_template().domRoot},$g:function(){return this.$h().get_frame()},$h:function(){return this.get_viewModel()},dispose:function(){ss.isValue(this.$i)&&(this.$i.destroyRecursiveShim(!1),this.$i=null);ss.makeGenericType(spiff.BaseView$1,[st]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.$h().get_quickFilterDisplayModel())&&this.$b()},$b:function(){(ss.isNullOrUndefined(this.$i)||this.$h().get_needToUpdateDisplay())&&(ss.isNullOrUndefined(this.$i)?(this.$i=this.$9(),this.get_template().domRoot.append(this.$i.getDomNode()),this.$i.startupShim()):this.$e(),this.$f(),this.$a())},$a:function(){ss.isValue(this.$i)&&(this.$h().get_needToUpdateContent()||this.$h().get_needToUpdateDisplay())&&(this.$i.updateAttributesShim(this.$g().attributes),this.$i.updateFilterStateShim(this.$h().get_filterPresModel()))},$f:function(){tab.DomUtil.resize(this.$i,this.get_zoneModel().get_zoneContentBounds());this.$i.setTitleSizeShim(this.$h().get_zoneTitleHeight(),this.$h().get_zoneTitleWidth())},$9:function(){var n=this.$c();return this.makeFilterPanel(n)},$e:function(){var n=this.$c();this.$i.updateFilterPropertiesShim(n);this.$i.updateSubWidgetShim(this.$h().get_filterPresModel())},$c:function(){var t=this.$h().get_layoutSession(),r=this.$h().get_zoneModel().get_worksheetName(),n={},i;return n.sessionid=t.get_id(),n.urlRoot=t.get_urlRoot(),n.layoutSession=t,n.sheetid=r,n.zid=this.$g().key.zid,n.titleHTML=this.get_zoneModel().get_zoneCommonModel().get_hasTitle()?this.$h().get_quickFilterDisplayModel().get_quickFilterTitle().html:"",n.session=this.$h().get_viewSession(),n.field=this.$g().param,n.quickFilterDisplayViewModel=this.$h(),ss.isValue(this.$g().format)&&(n.format=this.$g().format),ss.isValue(this.$g().attributes)&&(n.attributes=this.$g().attributes),ss.isValue(this.$g().w)&&(n.width=this.$g().w),i=ss.mkdel(this,function(n,t){this.$d(this.$g().param,this.$h().get_visualId(),n,t)}),n.requestSetAttributes=i,n.textStyle=this.$h().get_quickFilterDisplayPresModel().textStyle,ss.isValue(this.get_zoneModel().pm.zoneCommon.styledBox)&&(n.backgroundColor=this.get_zoneModel().get_zoneCommonModel().get_zoneStyle().get_fillColor()),n},makeFilterPanel:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeFilterPanelWidget(n)},$d:function(n,t,i){ss.keyExists(i,"mode")?tab.FilterClientCommands.setCategoricalQuickFilterMode(t,n,i.mode):ss.keyExists(i,"values")&&tab.FilterClientCommands.setCategoricalQuickFilterDomain(t,n,i.values)}},ss.makeGenericType(spiff.BaseView$1,[st]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[st]),ss.makeGenericType(tab.ILegacyQuickFilterDisplayView$1,[st])]);ss.initClass(st,t,{add_updateQuickFilterDisplay:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_updateQuickFilterDisplay:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_updateQuickFilterContent:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_updateQuickFilterContent:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_resized:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_resized:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_quickFilterDisplayModel:function(){return this.$a},get_frame:function(){return this.$a.get_frame()},get_zoneModel:function(){return this.$a.get_zoneModel()},get_quickFilterDisplayPresModel:function(){return this.$a.get_quickFilterDisplayPresModel()},get_viewSession:function(){return tab.ModelUtils.getViewSession(this.get_zoneModel().get_worksheetName())},get_layoutSession:function(){return tab.CommandController.get().get_legacySession()},get_zoneTitleHeight:function(){if(!this.get_zoneModel().get_zoneCommonModel().get_hasTitle()||this.get_zoneModel().get_titleHeight()===0)return 0;var n=this.get_quickFilterDisplayPresModel().quickFilterTitle.h;return n>0&&(this.get_hasBorder()&&(n+=3),n=Math.max(n,17)),n},get_zoneTitleWidth:function(){return!this.get_zoneModel().get_zoneCommonModel().get_hasTitle()||this.get_zoneModel().get_titleWidth()===0?0:this.get_quickFilterDisplayPresModel().quickFilterTitle.w},get_hasBorder:function(){return this.$a.get_zoneModel().get_hasBorder()},get_filterPresModel:function(){return this.$6.get_filterPresModel()},get_filterTypeViewModel:function(){return this.$7},get_needToUpdateContent:function(){return this.$8},set_needToUpdateContent:function(n){this.$8=n},get_needToUpdateDisplay:function(){return this.$9},set_needToUpdateDisplay:function(n){this.$9=n},get_visualId:function(){return tab.ModelUtils.getVisualId(this.get_zoneModel().get_worksheetName())},handleUpdateQuickFilterDisplay:function(){this.set_needToUpdateDisplay(!0);_.defer(ss.mkdel(this,function(){this.raiseActionEvent(this.$2$1);this.set_needToUpdateDisplay(!1)}))},$4:function(){this.raiseActionEvent(this.$2$3)},$5:function(){this.set_needToUpdateContent(!0);_.defer(ss.mkdel(this,function(){this.raiseActionEvent(this.$2$2);this.set_needToUpdateContent(!1)}))},$3:function(){this.$2();switch(this.$6.get_filterType()){case"Categorical":this.$7=new kr(this.$6);break;case"Hierarchical":this.$7=new dr(this.$6);break;case"Quantitative":this.$7=new gr(this.$6);break;case"RelativeDate":case"RelativeDatePick":this.$7=new lu(this.$6)}},$2:function(){ss.isValue(this.$7)&&(this.$7.dispose(),this.$7=null)},dispose:function(){this.$a.remove_quickFilterDisplayUpdated(ss.mkdel(this,this.handleUpdateQuickFilterDisplay));this.$a.get_zoneModel().get_zoneCommonModel().remove_resizeZone(ss.mkdel(this,this.$4));this.$a=null;this.$6.remove_filterUpdated(ss.mkdel(this,this.$5));this.$6=null;this.$2();spiff.BaseViewModel.prototype.dispose.call(this)}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.ILegacyQuickFilterDisplayViewModel]);ss.initClass(i,t,{get_filterViewModel:function(){return this.filterViewModel},postCreate:function(){this.filterViewModel.get_filterType()!=="RelativeDate";this.$3();this.getSID=ss.mkdel(this,function(){return this.stateId});ss.isValue(this.oFilter.fy)&&(this.fy=this.oFilter.fy-1);ss.isValue(this.oFilter.start_of_week)&&(this.startOfWeek=this.oFilter.start_of_week);this.timestamp=(new Date).getTime();this.$a=[this.buttonYear,this.buttonQuarter,this.buttonMonth,this.buttonWeek,this.buttonDay];this.oFilter.noTime?(this.buttonHour.domNode.style.display="none",this.buttonMinute.domNode.style.display="none"):(this.$a.push(this.buttonHour),this.$a.push(this.buttonMinute));this.connect(this.domTooltipDialog,"onOpen",ss.mkdel(this,this.$4));this.initFromState();$(this.menuButton.domNode).css("background-color",this.backgroundColor)},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},shouldHideDomainButton:function(){return!0},dispose:function(){this.$8.dispose();this.showContextMenu=null},destroy:function(){this.dispose();ss.isValue(this.domText)&&(this.domText.innerHTML="");this.inherited(arguments)},layout:function(){var t,e,u,o,i,s;if(this.updateTitleBar(),this.domNode.classList.remove("RDFHorizontal"),t=dojo.marginBox(this.domDialog),ss.isValue(t)&&ss.isValue(t.w)&&t.w!==0){var h=this.layoutTitleBar(),f=dojo.contentBox(this.domNode),n=f.w-2,r=$(this.domDropdownButton.domNode);for(r.find(".dijitButtonNode").addClass("tab-ctrl-formatted-widget tab-ctrl-formatted-darker-border-hover"),r.find(".dijitButtonText").addClass("tab-ctrl-formatted-fixedsize"),r.find(".dijitArrowButtonInner")[0].innerHTML=kt.getDropDownForColor(this.textStyle.color.toString()),!this.hideEmptyTitlebar()&&this.titleW>0?(this.domNode.classList.add("RDFHorizontal"),this.domTitleBar.style.cssFloat="left",this.domDropdownButton.domNode.style.cssFloat="left",e=dojo._getPadBorderExtents(this.domDropdownButton.domNode),n=f.w-h.w-e.w):(this.domTitleBar.style.cssFloat="none",this.domDropdownButton.domNode.style.cssFloat="none"),n>29&&(this.domDropdownButton.domNode.style.width=n+"px",this.domDropdownButton.domNode.firstChild.style.width=n-2+"px",n=n-25,u=this.domDropdownButton.domNode.firstChild.firstChild.firstChild.childNodes[1],ss.isValue(u)&&(u.style.width=n+"px")),o=Math.floor((t.w-10)/this.$a.length),i=0;i<this.$a.length;i++)s=this.$a[i],s.titleNode.style.width=o-5+"px"}},initFromState:function(){var n=ss.mkdel(this,function(n,t){t?(n.domNode.classList.remove(this.$7),n.domNode.classList.add(this.$6)):(n.domNode.classList.remove(this.$6),n.domNode.classList.add(this.$7))});n(this.menuButton,this.shouldHideContextMenu());this.domDropdownButton.attr("label",this.oFilter.text);this.updateCurrentStateOfData();this.setRangeType(this.rangeType,this.rangeN);this.setTitle();this.updateTitleBar()},updateCurrentStateOfData:function(){var t=this.oFilter.table,n;this.periodType=t.periodType;this.rangeType=t.rangeType;this.rangeN=t.rangeN;typeof t.anchor=="undefined"||(n=t.anchor,this.anchorDateTime=new Date(n.year,n.month-1,n.day,n.hour,n.minute,n.second))},setTitle:function(){var n=tableau.format.formatColumnDisplayName(this.oFilter,!1,!0);this.domTitleBar.setAttribute("title",n)},applyChanges:function(){var n={},t;n.periodType=this.periodType;n.rangeType=this.rangeType;n.rangeN=this.rangeN;this.stateId+=1;t=tableau.util.findDirectParentByClassName(this.domDialog,"dijitPopup",document.body);ss.isNullOrUndefined(t)||(t.style.zIndex="980");tab.FilterClientCommands.doRelativeDateQuickFilter(this.session.get_visualId(),this.field,this.periodType,this.rangeType,this.rangeN)},doMenu:function(){this.showContextMenu(this.menuButton.domNode)},$4:function(){this.setPeriodUI(this.periodType);this.setRangeUI(this.rangeType,this.rangeN);this.setPreviewUI();this.updateVisibilityOfDayToAnchor()},setRangeUI:function(n,t){this.inputLastn.disabled=!0;this.inputNextn.disabled=!0;this.lastSpinner.style.display="none";this.radioLastn.classList.remove("spinnerBugFix");this.nextSpinner.style.display="none";this.radioNextn.classList.remove("spinnerBugFix");switch(n){case"last":this.radioLast.checked=!0;break;case"curr":this.radioCurr.checked=!0;break;case"next":this.radioNext.checked=!0;break;case"lastn":this.radioLastn.checked=!0;this.rangeN=t;this.inputLastn.value=this.rangeN.toString();this.inputLastn.disabled=!1;this.lastSpinner.style.display="";this.radioLastn.classList.add("spinnerBugFix");break;case"nextn":this.radioNextn.checked=!0;this.rangeN=t;this.inputNextn.value=this.rangeN.toString();this.inputNextn.disabled=!1;this.nextSpinner.style.display="";this.radioNextn.classList.add("spinnerBugFix");break;case"todate":this.radioTodate.checked=!0}},updateRangeButtons:function(n){for(var i=this.$a.length,t=0;t<i;t++)this.$a[t].attr("checked",ss.referenceEquals(this.$a[t].name,n.toString()))},overLastUp:function(){this.lastUp.classList.add("hover")},outLastUp:function(){this.lastUp.classList.remove("hover")},overLastDown:function(){this.lastDown.classList.add("hover")},outLastDown:function(){this.lastDown.classList.remove("hover")},overNextUp:function(){this.nextUp.classList.add("hover")},outNextUp:function(){this.nextUp.classList.remove("hover")},overNextDown:function(){this.nextDown.classList.add("hover")},outNextDown:function(){this.nextDown.classList.remove("hover")},$5:function(n,t){var i=parseInt(n.value,10)+(t?1:-1);if(!(i<1)){n.value=i.toString();this.onTyping(n)}},upLast:function(){this.$5(this.inputLastn,!0)},downLast:function(){this.$5(this.inputLastn,!1)},upNext:function(){this.$5(this.inputNextn,!0)},downNext:function(){this.$5(this.inputNextn,!1)},$3:function(){s.localizeDojoLabeledControls([{item1:this.buttonYear,item2:"RelDateFilterYears"},{item1:this.buttonQuarter,item2:"RelDateFilterQuarters"},{item1:this.buttonMonth,item2:"RelDateFilterMonths"},{item1:this.buttonWeek,item2:"RelDateFilterWeeks"},{item1:this.buttonDay,item2:"RelDateFilterDays"},{item1:this.buttonHour,item2:"RelDateFilterHours"},{item1:this.buttonMinute,item2:"RelDateFilterMinutes"}])}},ii,[ss.IDisposable]);ss.initClass(dt,t,{get_isCurrentLegendGreyed:function(){var n=ss.isValue(this.selectedItems)&&this.selectedItems.length>0,t=ss.isValue(this.brushedItems)&&this.brushedItems.length>0;return r.legendShouldBeGrayed(this.isOneway,this.hasMarkNodeSelection,n,t)},computeChangedItems:function(n){if(ss.isNullOrUndefined(n)||this.isHighlightingEnabled!==n.isHighlightingEnabled||this.get_isCurrentLegendGreyed()!==n.get_isCurrentLegendGreyed())return null;var t=dt.$0(this.selectedItems,n.selectedItems),i=dt.$0(this.brushedItems,n.brushedItems);return t.concat.apply(t,i)},isSelectionStateTheSame:function(n){if(ss.isNullOrUndefined(n)||this.isHighlightingEnabled!==n.isHighlightingEnabled||this.get_isCurrentLegendGreyed()!==n.get_isCurrentLegendGreyed())return!1;var t=_.isEqual(n.selectedItems,this.selectedItems),i=_.isEqual(n.brushedItems,this.brushedItems);return t&&i}});ss.initClass(nu,t,{get_totalHeight:function(){return this.$5},get_itemHeight:function(){return this.$2},get_tileCount:function(){return this.$3},get_viewportHeight:function(){return this.$6},destroy:function(){},updateViewport:function(n,t){this.$6=t},getTileStatus:function(n){var t=this.$0[n];return typeof t=="undefined"?!1:t.$0()},updateTileStatus:function(n,t){var i=this.$0[n];typeof i!="undefined"&&this.$0[n].$1(t)},getTilePosition:function(n){var t=this.$0[n];return typeof t=="undefined"?null:{x:t.$2().x,y:t.$2().y}},getTileRange:function(n){var t=this.$0[n];return typeof t=="undefined"?null:new tab.IntegerRange(t.$3().get_from(),t.$3().get_to())},getTileRangeType:function(n){var t=this.$0[n];return typeof t=="undefined"?"unknown":t.$4()},pixelToTileRange:function(n){return tab.IntegerRange.pixelToTileRange(n,this.$2,this.$4)},itemToTileIndex:function(n){return Math.floor(n/this.$4)},globalToLocalItemIndex:function(n){return n%this.$4}},null,[wr]);ss.initClass(gt,t,{});ss.initClass(yi,t,{},spiff.Template,[ss.IDisposable]);ss.initClass(pi,t,{$9:function(){return this.get_viewModel().get_pageModel().get_zoneModel()},dispose:function(){ss.isValue(this.$a)&&(this.$a.destroyRecursiveShim(!1),this.$a=null);ss.makeGenericType(spiff.BaseView$1,[ht]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.pageViewModel.get_pageModel())&&this.handleNewPage()},handleNewPage:function(){var n,t;ss.isNullOrUndefined(this.$a)&&ss.isValue(this.pageViewModel.get_pageModel())&&ss.isValue(this.pageViewModel.get_pageModel().pm)?(this.$a=this.createCurrentPagePanel(),this.get_template().domRoot.append(this.$a.getDomNode()),this.$a.startupShim(),n={x:0,y:0,w:this.$9().get_contentWidth(),h:this.$9().get_contentHeight()},tab.DomUtil.resize(this.$a,tab.RectXYUtil.toRect(n))):(t=this.createCurrentPagePanelProperties(),this.$a.updatePropertiesShim(t),this.$a.refreshLayoutShim())},updatePageControl:function(){ss.isValue(this.pageViewModel.get_pageModel())&&ss.isValue(this.pageViewModel.get_pageModel().pm)&&(this.$a.destroyRecursiveShim$1(),this.$a=null,this.handleNewPage())},createCurrentPagePanelProperties:function(){var t=this.pageViewModel.get_pageModel().pm,n={};return n.cpHeight=this.$9().get_contentHeight(),n.sheetid=this.$9().get_associatedSheet(),n.zid=this.$9().get_zoneId(),n.enable=this.pageViewModel.get_historyTrailsEnabled(),n.show_slider=t.showPageSlider,n.show_toggle=this.pageViewModel.get_showHistoryToggle(),n.show_dropdown=t.showPageReadout,n.current_page=t.currentPage,n.pages=t.pageNames,n.session=this.pageViewModel.get_viewSession(),n.layoutSession=this.pageViewModel.get_layoutSession(),n.lTitle=this.pageViewModel.get_title(),n.titleHtml=this.pageViewModel.get_titleHtml(),n.zoneTitleHeight=this.pageViewModel.get_zoneTitleHeight(),n.zoneTitleWidth=this.pageViewModel.get_zoneTitleWidth(),n.isDashboard=!0,n.pageViewModel=this.pageViewModel,n.backgroundColor=this.pageViewModel.get_backgroundColor(),n},createCurrentPagePanel:function(){var n=this.createCurrentPagePanelProperties();return this.instantiateCurrentPagePanel(n)},instantiateCurrentPagePanel:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeCurrentPagePanelWidget(n)}},ss.makeGenericType(spiff.BaseView$1,[ht]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[ht]),ss.makeGenericType(tab.IPageView$1,[ht])]);ss.initClass(ht,t,{add_newPage:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_newPage:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_resized:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_resized:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},add_titleVisibilityChanged:function(n){this.$2$3=ss.delegateCombine(this.$2$3,n)},remove_titleVisibilityChanged:function(n){this.$2$3=ss.delegateRemove(this.$2$3,n)},get_pageModel:function(){return this.$2},get_viewSession:function(){return tab.ModelUtils.getViewSession(this.get_pageModel().get_zoneModel().get_associatedSheet())},get_layoutSession:function(){return tab.CommandController.get().get_legacySession()},get_visualId:function(){return tab.ModelUtils.getVisualId(this.get_pageModel().get_zoneModel().get_associatedSheet())},get_titleHtml:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().pm.titleHtml:""},get_title:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_title():""},get_historyTrailsEnabled:function(){return this.$2.pm.pageTrailOptions.state},get_isHistoryToggleInteractionDisabled:function(){return tab.ApplicationModel.get_instance().get_workbook().get_isCurrentSheetStoryboard()},get_showHistoryToggle:function(){var n=this.$2.pm.showHistoryControls;return tsConfig.is_mobile&&this.get_isHistoryToggleInteractionDisabled()&&!this.get_historyTrailsEnabled()&&(n=!1),n},get_showHistoryToggleForPopup:function(){var n=this.get_showHistoryToggle();return this.get_isHistoryToggleInteractionDisabled()&&(n=!1),n},get_zoneTitleHeight:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_zoneModel().get_titleHeight():0},get_zoneTitleWidth:function(){return this.get_pageModel().get_zoneModel().get_hasTitle()?this.get_pageModel().get_zoneModel().get_titleWidth():0},get_backgroundColor:function(){return this.get_pageModel().get_zoneModel().get_backgroundColor()},handleNewPage:function(){this.raiseActionEvent(this.$2$1)},handleParentZoneResized:function(){this.raiseActionEvent(this.$2$2)},handleTitleVisibilityChanged:function(){this.raiseActionEvent(this.$2$3)}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IPageViewModel]);ss.initClass(wi,t,{get_model:function(){return this.$d.get_parameterCtrlModel().get_parameterCtrlPresModel()},get_paramTitle:function(){return ss.isValue(this.domTitleBar)?this.domTitleBar.title:null},get_domBoxElement:function(){return this.domBox},get_backgroundColor:function(){return this.backgroundColor},postCreate:function(){this.getSID=ss.mkdel(this,function(){return this.stateId});this.$1()},destroy:function(){ss.isValue(this.$c)&&this.$c.destroy();this.domContent.innerHTML="";this.inherited(arguments)},getTypeInParamClass:function(){return tableau.base.widget.paramui.TypeIn},getTypeInDateFieldParamClass:function(){return tableau.base.widget.paramui.TypeInDateField},getCompactParamClass:function(){return tableau.base.widget.paramui.Compact},getListParamClass:function(){return tableau.base.widget.paramui.List},getSliderParamClass:function(){return tableau.base.widget.paramui.Slider},$1:function(){var n=null;if(!ss.isNullOrUndefined(this.get_model())&&!ss.isNullOrUndefined(this.get_model().legacyPresModel)){this.domTitleBar.setAttribute("title",this.get_model().legacyPresModel.title);switch(this.$2()){case"type_in":n=this.getTypeInParamClass();break;case"compact":n=this.getCompactParamClass();break;case"list":n=this.getListParamClass();break;case"slider":n=this.getSliderParamClass();break;case"datetime":n=this.getTypeInDateFieldParamClass();break;default:return}ss.isValue(this.$c)&&(this.$c.destroy(),this.$c=null);ss.isNullOrUndefined(this.$7)&&(this.$7={});this.$c=new n(this,this.domContent,this.$8,this.$7,this.$d);this.$c.instantiate(!1);this.$6();this.$3()}},$6:function(){this.domTitleBar.innerHTML=this.$a;tab.FormattingConverters.cleanUpFontFamilyStyles($(this.domTitleBar));$(this.domTitleBar).find("div").css(ss.mkdict(["text-overflow","ellipsis","overflow","hidden"]))},updateProperties:function(n){this.session=n.session;this.$8=n.field;this.$9=n.titleH;this.$b=n.titleW;this.$a=n.titleHTML;this.format=n.format;this.backgroundColor=n.backgroundColor;this.$7=n.attributes;this.$6();this.$3();this.$4()},$3:function(){y.applyFormatting(this.domNode,this.get_model().textStyle,this.get_backgroundColor(),this.get_model().lineHeight,!1)},$4:function(){ss.isValue(this.$c)&&this.$c.refreshState(this.$7)},$2:function(){return this.get_model().paramDisplayMode},$0:function(){return this.$b===0&&this.$9===0},$5:function(){ss.isValue(this.domTitleBar)&&$(this.domTitleBar).css({height:"auto",width:"auto"})},getTitleOffset:function(){return $(this.domNode).hasClass("PCInlineTitle")?0:dojo.marginBox(this.domTitleBar).h},layout:function(){var n,i,t;ss.isNullOrUndefined(this.domNode.parentNode)||ss.isNullOrUndefined(this.$c)||($(this.domNode).removeClass("PCInlineTitle"),n={},this.$5(),(this.$9>0||this.$0())&&(n.h=this.$9,this.domTitleBar.style.height=n.h+"px"),(this.$b>0||this.$0())&&(n.w=this.$b,this.domTitleBar.style.width=n.w+"px"),tableau.util.setupTitleEllipsis($(this.domTitleBar)),i=dojo.contentBox(this.domNode),t={w:i.w,h:i.h},this.$0()||(this.$b>0?(t.w=i.w-n.w,this.$d.get_hasBorder()?(this.domContent.style.paddingTop="1px",t.w-=6):t.w-=2,this.domTitleBar.style.cssFloat="left",this.domContent.style.cssFloat="left",this.domNode.classList.add("PCInlineTitle")):(t.h=i.h-n.h,tab.FeatureFlags.isEnabled("MobileQFZoneInteractiveRedesign")&&tsConfig.is_mobile&&this.$d.get_hasBorder()&&(t.h-=3),this.domTitleBar.style.cssFloat="none",this.domContent.style.cssFloat="none")),this.$c.layout(t))},getDomNode:function(){return this.domNode},destroyRecursiveShim:function(n){this.destroyRecursive(n)},startupShim:function(){this.startup()},destroyRecursiveShim$1:function(){this.destroyRecursive()},updatePropertiesShim:function(n){this.updateProperties(n)},layoutShim:function(n){this.layout(n)}},Object,[tab.ILegacyWidgetShim,tab.IParameterControlWidgetShim]);ss.initClass(bi,t,{},spiff.Template,[ss.IDisposable]);ss.initClass(ki,t,{get_zoneModel:function(){return this.$b.get_zoneModel()},$9:function(){return this.$b.get_frame()},dispose:function(){ss.isValue(this.$a)&&(this.$a.destroyRecursiveShim(!1),this.$a=null);ss.makeGenericType(spiff.BaseView$1,[ct]).prototype.dispose.call(this)},onAddedToDom:function(){spiff.Widget.prototype.onAddedToDom.call(this);ss.isValue(this.$b.get_parameterCtrlModel())&&this.handleNewParameterControl()},handleNewParameterControl:function(){ss.isNullOrUndefined(this.$a)?(this.$a=this.createParameterControl(),this.get_template().domRoot.append(this.$a.getDomNode()),this.$a.startupShim(),tab.DomUtil.resize(this.$a,this.get_zoneModel().get_zoneContentBounds())):this.updateViewProperties();this.$a.layoutShim(null)},updateSize:function(){tab.DomUtil.resize(this.$a,this.get_zoneModel().get_zoneContentBounds());this.$a.layoutShim(null)},updateViewProperties:function(){if(!ss.isNullOrUndefined(this.$a)){var n=this.createParameterControlProperties();this.$a.updatePropertiesShim(n)}},createParameterControlProperties:function(){var n={};return n.session=this.$b.get_layoutSession(),n.zid=this.get_zoneModel().get_zoneId().toString(),n.field=this.$9().param,ss.isValue(this.get_zoneModel().pm.zoneCommon.styledBox)&&(n.backgroundColor=this.get_zoneModel().get_zoneCommonModel().get_contentStyle().get_fillColor()),ss.isValue(this.get_zoneModel().pm.zoneTitle)&&(n.titleHTML=this.$b.get_titleHtml(),n.titleH=this.$b.get_titleHeight(),n.titleW=this.$b.get_titleWidth()),ss.isValue(this.$9().format)&&(n.format=this.$9().format),ss.isValue(this.$9().attributes)&&(n.attributes=this.$9().attributes),n.viewModel=this.$b,n},createParameterControl:function(){var n=this.createParameterControlProperties();return this.$a=this.makeParameterControl(n),this.$a},makeParameterControl:function(n){var t=tab.ObjectRegistry.resolve(tab.ILegacyDojoWidgetMaker).call(null,[]);return t.makeControlWidget(n)}},ss.makeGenericType(spiff.BaseView$1,[ct]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[ct]),ss.makeGenericType(tab.IParameterControlView$1,[ct])]);ss.initClass(ct,t,{add_newParameterControl:function(n){this.$2$1=ss.delegateCombine(this.$2$1,n)},remove_newParameterControl:function(n){this.$2$1=ss.delegateRemove(this.$2$1,n)},add_resized:function(n){this.$2$2=ss.delegateCombine(this.$2$2,n)},remove_resized:function(n){this.$2$2=ss.delegateRemove(this.$2$2,n)},get_parameterCtrlModel:function(){return this.$4},get_frame:function(){return this.$4.get_frame()},get_zoneModel:function(){return this.$4.get_zoneModel()},get_layoutSession:function(){return tab.CommandController.get().get_legacySession()},get_hasBorder:function(){return this.$4.get_zoneModel().get_hasBorder()},get_titleHtml:function(){return this.get_isTitleVisible()?this.get_zoneModel().pm.zoneTitle.html:""},get_isTitleVisible:function(){return this.get_zoneModel().get_zoneCommonModel().get_hasTitle()},get_titleWidth:function(){var n=0;return this.get_isTitleVisible()&&this.get_zoneModel().get_titleWidth()>0&&(n=this.get_zoneModel().pm.zoneTitle.w),n},get_titleHeight:function(){var n=0;return this.get_isTitleVisible()&&this.get_zoneModel().get_titleHeight()>0&&(n=this.get_zoneModel().pm.zoneTitle.h,this.get_hasBorder()&&(n+=3),n=Math.max(n,17)),n},$2:function(){this.raiseActionEvent(this.$2$1)},$3:function(){this.raiseActionEvent(this.$2$2)}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IParameterControlViewModel]);ss.initClass(g,t,{get_legacyModel:function(){return this.parameterViewModel.get_parameterCtrlModel().get_parameterCtrlJsonPresModel()},get_model:function(){return this.parameterViewModel.get_parameterCtrlModel().get_parameterCtrlPresModel()},get_unformattedDisplayName:function(){return this.parameterViewModel.get_isTitleVisible()?this.get_legacyModel().title:""},instantiate:null,setNewState:null,refreshState:function(n){this.attributes=n;this.setNewState()},dispose:function(){this.disposables.dispose()},destroy:function(){this.dispose();this.div.innerHTML=""},layout:function(n){tab.FeatureFlags.isEnabled("MobileQFZoneInteractiveRedesign")&&tsConfig.is_mobile?(s.setMarginBoxWidth(this.div,n.w),this.div.style.maxHeight=n.h+"px"):dojo.marginBox(this.div,n)}},Object,[ss.IDisposable]);ss.initClass(tu,t,{instantiate:function(){},setNewState:function(){var t,n,i;if(ss.isValue(this.$2.get_selectedItem())&&!ss.referenceEquals(this.get_legacyModel().alias,this.$2.get_selectedItem().get_name()))for(t=this.$2.get_items(),n=0;n<t.length;n++)if(i=t[n],ss.referenceEquals(i.get_name(),this.get_legacyModel().alias)){this.$2.set_selectedItem(i);break}},$0:function(n){var t=n.get_data(),i=this.get_legacyModel().domain,r;t>=i.length||t<0||tab.MiscUtil.isNullOrEmpty$2(i)||ss.referenceEquals(i[t],this.get_legacyModel().alias)||(r=i[t],tab.ParameterServerCommands.setParameterValue(this.field,r,null))},layout:function(){this.inherited(arguments)}},g,[ss.IDisposable]);ss.initClass(iu,t,{instantiate:function(t){for(var e,o=ss.mkdel(n.filterItem,n.filterItem.getRadioHtml),u=this.field,s=this.get_legacyModel().alias,f=[],r=this.get_legacyModel().domain,h=r.length,i=0;i<h;i++)e=[u,"_",i.toString()].join(""),f.push(o(e,u,r[i],ss.referenceEquals(s,r[i])));this.div.innerHTML=f.join("");$(this.div).addClass("tab-ctrl-formatted-text");t!==!0&&this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this,this.$0)))},setNewState:function(){this.instantiate(!0)},$0:function(t){var e=t.target.tagName.toLowerCase(),r,i,u,f;e==="input"&&(r=$(t.target),i=r.parents(".FIItem"),i.length>0&&(u=n.filterItem.getIndex(i.get(0)),f=this.get_legacyModel().domain[u],tab.ParameterServerCommands.setParameterValue(this.field,f,null)))}},g,[ss.IDisposable]);ss.initClass(ru,t,{instantiate:function(){var r=this.get_legacyModel(),u=this.get_legacyModel().domain,i=this.get_legacyModel().alias,n=1,t=1;this.slider=new tableau.base.widget.ui.Slider(this.div,this.attributes,!1,ss.mkdel(this,this.doUpdateViz),ss.mkdel(this.parent,this.parent.getTitleOffset),ss.mkdel(this,this.getCurrentText),null,null,!1);r.fake_continuous&&(this.attributes["show-step-btns"]="false",this.attributes["show-ticks"]="false");var f=ss.mkdel(this,function(){this.slider.instantiateFromDomain(u,i)}),e=ss.mkdel(this,function(){n=Number.POSITIVE_INFINITY;t=this.percentageOfRange(this.modelValueOrRangeMin())*100;this.attributes["show-step-btns"]="false";this.slider.instantiate(n,t,i)}),o=ss.mkdel(this,function(){n=this.numPeriods();t=this.indexInDateRange(this.modelValueOrRangeMin());i=this.formatValue(this.modelValueOrRangeMin());this.slider.instantiate(n,t,i)}),s=ss.mkdel(this,function(){n=this.sizeOfDiscreteRange();t=this.indexInRange(this.modelValueOrRangeMin());this.slider.instantiate(n,t,i)}),h=ss.mkdel(this,function(){n=Number.POSITIVE_INFINITY;t=50;this.attributes["show-step-btns"]="false";this.slider.instantiate(n,t,i)});this.behaviorPicker(f,e,o,s,h)},behaviorPicker:function(n,t,i,r,u){return this.$0()?n():this.$1()?this.$6()?t():this.$5()?i():r():u()},setNewState:function(){var n=this.get_legacyModel().alias,i=ss.mkdel(this,function(){return this.currentlySelectedTupleInDomainList()}),r=ss.mkdel(this,function(){return{item1:n,item2:this.percentageOfRange(this.modelValueOrRangeMin())*100}}),u=ss.mkdel(this,function(){return{item1:this.formatValue(this.modelValueOrRangeMin()),item2:this.indexInDateRange(this.modelValueOrRangeMin())}}),f=ss.mkdel(this,function(){return{item1:n,item2:this.indexInRange(this.modelValueOrRangeMin())}}),e=function(){return{item1:n,item2:50}},t=this.behaviorPicker(i,r,u,f,e);ss.isValue(t)&&this.updateView(t)},updateView:function(n){ss.isValue(this.slider)&&(this.slider.setNewState(n.item2),this.slider.updateReadout(n.item1))},currentlySelectedTupleInDomainList:function(){for(var t=this.get_legacyModel().alias,i=this.get_legacyModel().domain.length,n=0;n<i;n++)if(ss.referenceEquals(this.get_legacyModel().domain[n],t))return{item1:t,item2:n};return null},doUpdateViz:function(n){var r=ss.mkdel(this,function(){return{item1:this.get_legacyModel().domain[n],item2:null}}),u=ss.mkdel(this,function(){return{item1:null,item2:this.$4(this.$d(n))}}),f=ss.mkdel(this,function(){return{item1:null,item2:this.$4(this.$b(n))}}),e=ss.mkdel(this,function(){return{item1:null,item2:this.$4(this.$c(n))}}),o=ss.mkdel(this,function(){return{item1:null,item2:this.$4(this.modelValueOrRangeMin())}}),t=this.behaviorPicker(r,u,f,e,o),i;ss.isValue(t)&&(i=null,ss.isValue(t.item1)?i=t.item1:ss.isValue(t.item2)&&(i=tableau.format.formatDataValue(t.item2,null,null,null,2)),tab.ParameterServerCommands.setParameterValue(this.field,i,!0))},layout:function(){this.inherited(arguments);ss.isValue(this.slider)&&typeof this.slider.layout=="function"&&this.slider.layout()},getCurrentText:function(n){var i=ss.mkdel(this,function(){return this.get_legacyModel().domain[n]}),r=ss.mkdel(this,function(){return this.formatValue(this.$d(n))}),u=ss.mkdel(this,function(){return this.formatValue(this.$b(n))}),f=ss.mkdel(this,function(){return this.formatValue(this.$c(n))}),e=function(){return""},t=this.behaviorPicker(i,r,u,f,e);return ss.isValue(t)?t:""},$0:function(){return ss.isValue(this.get_legacyModel().domain)},$1:function(){var n=this.get_legacyModel();return ss.isValue(n.granularity)&&ss.isValue(n.min)&&ss.isValue(n.max)},$6:function(){return this.get_legacyModel().granularity.s==="n"},$5:function(){return ss.isValue(this.get_legacyModel().date_period_type)},$8:function(){return ss.unbox(this.get_legacyModel().min.v)},$7:function(){return ss.unbox(this.get_legacyModel().max.v)},modelValueOrRangeMin:function(){return ss.isValue(this.get_legacyModel().value.v)?ss.unbox(this.get_legacyModel().value.v):this.$8()},$3:function(){return this.get_legacyModel().granularity.v},$2:function(){return this.get_legacyModel().date_period_type},numPeriods:function(){return this.get_legacyModel().num_periods},$a:function(){return this.$7()-this.$8()},percentageOfRange:function(n){return(n-this.$8())/this.$a()},$d:function(n){return n/100*this.$a()+this.$8()},sizeOfDiscreteRange:function(){return Math.round(this.$a()/this.$3())+1},indexInRange:function(n){return Math.round((n-this.$8())/this.$3())},$c:function(n){return n*this.$3()+this.$8()},indexInDateRange:function(n){return Math.round((n-this.$8())/(this.$3()*this.$9()))},$b:function(n){n=n*this.$3();var t=tab.DateUtil.adjustDateByPeriodInUTC(new Date(tableau.types.JsDateFromOleDate(this.$8())),this.$2(),n);return Math.min(tableau.types.OleDateFromJsDate(t.getTime()),this.$7())},$9:function(){switch(this.$2()){case"year":return 365.25;case"quarter":return 91.3125;case"month":return 30.4375;case"week":return 7;case"day":return 1;case"hour":return.0416666666666667;case"minute":return.000694444444444444;case"second":return 115740740740741e-19}return 0},formatValue:function(n){var t=this.get_legacyModel().date_format||this.get_legacyModel().format;return tableau.format.formatDataValue(this.$4(n),null,t,null,2)},$4:function(n){return{t:this.get_legacyModel().min.t,v:n.toString()}}},g,[ss.IDisposable]);ss.initClass(ni,t,{getWidgetClass:function(){return tableau.base.widget.ui.TypeIn},instantiate:function(){var n=this.getWidgetClass();this.widget=new n(this.div,ss.mkdel(this,this.$0),"TypeIn");this.widget.instantiate(this.get_legacyModel().alias,this.field,this.get_legacyModel().value,this.get_legacyModel().min,this.get_legacyModel().max,this.get_legacyModel().format,this.get_legacyModel().date_format,this.get_legacyModel().editing_format,this.get_model().firstDayOfWeek);this.get_legacyModel().is_list_domain&&this.widget.$3(this.get_legacyModel().domain,ss.mkdel(this.parent.session,this.parent.session.getAutocompleteInfo));tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&this.$2()},setNewState:function(){this.widget.setNewState(this.get_legacyModel().alias,this.get_legacyModel().domain,this.get_legacyModel().value,this.get_legacyModel().min,this.get_legacyModel().max)},layout:function(){this.inherited(arguments);this.widget.layout()},$2:function(){var n=this.parent.get_paramTitle();tab.MiscUtil.isNullOrEmpty$3(n)?$(this.widget.queryBox).removeAttr("aria-label"):$(this.widget.queryBox).attr("aria-label",n)},$0:function(n){ss.referenceEquals(this.newValInFlight,n)||(this.newValInFlight=n,tab.ParameterServerCommands.setParameterValue$1(this.field,n,!1,ss.mkdel(this,this.$3),ss.mkdel(this,this.$1)))},$1:function(){this.widget.queryBox.value=this.get_legacyModel().alias;this.newValInFlight=null;this.setNewState()},$3:function(){this.newValInFlight=null;_.defer(ss.mkdel(this,this.setNewState))}},g,[ss.IDisposable]);ss.initClass(uu,t,{getWidgetClass:function(){return tableau.base.widget.ui.TypeInDateField}},ni,[ss.IDisposable]);ss.initClass(fu,t,{instantiate:function(n,t){var i=arguments[0];this.widget=new tableau.base.widget.ui.TypeIn(this.div,ss.mkdel(this,this.doChange),"Pattern");this.widget.instantiate(i,t);tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&this.$3()},destroy:function(){this.widget.destroy()},layout:function(){this.inherited(arguments);this.widget.layout()},doChange:function(n){this.parent.set_stateId(this.parent.get_stateId()+1);tab.FilterClientCommands.setPatternFilterState(this.parent.get_session().get_visualId(),this.parent.get_field(),n.toString());this.parent.get_oFilter().pattern=n},$3:function(){tab.MiscUtil.isNullOrEmpty$3(this.parent.get_titleDomId())?$(this.widget.queryBox).removeAttr("aria-labelledby"):$(this.widget.queryBox).attr("aria-labelledby",this.parent.get_titleDomId())}},l,[ss.IDisposable]);ss.initClass(eu,t,{add_onPendingChanges:function(n){this.$1$1=ss.delegateCombine(this.$1$1,n)},remove_onPendingChanges:function(n){this.$1$1=ss.delegateRemove(this.$1$1,n)},add_onNoPendingChanges:function(n){this.$1$2=ss.delegateCombine(this.$1$2,n)},remove_onNoPendingChanges:function(n){this.$1$2=ss.delegateRemove(this.$1$2,n)},get_allItemCheckState:function(){return this.$4},set_allItemCheckState:function(n){this.$4=n},get_pendingChangelist:function(){return this.$8},set_pendingChangelist:function(n){this.$8=n},resetFilterInfo:function(n,t,i){this.domainActualSize=n;this.$6=t;this.$5=i},resetPendingChanges:function(){this.$8=new wt;this.$7=[];this.$a=!1;this.$9=!1;this.$4=null;this.$1()},processChanges:function(n){this.get_pendingChangelist().appendChangelist(n);this.$0()},processAll:function(n){this.$7=[];this.$a=!0;this.$9=this.$6?!n:n;this.$8=new wt;var t=new vt;t.setRange(new tab.IntegerRange(0,this.domainActualSize),this.$9);this.get_pendingChangelist().addChange(t);this.$0()},isSelectAll:function(){return this.$a&&this.$7.length===0&&(this.$6?!this.$9:this.$9)},isDeSelectAll:function(){return this.$a&&this.$7.length===0&&(this.$6?this.$9:!this.$9)},handleAllItemClicked:function(n){var i=this.$6?!n:n,t;for(this.set_allItemCheckState(n),t=0;this.hasItemAtIndex(t);)i?(this.isChecked(t)||this.togglePendingCss(t),this.setChecked(t,!0)):(this.isChecked(t)&&this.togglePendingCss(t),this.setChecked(t,!1)),t++;this.$a=!0;this.$9=i;this.$7=[]},handleItemClicked:function(n,t){var i,r,u,f;if(n===-1){this.handleAllItemClicked(this.isChecked(n));return}if(this.isChecked(n,t)){if(this.hasAllItem()){for(u=!0,f=0;u&&this.hasItemAtIndex(f);)this.isChecked(f)||(u=!1),f++;this.setAllItemChecked(u)}}else if(this.parent.shouldUseAllItem()&&(this.set_allItemCheckState(!1),this.hasAllItem()&&(this.setAllItemChecked(!1),this.$6))){for(i=!0,r=0;i&&this.hasItemAtIndex(r);)this.isChecked(r)&&(i=!1),r++;this.setAllItemChecked(i)}this.togglePendingCss(n,t);this.$3(n)},hasAllItem:function(){var t=this.parent.fetchAllItem();return ss.isValue(t)&&n.filterItem.isAllItem(t)},hasItemAtIndex:function(n){return n<this.domainActualSize&&ss.isValue(this.parent.fetchChildNodeByIndex(n))},setAllItemChecked:function(t){var i=this.parent.fetchAllItem();ss.isValue(i)&&(n.filterItem.setChecked(i,t),this.set_allItemCheckState(t))},togglePendingCss:function(t,i){var r=ss.isValue(i)?i:this.parent.fetchChildNodeByIndex(t);ss.isValue(r)&&n.filterItem.togglePendingState(r)},setChecked:function(t,i){var r=this.parent.fetchChildNodeByIndex(t);ss.isValue(r)&&n.filterItem.setChecked(r,i)},isChecked:function(t,i){var r;return r=t===-1?this.parent.fetchAllItem():ss.isValue(i)?i:this.parent.fetchChildNodeByIndex(t),n.filterItem.isChecked(r)},isPending:function(n,t){if(this.$a){var i=this.$5&&!this.$6?!0:n.s;return ss.contains(this.$7,t)?i===this.$9:i!==this.$9}return ss.contains(this.$7,t)},$0:function(){this.$a||this.$7.length>0?this.$2():this.$1()},$2:function(){ss.isValue(this.$1$1)&&this.$1$1()},$1:function(){ss.isValue(this.$1$2)&&this.$1$2()},$3:function(n){ss.contains(this.$7,n)?ss.remove(this.$7,n):this.$7.push(n)}});ss.initClass(nt,t,{});ss.initClass(di,t,{},f,[ss.IDisposable]);ss.initClass(at,t,{$t:function(){return this.get_viewModel()},$r:function(){return this.$t().get_quantColorLegendPresModel()},$s:function(){return this.get_template()},onAddedToDom:function(){ss.makeGenericType(c,[ft]).prototype.onAddedToDom.call(this);this.$g()},onViewModelPropertyChanged:function(n,t){switch(t.get_propertyName()){case"isActiveZone":case"isReadyZone":break;case"ParentZoneSizeChanged":var i=this.$t().$4();i.w===tab.DoubleUtil.roundToInt(this.$s().panel.width())&&i.h===tab.DoubleUtil.roundToInt(this.$s().panel.height())||this.$n();break;case null:case"titleVisible":case"ModelChanged":this.$n();break;default:this.$n()}},showContextMenu:function(){this.$t().showWebQuantitativeColorDialog()},$h:function(){this.$s().panel.addClass("hover")},$i:function(){this.$s().panel.removeClass("hover")},$n:function(){this.$g()},$g:function(){this.drawTitle();this.$q();this.$k()},drawTitle:function(){ss.makeGenericType(c,[ft]).prototype.drawTitle.call(this);this.get_legendViewModel().get_titleInline()||this.$s().titleArea.width(this.$t().$4().w)},$q:function(){this.$s().panel.get(0).id=this.$j();var n=this.$t().$4().h,t=this.$t().$4().w;at.setDomNodeStyleSize(this.$s().panel,t,n)},$j:function(){return"tableau_qcolor_legend_"+encodeURIComponent(this.$t().$7())},$k:function(){var n=this.$r().quantitativeLegendLayout,t=$.extend(!0,{},n.rectRamp),i=this.$s().ramp,r=i.get(0),u=tab.CanvasRenderer.getRenderContext(r,"opaque"),f=n.rectMinLabel.x+n.rectMinLabel.w<t.x;this.$l(u,f,t);this.$m(i,t,r,u,f)},$l:function(n,t,i){n.save();tab.DisplayList2DRenderer.setTextProperties(n,this.$r().labelTextStyle,0);this.$p(this.$s().minLabel);t&&this.$e(n,i);var r=this.$s().maxLabel;this.$r().quantitativeLegendLayout.isSingleLabel?r.css("visibility","hidden"):(r.css("visibility","visible"),this.$o(r),t&&this.$d(n,i,r));n.restore()},$m:function(n,t,i,r,u){var d,s,h,c,v,a,g,nt,y,l,p,tt,f,b,rt;n.css("left",t.x.toString()+"px");n.css("top",t.y.toString()+"px");n.css("transform","translate3d(0, 0, 0)");var k=this.$r().rampBorderStyledBox.uw*2,e=t.w-k+1,o=t.h-k+1;if(n.css("width",e+"px"),n.css("height",o+"px"),d={w:e,h:o},tab.CanvasUtil.sizeCanvasWithHighDPISupport(i,r,d),r.save(),s=this.$t().get_rampColorSamplesAsColorModels(),h=s.length,this.$r().isColorStepped){for(c=0,v=Math.round(e/h),a=0;a<h-1;++a)r.set_shapeFillStyle(s[a]),r.fillRect(c,0,v+1,o),c+=v;g=e-c;r.set_shapeFillStyle(s[h-1]);r.fillRect(c,0,g,o)}else{for(nt=this.$t().get_rampColorPositions(),y=r.createLinearGradient(0,0,e,0),l=0;l<h;++l)p=tab.DoubleUtil.parseDouble(nt[l]),ss.isValue(p)&&y.addColorStop(ss.unbox(p),s[l]);r.set_shapeFillStyle(y);r.fillRect(0,0,e,o)}if(r.restore(),tt=tab.FormattingConverters.makeBorderStyleDict(this.$r().rampBorderStyledBox),n.css(tt),this.$r().isColorDiverging){f=this.$s().centerMark;f.css("visibility","visible");var w=this.$r().quantitativeLegendLayout.centerMarkLineBegin.x,it=this.$r().quantitativeLegendLayout.centerMarkLineBegin.y,ut=this.$r().quantitativeLegendLayout.centerMarkLineEnd.y,ft=ut-it;u&&t.w!==this.$r().quantitativeLegendLayout.rectRamp.w&&(b=this.$r().quantitativeLegendLayout.rectRamp,rt=(w-b.x)/b.w,w=t.x+Math.ceil(rt*t.w));f.css("left",w.toString()+"px");f.css("top",it.toString()+"px");f.width(1);f.height(ft);f.css("background-color","black")}else this.$s().centerMark.css("visibility","hidden")},$o:function(n){var t=this.$r().quantitativeLegendLayout,i;n.css("left",t.rectMaxLabel.x.toString()+"px");n.css("top",t.rectMaxLabel.y.toString()+"px");n.css("width",t.rectMaxLabel.w.toString()+"px");n.css("height",t.rectMaxLabel.h.toString()+"px");n.css("line-height",t.rectMaxLabel.h.toString()+"px");n.css("text-align","right");i=this.$r().labelTextStyle;n.css(tab.FormattingConverters.makeFormatStyleDict(i,null));n.text(this.$r().maxLabel)},$d:function(n,t,i){var r=Math.max(0,Math.round(n.measureText(this.$r().maxLabel).width)-this.$r().quantitativeLegendLayout.rectMaxLabel.w);r+=this.$t().get_borderWidth()*2;r=this.$f(r,t.w);r>0&&(i.css("left",(this.$r().quantitativeLegendLayout.rectMaxLabel.x-r).toString()+"px"),t.w-=r)},$p:function(n){var t=this.$r().quantitativeLegendLayout,i;n.css("left",t.rectMinLabel.x.toString()+"px");n.css("top",t.rectMinLabel.y.toString()+"px");n.css("width",t.rectMinLabel.w.toString()+"px");n.css("height",t.rectMinLabel.h.toString()+"px");n.css("line-height",t.rectMinLabel.h.toString()+"px");n.css("text-align",t.isSingleLabel?"center":"left");i=this.$r().labelTextStyle;n.css(tab.FormattingConverters.makeFormatStyleDict(i,null));n.text(this.$r().minLabel)},$e:function(n,t){var i=Math.round(n.measureText(this.$r().minLabel).width)-this.$r().quantitativeLegendLayout.rectMinLabel.w;i=this.$f(i,t.w);i>0&&(t.x+=i,t.w-=i)},$f:function(n,t){var i=0;return n>0&&t>1&&(i=Math.min(n,Math.floor(t*.15))),i}},ss.makeGenericType(c,[ft]),[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[ft]),ss.makeGenericType(tab.IQuantitativeColorLegendView$1,[ft])]);ss.initClass(ft,t,{get_quantColorLegendPresModel:function(){return this.$d.get_quantColorLegendPresModel()},get_fieldNames:function(){return this.get_quantColorLegendPresModel().legendNames},get_presModelTitleHtml:function(){return this.get_quantColorLegendPresModel().titleHtml},get_presModelTitleInline:function(){return this.get_quantColorLegendPresModel().quantitativeLegendLayout.titleInline},get_regionType:function(){return"color"},get_rampColorPositions:function(){return ss.arrayFromEnumerable(Object.keys(this.get_quantColorLegendPresModel().colorMap))},get_rampColorSamplesAsColorModels:function(){var i=[],t=ss.arrayFromEnumerable(Object.keys(this.get_quantColorLegendPresModel().colorMap)),r,n,u;if(ss.isValue(t))for(r=this.get_quantColorLegendPresModel().colorTransparencyValue/255,i=new Array(t.length),n=0;n<t.length;++n)u=t[n],i[n]=tab.ColorModel.fromColorModelPlusAlpha(tab.ColorModel.fromColorCode(this.get_quantColorLegendPresModel().colorMap[u]),r).toString();return i},get_borderWidth:function(){var n=this.get_quantColorLegendPresModel().styledBox.uw;return this.get_quantColorLegendPresModel().styledBox.borderStyle==="bs-none"&&(n=0),n},get_presModelTitleHeight:function(){return this.get_quantColorLegendPresModel().quantitativeLegendLayout.rectTitle.h},get_presModelTitleWidth:function(){return this.get_quantColorLegendPresModel().quantitativeLegendLayout.rectTitle.w},get_shouldShowContextMenu:function(){return this.get_quantColorLegendPresModel().isContextMenuAllowed},dispose:function(){this.$d.remove_legendChanged(ss.mkdel(this,this.$c));v.prototype.dispose.call(this)},$c:function(){this.notifyPropertyChanged("ModelChanged")},showWebQuantitativeColorDialog:function(){var n=new tab.GetWebQuantitativeColorDialogCmd;n.c.fieldVector=this.get_fieldNames();n.invoke()}},v,[ss.IDisposable,tab.IViewModel,tab.IQuantitativeColorLegendViewModel]);ss.initClass(gi,t,{},spiff.Template,[ss.IDisposable]);ss.initClass(ou,t,{get_scrollNode:function(){return this.contentNode},instantiate:function(n,t,i){var u,r;this.$3=this.parent.get_searchWidget();this.$3.setStyle(2);u=$(this.div).addClass("CFOuterContainer");this.$3.startupAndAppendTo(u);this.$3.hideUI();r=$("<div>").addClass("CFInnerContainer").addClass("tab-ctrl-formatted-text");tab.BrowserSupport.get_isFF()&&r.attr("tabindex","-1");u.append(r);this.contentNode=r.get(0);this.resetContent(n,t,i);this.disposables.add$1(spiff.EventUtil.bindWithDispose($(this.div),"click",ss.mkdel(this.parent,this.parent.onListItemClick)));this.div.addEventListener("focus",this.listItemFocusHandler,!0);this.disposables.add(ss.mkdel(this,function(){this.div.removeEventListener("focus",this.listItemFocusHandler,!0)}))},resetContent:function(t,i,r){var e=$(this.contentNode),u,f;if(e.empty(),this.shouldUseAllItem()&&t.length>0&&(p.addAllItem(e,this.parent,i,r,n.isAllOrAllChecked(this.parent),this.get_itemFormatter()),n.isAllOrAllChecked(this.parent)))for(u=0;u<t.length;u++)t[u].s=!1;ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=d.createRadiolist(this.parent,t,this.contentNode,i,this.get_lineHeight());f=this.contentNode.querySelector("[role=listbox]");ss.isValue(f)&&f.setAttribute("aria-labelledby",this.parent.get_titleDomId())},updateContent:function(n){var t=$.contains(this.div,document.activeElement),i=n.length>0?n.join(""):this.$3.get_noMatchHtml(),r=$(this.contentNode);ss.isValue(this.tiledWidget)&&(this.tiledWidget.destroy(),this.tiledWidget=null);r.html(i);this.updateTabIndexes(this.div,t)},shouldNotReinstantiate:function(){return ss.isValue(this.$3)&&this.$3.isShowingResults()},layout:function(n){var t,i;this.inherited(arguments);ss.isValue(this.tiledWidget)&&this.tiledWidget.updateViewport(n.w,n.h);t=tab.FeatureFlags.isEnabled("MobileQFZoneInteractiveRedesign")&&tsConfig.is_mobile;t||(i=ss.isValue(this.$3)&&this.$3.get_isVisible()?dojo.marginBox(this.$3.domNode).h:0,this.contentNode.style.height=this.div.clientHeight-i+"px")},destroy:function(){this.dispose();ss.isValue(this.$3)&&this.$3.destroy();ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy();this.tiledWidget=null},fetchChildNodeByIndex:function(n){return ss.isValue(this.tiledWidget)?this.tiledWidget.getElement(n):null},fetchAllItem:function(){return this.shouldUseAllItem()&&ss.isValue(this.contentNode)?this.contentNode.firstChild:null}},l,[ss.IDisposable]);ss.initClass(su,t,{},ti,[fi]);ss.initClass(vt,t,{setRange:function(n,t){this.type=1;this.range=n;this.checkState=t},setSingle:function(n,t){this.type=0;this.index=n;this.checkState=t}});ss.initEnum(hu,t,{year:"year",quarter:"quarter",month:"month",week:"week",day:"day",hour:"hour",minute:"minute",second:"second"},!0);ss.initEnum(cu,t,{curr:"curr",todate:"todate",last:"last",next:"next",lastn:"lastn",nextn:"nextn",other:"other",othern:"othern",invalid:"invalid"},!0);ss.initClass(lu,t,{get_filterType:function(){return this.$2.get_filterType()},get_legacyRelativeDateQuickFilterModel:function(){return this.$2},get_defaultFormat:function(){return this.$2.get_defaultFormat()},get_fiscalYearStart:function(){return this.$2.get_fiscalYearStart()},get_noTime:function(){return this.$2.get_noTime()},get_isRelativeDatePick:function(){return this.$2.get_isRelativeDatePick()},get_text:function(){return this.$2.get_text()},get_relativeDateTable:function(){return this.$2.get_relativeDateTable()},get_periodType:function(){return this.get_relativeDateTable().periodType},get_rangeType:function(){return this.get_relativeDateTable().rangeType},get_rangeN:function(){return this.get_relativeDateTable().rangeN},get_anchor:function(){return ss.isValue(this.get_relativeDateTable().anchor)?this.get_relativeDateTable().anchor:null}},spiff.BaseViewModel,[ss.IDisposable,tab.IViewModel,tab.IFilterTypeViewModel]);ss.initClass(tt,t,{get_filterViewModel:function(){return this.filterViewModel},get_shouldLayoutTitleAndContentOnSameLine:function(){return!this.hideEmptyTitlebar()&&this.titleW>0},postCreate:function(){this.filterViewModel.get_filterType()!=="RelativeDatePick";this.disposables=new tab.DisposableHolder;this.getSID=ss.mkdel(this,function(){return this.stateId});this.timestamp=(new Date).getMilliseconds();this.initFromState();$(this.menuButton.domNode).css("background-color",this.backgroundColor)},shouldHideDomainButton:function(){return!0},shouldHideContextMenu:function(){if(tsConfig.current_sheet_type==="dashboard"&&tsConfig.is_authoring)return!0;var n=tab.CommandsPresModelWrapper.create(this.getContextMenuCommands());return this.hideEmptyTitlebar()||ss.isNullOrUndefined(n)||n.get_commandItems().length===0},dispose:function(){this.disposables.dispose();this.showContextMenu=null},destroy:function(){this.dispose();this.domPicker.innerHTML="";this.inherited(arguments)},initFromState:function(){var n,t;this.currentRange=this.oFilter.table;this.currentAbbrev=this.toAbbrev(this.currentRange);this.domPicker.innerHTML="";n=tableau.format.formatColumnDisplayName(this.oFilter,!1,!1);this.domTitleBar.setAttribute("title",n);this.updateTitleBar();_.each(tt.pickerStrings,ss.mkdel(this,function(n,t){var i=document.createElement("div"),r,u;i.innerHTML=tableau.format.escapeHTML(n);i.classList.add("PickLabel");i.classList.add("tab-ctrl-formatted-border-hover");this.domPicker.appendChild(i);r=$(i);u=ss.mkdel(this,function(n){this.onClick(t,n)});this.disposables.add$1(spiff.EventUtil.bindWithDispose(r,"click",u));ss.referenceEquals(this.currentAbbrev,tt.pickerDurations[t])&&(this.$1(i),this.$3=i)}));this.layout(null);t=function(n,t){var i=$(n.domNode);t?(i.removeClass("RDFButtonR1"),i.addClass("RDFButtonHide")):(i.removeClass("RDFButtonHide"),i.addClass("RDFButtonR1"))};t(this.menuButton,this.shouldHideContextMenu())},$1:function(n){var t=$(n);t.addClass("Selected");t.addClass("tab-ctrl-formatted-widget");t.removeClass("tab-ctrl-formatted-border-hover");t.addClass("tab-ctrl-formatted-darker-border-hover")},$2:function(n){var t=$(n);t.removeClass("Selected");t.removeClass("tab-ctrl-formatted-widget");t.addClass("tab-ctrl-formatted-border-hover");t.removeClass("tab-ctrl-formatted-darker-border-hover")},formatTuple:function(n){return tableau.format.formatTupleDisplayName(n,!0,this.oFilter.role)},toAbbrev:function(n){var i=n.rangeN.toString(),t;switch(n.rangeType){case"curr":t="0";break;case"lastn":t="-"+i;break;case"nextn":t=i;break;default:return""}switch(n.periodType){case"year":t+="y";break;case"quarter":t+="q";break;case"month":t+="m";break;case"week":t+="w";break;case"day":t+="d";break;case"hour":t+="h";break;default:return""}return t},onClick:function(n,t){var i=tt.pickerDurationsInteger[n];ss.referenceEquals(t.target,this.$3)||(ss.isValue(this.$3)&&this.$2(this.$3),this.$1(t.target),tab.FilterClientCommands.doRelativeDateQuickFilter(this.session.get_visualId(),this.field,"day","lastn",i))},doMenu:function(){this.showContextMenu(this.menuButton.domNode)},layout:function(){var t,n,r,i;($(this.domNode).removeClass("RDPFHorizontal"),this.updateTitleBar(),n=dojo.marginBox(this.domPicker),ss.isValue(n)&&ss.isValue(n.w)&&n.w!==0)&&(r=this.layoutTitleBar(),i=dojo.contentBox(this.domNode),t=i.w,this.get_shouldLayoutTitleAndContentOnSameLine()?($(this.domNode).addClass("RDPFHorizontal"),$(this.domTitleBar).css("float","left"),$(this.domPicker).css("float","left"),t=i.w-r.w):($(this.domTitleBar).css("float","none"),$(this.domPicker).css("float","none")),dojo.contentBox(this.domPicker,ss.mkdict(["w",t])))}},k,[ss.IDisposable]);ss.initClass(au,t,{get_newPos:function(){return this.$0}},ss.EventArgs);ss.initClass(nr,t,{get_applyDelay:function(){return this.applyDelay},get_isPendingMode:function(){return!1},get_filterTable:function(){return!this.get_oResults()?null:this.get_oResults()},get_quickFilter:function(){return this.get_qf()},shouldDeferChanges:function(){return!1},postCreate:function(){this.inherited(arguments);this._isTypeInList&&this.showUI(!0);this._isFilterSearchable=!0;!!this.get_qf()&&this._isTypeInList&&(this._isFilterSearchable=this.get_qf().get_oFilter().is_searchable);this.domSearchAddButton.title=this._isFilterSearchable?this.ADD_ITEM_CTRL_ENTER:this.ADD_ITEM_ENTER;this.setQueryIconsVisibility(!0);s.disableTextSelection(this.domResults)},destroy:function(){ss.isValue(this.domResults)&&$([this.domResults]).remove();this.inherited(arguments)},onQueryBoxPaste:function(){this._queryBoxPasteTimeout=tab.MiscUtil.clearTimeout(this._queryBoxPasteTimeout);this._queryBoxPasteTimeout=window.setTimeout(ss.mkdel(this,this._handleQueryBoxPaste),10)},_handleQueryBoxPaste:function(){var t,n;n=this.getQuery();n=n.replace("/\r\n/g","\n");t=n.split("\n");t.length>1&&this.addManualSearchItems(t)},getOnQueryBoxKeyDownBehavior:function(n){var t=this.inherited(arguments);switch(n.keyCode){case 27:tab.BrowserSupport.get_isFF()&&(t.functionToCall=ss.mkdel(this,this.onXButtonClick));break;case 13:this._isTypeInList&&(t.stopEvent=!0,t.functionToCall=this._getEnterKeyDownBehaviorOnTypeInList(n))}return t},_getEnterKeyDownBehaviorOnTypeInList:function(n){return n.ctrlKey?ss.mkdel(this,this.onSearchAddButtonClick):this._isFilterSearchable?ss.mkdel(this,this.onSearchButtonClick):ss.mkdel(this,this.onSearchAddButtonClick)},handleQueryTextChanged:function(){this.inherited(arguments);this._isTypeInList&&this.clearSearch(!0,!0);this._isTypeInList||this.$7()},onSearchAddButtonClick:function(){this.addManualSearchItems(null)},onSearchButtonClick:function(){this.doSearch()},onSearchBusyImgClick:function(){this.$2()},focusQueryBox:function(){this.domQueryBox.focus()},getQuery:function(){return this.domQueryBox.value},setQuery:function(n){this.domQueryBox.value=n},showUI:function(){this.get_isVisible()||(this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this.get_qf().get_oFilter().table.tuples.length!==0||this._isTypeInList)&&this.inherited(arguments)},clearSearch:function(){this.domResults.style.display="none";this.domResults.innerHTML="";this.clearRangeAnchorAndSelection();this.$2();this.inherited(arguments)},setQueryIconsVisibility:function(n){var t=this._isTypeInList,i=!!n&&n?!1:tableau.util.isElementVisible(this.domResults),r=!ss.isNullOrEmptyString(this.getQuery())&&t&&!i,e=r,u=r&&this._isFilterSearchable,f;this.domSearchBusyImg.style.display=u&&this._bSearching?"block":"none";this.domSearchButton.style.display=u&&!this._bSearching?"block":"none";this.domSearchAddButton.style.display=e?"block":"none";f=t&&!i?"none":"block";this.get_domXButton().style.display=f;this.fixQueryWidth()},fetchChildNodeByIndex:function(t){for(var r=this.domResults.childNodes,i=0,u=r.length;i<u;i++)if(n.filterItem.getIndex(r[i])===t)return r[i];return null},layout:function(n){this.setQueryIconsVisibility();var t=this.$3();this._isTypeInList||this.get_qf().get_mode()==="checkdropdown"?this.$4(t):t!==0&&this.$6(ss.Int32.div(ss.unbox(n),t),t)},fixQueryWidth:function(){var t=tableau.util.isElementVisible(this.get_domXButton()),i=tableau.util.isElementVisible(this.domSearchAddButton),r=tableau.util.isElementVisible(this.domSearchButton),u=tableau.util.isElementVisible(this.domSearchBusyImg),n=0;t&&(n+=dojo.marginBox(this.get_domXButton()).w);i&&(n+=dojo.marginBox(this.domSearchAddButton).w);r&&(n+=dojo.marginBox(this.domSearchButton).w);u&&(n+=dojo.marginBox(this.domSearchBusyImg).w);dojo.marginBox(this.domQueryBox,ss.mkdict(["w",dojo.contentBox(this.domQuerySection).w-n-1]))},$4:function(n){var r=$(tab.WorkbookView.dashboardSpacerSelector),y,p;this._initializedSearchResults||(this._initializedSearchResults=!0,r.append(this.domResults),$(this.domResults).css({position:"absolute","z-index":"987"}),this._domResultsPBExtents=dojo._getPadBorderExtents(this.domResults));var e=dojo.coords(this.domQuerySection),o=$(this.domQuerySection).offset(),s=r.offset(),u=tab.DoubleUtil.roundToInt(o.top)-tab.DoubleUtil.roundToInt(s.top),h=u+e.h,f=dojo.coords(r.get(0)),w=f.t+f.h,c=n+this._domResultsPBExtents.h,l=this.domResults.childNodes.length*n+this._domResultsPBExtents.h,a=w-h,v=u-f.t,i=!0,t=Math.min(l,a);t<c&&v>a&&(t=Math.min(l,v),i=!1);t=Math.max(t,c);dojo.marginBox(this.domResults,ss.mkdict(["w",e.w,"h",t]));y=i?h:u-t;p=tab.DoubleUtil.roundToInt(o.left)-tab.DoubleUtil.roundToInt(s.left);$(this.domResults).css({top:y+"px",left:p+"px","border-top-width":(i?0:1)+"px","border-bottom-width":(i?1:0)+"px"})},$6:function(n,t){var i=Math.max(this.domResults.childNodes.length,1),r=Math.min(i,Math.floor(n/2));this.domResults.style.height=(r*t).toString()+"px"},$3:function(){if(ss.isNullOrUndefined(this.domResults.firstChild))return 0;var n=$(this.domResults.firstChild);return ss.isValue(n[0].offsetHeight)?n[0].offsetHeight:15},$7:function(){this._searchTimer=tab.MiscUtil.clearTimeout(this._searchTimer);this._searchTimer=window.setTimeout(ss.mkdel(this,this.doSearch),this.searchDelay)},showSearchSpinner:function(n){this._bSearching=n;this.setQueryIconsVisibility()},addManualSearchItems:function(n){var u,t,f,i,r;if(this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyCategoricalQuickFilter"&&(tab.MiscUtil.isNullOrUndefined(n)&&(n=this.getQuery().split("\n")),!tab.MiscUtil.isNullOrEmpty$2(n))){for(u=[],t=0,f=n.length;t<f;t++)i=n[t],tab.MiscUtil.isNullOrEmpty$3(i)||u.push({d:i,s:!0,t:[{t:"s",v:i}]});r={};r.schema=this.get_qf().get_oFilter().table.schema;r.tuples=u;this.notifyParentFilterOfChanged(r,!0,!1);this.clearSearch(!1,!1)}},doSearch:function(){this.searchWithQuery(this.getQuery())},updateSearch:function(){this.get_isVisible()&&this.resultCount>0&&this.searchWithQuery(this.getQuery())},searchWithQuery:function(n){n.length<=0?this.clearSearch(!1,!1):this.get_qf().get_dijitDeclaredClass().indexOf("LegacyCategoricalQuickFilter")>-1&&!this._isTypeInList?this.get_qf().get_oFilter().isTiled?this.doRemoteSearch(n,!0):this.handleSearchResults(this.doCategoricalSearch(n)):this.doRemoteSearch(n,!1)},doRemoteSearch:function(n,t){this.showSearchSpinner(this._isTypeInList);this._lastRemoteSearch=this.doAjaxRemoteSearch(n,this.$9,t,ss.mkdel(this,this.handleSearchResults),ss.mkdel(this,this.handleSearchResultsError))},$2:function(){!this._lastRemoteSearch||(this._lastRemoteSearch.abort(),this._lastRemoteSearch=null);this.showSearchSpinner(!1)},$1:function(n,t,i){var u=tableau.format.escapeHTML,r,f;!ss.isNullOrUndefined(i)&&t<i&&(r=i-t,n.push('<div class="searchResultsRemaining">'),r===1?n.push(u(tab.Strings.SearchResultsNotShownSingular)):(f=tableau.format.formatIntAuto(r,"t",",","3;0"),n.push(u(tab.Strings.SearchResultsNotShownPlural(f)))),n.push("<\/div>"))},$5:function(t){var i,e,o,s;if(t.length<=0)return[];this.set_oResults(t);var r=this.get_oResults().tuples,f=this.get_oResults().indices,u=[],h=this.makeUniqueSearchItemIdPrefix();for(i=0,e=r.length;i<e;i++)o=!f?i:f[i],s=n.filterItem.getSearchResultHtml(this.get_qf(),r[i],h,o),u.push(s);return this.$1(u,r.length,t.actual_size),u},handleSearchResults:function(n){var i=tableau.format.escapeHTML,t=tab.Strings.QuickFilterSearchNoMatches;(this.showSearchSpinner(!1),n&&n.dojoType==="cancel")||(this.domResults.innerHTML="",(this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"||this._isTypeInList||this.get_qf().get_oFilter().isTiled)&&(!n.schema[0].collation||n.schema[0].collation.f!==0||(t="<div>"+i(t)+"<br/>"+i(tab.Strings.QuickFilterSearchDataIsCaseSensitive)+"<\/div>"),n=this.$5(n)),this.resultCount=n.length,this.domResults.innerHTML=this.resultCount>0?n.join(""):t,this.domResults.style.display=this.domResults.innerHTML.length>0?"block":"none",this.setQueryIconsVisibility(),this.get_qf().layout(null),this.$8.refreshRangeAnchorAndSelection())},handleSearchResultsError:function(){this.showSearchSpinner(!1);this.domResults.innerHTML="";this.resultCount=0},applyChanges:function(){var n=null;n=this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this._isTypeInList?this.applyChangesHierOrTypeIn():this.applyChangesCat();this.notifyParentFilterOfChanged(n,!1,!1)},applyChangesByChangelist:function(n){this.get_qf().get_dijitDeclaredClass()!=="tableau.base.widget.LegacyCategoricalQuickFilter"||this._isTypeInList?this.applyChanges():this.get_qf().applyChangesByChangelist(n)},notifyParentFilterOfChanged:function(n,t,i){var r,u,f;n.tuples.length!==0&&((this.get_qf().updateStateFromSearch(n),i)||(r=this.get_qf(),r.set_stateId(r.get_stateId()+1),t?tab.FilterClientCommands.addManualFilterItems(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),n):(u=this._isTypeInList&&this.get_qf().get_oFilter().all,f=u||this.get_qf().isSingleSelect(),f?this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"?this._doModifyHierarchialFilter(f,n):this.doSetCategoricalFilter(u,n):this.get_qf().get_dijitDeclaredClass()==="tableau.base.widget.LegacyHierarchicalQuickFilter"?this._doModifyHierarchialFilter(!1,n):this.doModifyCategoricalFilter(n))))},doSetCategoricalFilter:function(n,t){var r,u=[],f=t.tuples.length,i;if(n)for(i=0;i<f;i++)r=t.tuples[i].d||t.tuples[i].t[0].v,t.tuples[i].s&&u.push(r);else r=t.tuples[0].d||t.tuples[0].t[0].v,u.push(r);tab.FilterClientCommands.setCategoricalFilterValues(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),"filter-replace",u,null)},doModifyCategoricalFilter:function(n){for(var i,r=[],u=[],f=n.tuples.length,t=0;t<f;t++)i=n.tuples[t].d||n.tuples[t].t[0].v,n.tuples[t].s?r.push(i):u.push(i);tab.FilterClientCommands.modifyCategoricalFilterValues(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),r,u,!0)},_doModifyHierarchialFilter:function(n,t){for(var h,r,u,e,o=[],s=[],c=n?"filter-replace":"filter-delta",l=t.tuples.length,f=t.tuples,i=0;i<l;i++){for(h=f[i].t.length,r="",u=0;u<h;++u)e=f[i].t[u],!e.v||(r=e.v);f[i].s?o.push(r):s.push(r)}tab.FilterClientCommands.doMemberHierarchialFilter(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),o,s,c)},applyChangesCat:function(){var i={},o,f,s,h,l,e;i.schema=this.get_qf().get_oFilter().table.schema;i.tuples=[];var t=this.domResults.firstChild,c=this.domResults.childNodes.length,r,u=this.get_qf().get_oFilter().table.tuples;if(this.get_qf().isSingleSelect()){for(o=0;o<c;o++,t=t.nextSibling)if(n.filterItem.isChecked(t)){for(r=n.filterItem.getIndex(t),this.recordCheckedChanges(i,t,u[r]),f=0;f<u.length;++f)f!==r&&(u[f].s=!1);break}}else{for(s=[],h=0;h<c;h++,t=t.nextSibling)r=n.filterItem.getIndex(t),this.recordCheckedChanges(i,t,u[r]),s[r]=1;for(t=this.get_qf().get_domContent().firstChild,n.filterItem.isAllItem(t)&&(t=t.nextSibling),l=u.length,e=0;e<l;e++,t=t.nextSibling)s[e]===0&&this.recordCheckedChanges(i,t,u[e])}return i},applyChangesHierOrTypeIn:function(){var n={},t,r,i,u;if(n.schema=this.get_oResults().schema,n.tuples=[],t=this.domResults.firstChild,ss.isNullOrUndefined(t))return n;for(r=this.get_oResults().tuples,i=0,u=r.length;i<u;i++,t=t.nextSibling)this.recordCheckedChanges(n,t,r[i]);return n},onManualAddSuccess:function(n){var s=tableau.format.escapeHTML,i=n.invalidTuples,r=i.length,t,f,o,u,h,e;if(ss.isNullOrUndefined(n)||ss.isNullOrUndefined(n.invalidTuples)||ss.isNullOrUndefined(n.totalTuples))return!1;if(r>0){if(t=[],r===1)t.push(s(tab.Strings.QuickFilterSearchInvalidDataMemberSingular(i[0].t[0].v))),t.push("<br/>");else for(t.push(s(tab.Strings.QuickFilterSearchInvalidDataMembersPlural)),t.push("<br/>"),f=0;f<r;f++)t.push("&nbsp;&nbsp;&nbsp;&nbsp;&bull;&nbsp;"),t.push(i[f].t[0].v),t.push("<br/>");for(tab.Application.get_commonDialogProvider().showAlertDialog(t.join(""),tab.Strings.QuickFilterSearchInvalidDataMembersDialogTitle,!0,null),o=[],u=0;u<r;u++)h=i[u].t[0].v,o.push({d:h,s:!1,t:i[u].t});e={};e.schema=this.get_qf().get_oFilter().table.schema;e.tuples=o;this.notifyParentFilterOfChanged(e,!0,!0)}return n.totalTuples>r},updateStateIfNeeded:function(){},handleClickIfPending:function(){},clearRangeAnchorAndSelection:function(){this.$8.clearRangeAnchorAndSelection()},forEachSelected:function(n){this.$8.forEachSelected(n)},onListItemClick:function(n){this.$8.onListItemClick(n)},handleItemClick:function(){},recordCheckedChanges:function(t,i,r){n.filterItem.isChecked(i)&&!r.s?t.tuples.push(n.filterItem.setChecked(i,!0,r)):!n.filterItem.isChecked(i)&&r.s&&t.tuples.push(n.filterItem.setChecked(i,!1,r))}},e,[vi]);ss.initClass(vu,t,{createListElement:function(t,i,r,u){var f=$(t),e,o;if(this.shouldUseAllItem()&&i.length>0&&p.addAllItem(f,this.parent,r,u,!1,ss.mkdel(n.filterItem,n.filterItem.formatDropdownListFilterItemHtml)),ss.isValue(this.tiledWidget)&&this.tiledWidget.destroy(),this.tiledWidget=d.createSimpleList(this.parent,i,t,r,this.get_lineHeight()),e=spiff.EventUtil.bindWithDispose(f,"click",ss.mkdel(this,this.$n)),this.disposables.add$1(e),o=spiff.EventUtil.bindWithDispose(f,"touchend",ss.mkdel(this,this.$n)),this.disposables.add$1(o),tab.FeatureFlags.isEnabled("AccessibilityDropdownFilters"))f.on("keyup",ss.mkdel(this,this.$m));else f.on("keydown",ss.mkdel(this,this.$l));f.parent().toggleClass("CFDropdownNoItems",i.length===0);i.length===0&&f.text(tab.Strings.QuickFilterNoItems)},$n:function(t){var u=n.filterItem.getNodeFromEvent(t),i,r;if(!!u){if(i=n.filterItem.getIndex(u),i===-1&&!this.parent.get_oFilter().all){this.parent.doSelectAll(!0);this.hideMenu();return}if(i!==this.currentlySelected){if(i>=this.parent.get_oFilter().table.actual_size||i<0){this.hideMenu();return}this.parent.set_stateId(this.parent.get_stateId()+1);r=[];r.push(i);tab.FilterClientCommands.setCategoricalFilterValuesByIndex(this.parent.get_session().get_visualId(),this.parent.get_field(),"filter-replace",r)}this.hideMenu()}},$l:function(t){switch(t.which){case 40:case 38:this.$o(n.filterItem.getNodeFromEvent(t),t.which===38);t.preventDefault();break;case 9:t.preventDefault();break;case 13:this.$n(t)}},$m:function(n){switch(n.which){case 13:case 32:this.$n(n);break;default:return}n.preventDefault();n.stopPropagation()},$o:function(n,t){for(var r=this.menuNode.find(".FIItem"),i=0,u=r.length;i<u;i++)if(ss.referenceEquals(r.eq(i).get(0).getAttribute("id"),n.getAttribute("id"))){t||i===u-1?t&&i!==0?r.eq(i-1).focus():t&&i===0&&this.menuNode.find(".QueryBox").eq(0).get(0).focus():r.eq(i+1).focus();return}}},h,[ss.IDisposable]);ss.initClass(yt,t,{get_oneLineLayout:function(){return this.$s},$a:function(n){return this.$f[n[0]]!=="false"&&this.$f[n[1]]!=="true"},calculateStyleid:function(){this.styleid=0;this.$a(this.$t)||(this.styleid+=4);this.$a(this.$x)||(this.styleid+=2);this.$a(this.$e)||(this.styleid+=1);this.styleid>5&&(this.styleid=3)},dispose:function(){this.$h.dispose()},destroy:function(){dojo.unsubscribe(this.$z);dojo.unsubscribe(this.$A);this.$5();this.dispose();ss.isValue(this.$E)&&(this.$E.domNode.parentNode.removeChild(this.$E.domNode),this.$E=null);ss.isValue(this.slider)&&typeof this.slider.destroy=="function"&&this.slider.destroy();ss.isValue(this.$y)&&typeof this.$y.destroy=="function"&&this.$y.destroy()},instantiateFromDomain:function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r[i]={d:n[i],s:ss.referenceEquals(t,n[i]),t:[]};this.instantiateFromTuples(r,null)},instantiateFromTuples:function(n,t){var i=-1,u=tab.Strings.QuickFilterUnknown,f=null,e,r;if(n.length>0)for(e=n.length,r=0;r<e;r++)n[r].s&&!this.$n&&(i>-1?u=tab.Strings.QuickFilterMultipleValues:(i=r,u=this.$l(r)));i<0&&(i=0,ss.isValue(t)&&(u=t));this.$w&&(f=this.$k(i));this.instantiate$1(n.length,i,u,f)},instantiate:function(n,t,i){this.instantiate$1(n,t,i,null)},instantiate$1:function(n,t,i,r){var e=null,f,s,u,h,o;(this.currentlySelected=t,this.calculateStyleid(),this.$a(this.$t)&&(this.readout=document.createElement("div"),this.readout.classList.add("sliderTextReadout"),this.readout.classList.add("tab-ctrl-formatted-widget"),this.readout.classList.add("tab-ctrl-formatted-fixedsize"),this.$B=document.createElement("div"),this.$B.classList.add("sliderText"),this.$B.innerHTML=tableau.format.escapeHTML(i),this.$w&&(this.$j=document.createElement("div"),this.$j.className="facet",this.$j.innerHTML=tableau.format.escapeHTML(r),this.readout.appendChild(this.$j)),this.readout.appendChild(this.$B),this.div.appendChild(this.readout)),this.styleid!==3)&&(f=document.createElement("div"),this.$a(this.$x)&&(e=document.createElement("div"),f.appendChild(e)),this.div.appendChild(f),(!ss.isValue(n)||ss.unbox(n)<1)&&(n=1),this.$o=!isFinite(ss.unbox(n)),this.$a(this.$x)&&ss.Nullable$1.lt(n,1200)&&this.$a(this.$C)&&(s=ss.mkdict(["count",n]),this.$y=new dijit.form.HorizontalRule(s,e)),u={templateString:"<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>",onChange:ss.mkdel(this,this.$1),value:this.currentlySelected,slideDuration:0,intermediateChanges:!0,showButtons:this.$a(this.$e),pageIncrement:1},isFinite(ss.unbox(n))&&(u.minimum=0,u.maximum=ss.unbox(n)-1,u.discreteValues=ss.unbox(n)),this.slider=new dijit.form.HorizontalSlider(u,f),this.$z=dojo.subscribe("/dnd/move/start",ss.mkdel(this,this.startDrag)),this.$A=dojo.subscribe("/dnd/move/stop",ss.mkdel(this,this.stopDrag)),this.slider.startup(),ss.isValue(this.$y)&&this.$y.startup(),this.$v=!1,this.$a(this.$t)||(this.$F=document.createElement("div"),this.slider.sliderHandle.appendChild(this.$F),h=dijit._MasterTooltip.prototype,h.templateString="<div class='dijitTooltip dijitTooltipLeft' id='dojoTooltip'><div class='dijitTooltipContainer' dojoAttachpoint='coreArea'><div class='dijitTooltipContents' dojoAttachPoint='containerNode' waiRole='alert'><\/div><\/div><div class='dijitTooltipConnector'><\/div><\/div>",this.$E=new dijit._MasterTooltip,this.$E.dojoOrient=this.$E.orient,this.$E.orient=ss.mkdel(this,function(n,t,i,r){this.$E.dojoOrient(n,t,i,r);$(this.$E.domNode).addClass("sliderThumbTooltip")}),o=$(this.slider.sliderHandle),this.$h.add$1(spiff.EventUtil.bindWithDispose(o,"mouseenter",ss.mkdel(this,this.$7))),this.$h.add$1(spiff.EventUtil.bindWithDispose(o,"mouseleave",ss.mkdel(this,this.$6)))),this.$q=this.slider.decrementButton.childNodes[0],this.$u=this.slider.incrementButton.childNodes[0],this.$0(),this.$c(),this.$4())},$0:function(){var n=new spiff.TableauEventHandler.$ctor1(this.slider.sliderHandle,{}),t=new spiff.TableauEventHandler.$ctor1(this.$q,{}),i=new spiff.TableauEventHandler.$ctor1(this.$u,{});this.$h.add$1(n);this.$h.add$1(t);this.$h.add$1(i)},$c:function(){this.$8(this.$q,"Left",this.currentlySelected===0);ss.isValue(this.slider)&&this.$8(this.$u,"Right",this.currentlySelected===this.slider.maximum)},$8:function(n,t,i){var r=$(n);r.removeClass("cp"+t+"Arrow"+(i?"Black":"Grey"));r.addClass("cp"+t+"Arrow"+(i?"Grey":"Black"))},setNewState:function(n){this.currentlySelected=n;ss.isValue(this.slider)&&this.slider._setValueAttr(this.currentlySelected)},startDrag:function(n){ss.isValue(this.slider)&&ss.isValue(n)&&ss.referenceEquals(n.node,this.slider.sliderHandle)&&(this.$p=!0,this.$D>0&&this.$5())},stopDrag:function(n){ss.isValue(this.slider)&&ss.isValue(n)&&ss.referenceEquals(n.node,this.slider.sliderHandle)&&(this.$p=!1,this.$D>0&&this.$5(),this.$9(),this.$2())},$7:function(){this.$a(this.$t)||(this.$G=tab.MiscUtil.clearTimeout(this.$G),this.$v=!0,this.$G=window.setTimeout(ss.mkdel(this,this.$2),50))},$6:function(){this.$G=tab.MiscUtil.clearTimeout(this.$G);ss.isValue(this.$E)&&this.$E.hide(this.$F);this.$v=!1},$2:function(){var n,t,i;this.$a(this.$t)||(this.$E.hide(this.$F),(this.$v||this.$p)&&(n=this.$g,ss.isNullOrUndefined(n)&&(n=ss.Int32.trunc(this.currentlySelected)),t=n,i=this.$l(t),this.$E.show(i,this.$F,["above","below"])))},$3:function(){var n;return!ss.isValue(this.$g)||isNaN(ss.unbox(this.$g))?0:(n=this.$o?ss.unbox(this.$g):parseInt(ss.unbox(this.$g).toString(),10),n<0&&(n=0),n)},$d:function(){if(!ss.isNullOrUndefined(this.$g)&&!ss.isNullOrUndefined(this.currentlySelected)&&this.$g!==this.currentlySelected){var n=this.$3();ss.isValue(this.$i)&&this.$i(n);this.$g=n;this.currentlySelected=n;this.$c()}},updateReadout:function(n){this.updateReadout$1(n,null)},updateReadout$1:function(n,t){this.styleid<4&&(this.$B.innerHTML=n,this.$w&&(this.$j.innerHTML=t))},$1:function(n){if(!isNaN(n)){var t=this.$w?this.$k(n):null;this.updateReadout$1(this.$l(n),t);this.$g=n;ss.isValue(this.$r)&&this.$r();this.$p?this.$D>0&&this.$5():(this.$D>0&&this.$5(),this.$9());this.$2()}},$4:function(){this.$a(this.$e)||this.div.classList.add("HideArrows");this.$a(this.$x)||this.div.classList.add("HideSlider");this.styleid>3&&$(this.div).css("height","15px")},$9:function(){this.$D=window.setTimeout(ss.mkdel(this,this.$b),500)},$5:function(){this.$D>0&&(window.clearTimeout(this.$D),this.$D=-1)},$b:function(){this.$d()},layout:function(){var t=0,r,u,n,i;(this.$s=!1,r=$(this.div),r.css("overflow","hidden"),u=dojo.marginBox(this.div).h,n=parseFloat(r.css("width"))-5,r.css("overflow",""),n<34)||(ss.isValue(this.readout)&&($(this.readout).css("width",""),$(this.readout).css("float","none")),ss.isValue(this.slider)&&($(this.slider.tableauSlider).css("width",""),$(this.slider.tableauSlider).css("float","none")),ss.isValue(this.$y)&&this.$y.count*4>n&&$(this.$y.domNode).css("display","none"),u<38&&this.styleid<=1?(i=this.styleid===0?n-34:n,i=Math.floor((i-14)/2),$(this.readout).css("width",i+"px"),ss.isValue(this.slider)&&$(this.slider.tableauSlider).css("width",i+"px"),$(this.readout).css("float","left"),ss.isValue(this.slider)&&$(this.slider.tableauSlider).css("float","left"),this.$s=!0):(this.styleid===0||this.styleid===4)&&ss.isValue(this.slider)?$(this.slider.tableauSlider).css("width",n-34+"px"):(this.styleid===1||this.styleid===5)&&ss.isValue(this.slider)?$(this.slider.tableauSlider).css("width",n+"px"):this.styleid===2&&$(this.readout).css("width",n-38+"px"),this.$a(this.$e)&&((this.styleid===2||this.styleid===4)&&(t=1),this.styleid===0&&(t=this.$s?1:20),t+=this.$m(),ss.isValue(this.slider)&&($(this.slider.incrementButton).css("top",t+"px"),$(this.slider.decrementButton).css("top",t+"px"))))}},null,[tab.ISlider,ss.IDisposable]);ss.initClass(yu,t,{instantiate:function(t,i,r){this.$3=t;var u=n.isAllOrAllChecked(this.parent);this.shouldUseAllItem()?this.$3=n.addAllItemToTuples(this.$3,u,r):u=!1;this.$4=new tableau.base.widget.ui.Slider(this.div,this.attributes,u,ss.mkdel(this,this.updateViz),ss.mkdel(this.parent,this.parent.getTitleOffset),ss.mkdel(this,this.getCurrentText),ss.mkdel(this,this.onIntermediateChange),ss.mkdel(this,this.getCurrentFacet),this.parent.get_oFilter().showFacets);this.$4.instantiateFromTuples(this.$3,this.getSummaryText())},destroy:function(){this.$4.destroy()},layout:function(){this.inherited(arguments);this.$4.layout()},showOrHide:function(n,t){n.style.display=t?"":"none"},onSmallSearchUI:function(n,t){var r=!n,i=this.$4;(i.styleid===2||i.styleid===4)&&(this.showOrHide(i.slider.decrementButton,r),this.showOrHide(i.slider.incrementButton,r));i.styleid===3?(this.showOrHide(i.div,r),t.style.marginBottom="2px"):i.styleid<3?(this.showOrHide(i.readout,r),i.get_oneLineLayout()&&this.showOrHide(i.div,r)):this.showOrHide(i.slider.tableauSlider,r)},getRealIndex:function(n){if(typeof n=="undefined"||isNaN(n))return 0;var t=parseInt(n.toString(),10);return t<0&&(t=0),t},updateViz:function(n){var i={},u;i.schema=this.parent.get_oFilter().table.schema;i.tuples=[];var f=i,t=this.getRealIndex(n),r=new Array(0);if(this.shouldUseAllItem()&&t===0){this.parent.doSelectAll(!0);return}this.$3[t].s=!0;f.tuples.push(this.$3[t]);this.parent.set_stateId(this.parent.get_stateId()+1);u=this.$3[t].d||this.$3[t].t[0].v;r.push(u);tab.FilterClientCommands.setCategoricalFilterValues(this.parent.get_session().get_visualId(),this.parent.get_field(),"filter-replace",r,null)},onIntermediateChange:function(){this.parent.get_searchWidget().get_isVisible()&&this.parent.get_searchWidget().toggleUI()},getCurrentText:function(n){var t=this.getRealIndex(n),i=this.$3[t];return tableau.format.formatTupleDisplayName(i,!0,this.parent.get_oFilter().role)},getCurrentFacet:function(n){var t=this.getRealIndex(n),i=this.$3[t];return tableau.format.formatTupleDisplayFacet(i,!0,this.parent.get_oFilter().role)}},l,[ss.IDisposable]);ss.initClass(pu,t,{get_applyDelay:function(){return window.alert(tab.Strings.noLoc("Bad call of ApplyDelay on SmallSearchWidget")),0},startup:function(){var n,t;this.inherited(arguments);n={};n.store=null;n.autoComplete=!1;n.hasDownArrow=!1;n.highlightMatch="none";n.searchDelay=this.searchDelay;n.onChange=ss.mkdel(this,this.applyChanges);n.onKeyDown=ss.mkdel(this,this.onQueryBoxKeyDown);this.autocompleter=new dijit.form.ComboBox(n,this.domAutocompleter);this.autocompleter.startup();this.autocompleter._getQueryString=function(n){var i=n.length,t;return i<1?"":n.charCodeAt(0)===39&&n.charCodeAt(i-1)===39?n.substr(1,i-2):(t=n,t.length>1&&t.charCodeAt(0)===92&&t.charCodeAt(1)===42&&(t="*"+t.substr(2)),t.length>1&&t.charCodeAt(t.length-2)===92&&t.charCodeAt(t.length-1)===42&&(t=t.substr(0,t.length-2)+"*"),t.charCodeAt(0)!==42&&t.charCodeAt(t.length-1)!==42&&(t="*"+t+"*"),t)};t=this.NO_MATCHES;this.autocompleter.DOJO_openResultList=this.autocompleter._openResultList;this.autocompleter._openResultList=ss.mkdel(this,function(n,i){this.resultCount=n.length;this.autocompleter.DOJO_openResultList(n,i);!n.length?(this.autocompleter.tooltipPosition=["above","below"],this.autocompleter.displayMessage(t)):dijit.hideTooltip(this.autocompleter.domNode);tab.BrowserSupport.get_isIE()&&this.focusQueryBox()})},getOnQueryBoxKeyDownBehavior:function(n){var t,i,r;t=this.inherited(arguments);switch(n.keyCode){case 13:t.functionToCall=null;t.stopEvent=!1;break;case 40:t.functionToCall=null;t.stopEvent=!1;tab.BrowserSupport.get_isIE()&&(i=this.$1(),i.attr("tabindex","1").keydown(ss.mkdel(this,this.$2)),i.eq(0).get(0).focus(),r=$(this.domNode.parentElement),r.find("input").eq(0).val(i.eq(0).html()),t.stopEvent=!0);$(n.target).hasClass("dijitReset")||(t.stopEvent=!0);break;case 37:case 39:case 38:t.functionToCall=null;t.stopEvent=!1;break;default:t.functionToCall=ss.mkdel(this,this.onSmallSearchKeyDown);t.stopEvent=!1}return t},onSmallSearchKeyDown:function(){this.autocompleter._startSearchFromInput()},$2:function(n){switch(n.which){case 40:case 38:this.$3(n.currentTarget,n.which===38);n.preventDefault();break;case 9:n.preventDefault();break;case 13:this.applyChanges($(this.domNode).find("input").val())}},$3:function(n,t){for(var r,e,o,u=this.$1(),i=0,f=u.length;i<f;i++)if(ss.referenceEquals(u.eq(i).get(0).getAttribute("id"),n.getAttribute("id"))){if(r=null,t||i===f-1){if(t&&i!==0)r=u.eq(i-1);else if(t&&i===0){e=$(this.domNode.parentElement);e.find("input").eq(0).get(0).focus();return}}else r=u.eq(i+1);ss.isValue(r)&&(r.focus(),o=$(this.domNode.parentElement),o.find("input").eq(0).val(r.html()));return}},$1:function(){return $(".dijitPopup .dijitMenu li.dijitReset")},getDataStore:function(){for(var t=[],r=this.get_qf().get_oFilter().table.tuples,n=0,i=r.length;n<i;n++)t.push(ss.mkdict(["name",this.formatTuple(r[n])]));return new dojo.data.ItemFileWriteStore(ss.mkdict(["data",ss.mkdict(["items",t])]))},destroy:function(){this.domSearchBox.innerHTML="";this.autocompleter.destroy();this.autocompleter=null;this.inherited(arguments)},focusQueryBox:function(){this.autocompleter.focus()},getQuery:function(){return this.autocompleter.attr("value")},setQuery:function(n){this.autocompleter.attr("value",n)},fixQueryWidth:function(){var t=dojo.marginBox(this.domNode).w,n;t>25&&(n=ss.mkdict(["w",t-25]),dojo.marginBox(this.autocompleter.comboNode,n),dojo.marginBox(this.autocompleter.comboNode.firstChild,n),dojo.marginBox(this.autocompleter.textbox,n));this.autocompleter.comboNode.style.cssFloat="left"},showUI:function(n){if(!this.get_isVisible()){e.prototype.showUI.call(this,n);this.get_qf().get_modeContents().onSmallSearchUI(!0,this.domNode)}},hideUI:function(){if(this.get_isVisible()){e.prototype.hideUI.call(this);this.get_qf().get_modeContents().onSmallSearchUI(!1,this.domNode)}},layout:function(){this.fixQueryWidth()},updateSearch:function(){this.autocompleter.store=this.getDataStore();this.get_qf().get_modeContents().onSmallSearchUI(this.get_isVisible(),this.domNode)},applyChanges:function(n){var r,i,t,u,f,e;if(!!n){for(r=[],i=this.get_qf().get_oFilter().table.tuples,t=0,u=i.length;t<u;t++)ss.referenceEquals(n,this.formatTuple(i[t]))?(r.push(i[t]),i[t].s=!0):i[t].s&&delete i[t].s;if(r.length!==0){this.get_qf().updateStateFromSearch(null);f=r[0].d||r[0].t[0].v;e=[f];tab.FilterClientCommands.setCategoricalFilterValues(this.get_qf().get_session().get_visualId(),this.get_qf().get_field(),"filter-replace",e,null);this.clearSearch(!1,!0);this.onXButtonClick(null)}}}},e);ss.initClass(w,t,{get_widgetDomNode:function(){return this.domNode},startup:function(){$(this._leftBtn.domNode).find("button").addClass("tnLeftButton");$(this._rightBtn.domNode).find("button").addClass("tnRightButton");$(this._menuBtn.domNode).find("button").addClass("tnMenuButton");this.containerNode=this.domNode;this.inherited(arguments)},destroy:function(){var n,t;for(tab.MiscUtil.dispose$1(this.$p),n=0;n<this.$l.length;n++)t=this.$l[n],t.destroyRecursive();this.$m.dispose();this.inherited(arguments)},layout:function(n){if(this.$o.length!==0){var i=dojo.contentBox(this._containerNode.domNode),t=this.$i(i.w);this._buttons.css("display",t?"":"none");this._innerWrapper.layout(n);this._containerNode.domNode.style.top="-1px";this._rightBtn.domNode.style.height="auto";t||(this._containerNode.domNode.scrollLeft=0);this.$a(this.currentTab);this.$j();this.$f();tabBootstrap.VizLayoutConstants.get_shouldShowTabs()?($(".tabbedNavigationWrapper").css("visibility","visible"),$(".tabbedNavigationOuterWrapper").css("display","")):$(".tabbedNavigationOuterWrapper").css("display","none")}},postCreate:function(){var n,t;for(tab.Application.add_onTabSelect(ss.mkdel(this,this.$d)),tab.CommandController.get().add_newLayoutId(ss.mkdel(this,this.$b)),this.$m.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){tab.Application.remove_onTabSelect(ss.mkdel(this,this.$d));tab.CommandController.get().remove_newLayoutId(ss.mkdel(this,this.$b))}))),this.inherited(arguments),this.$0(),this.$n=[],n=0;n<this.$o.length;n++)t=this.$o[n],this.addTab(t,n,tsConfig.repository_urls[n]),this.addToMenu(this.$n,t);this._buttons=$(this.domNode).find(".dijitButton");this.layout(null);this.$k=this.selectedTabArrayIndex;this.currentTab=this.$l[this.selectedTabArrayIndex];ss.isValue(this.currentTab)&&w.$1(this.currentTab.domNode,!0)},chooseTabByName:function(n){if(!ss.isNullOrUndefined(n)){var t=this.$3(n);ss.isValue(t)&&this.chooseTab(t)}},chooseTab:function(n){ss.isNullOrUndefined(n)||this.$1(n)},addTab:function(n,t,i){var e=document.createElement("span"),u,r;this._scrollNode.appendChild(e);u=this.baseClass+"_tab_"+t;r={};r.id=u;r.label=tableau.format.escapeHTML(n);r.value=n;r.showLabel=!0;r.repository_url=i;r.onKeyDown=ss.mkdel(this,function(n){switch(n.keyCode){case 13:case 32:this.$h(u);spiff.EventUtil.stopEvent(n);break;case 39:case 40:this.$4();spiff.EventUtil.stopEvent(n);break;case 37:case 38:this.$5();spiff.EventUtil.stopEvent(n);break;case 9:var i=this._indexOf(this.$o,tsConfig.current_sheet_name),t=i;ss.isNullOrUndefined(t)&&(t=this.selectedTabArrayIndex);this.$k=t}});var f=new dijit.layout._TabButton(r,e),o={tap:ss.mkdel(this,function(){this.$h(u)})},s=new spiff.TableauEventHandler.$ctor1(f.domNode,o);this.$m.add$1(s);w.$2(f);this.$l.push(f)},addToMenu:function(n,t){var i=spiff.MenuItem.newActionItem(t,ss.mkdel(this,function(){this.chooseTabByName(t)}),!0,"");n.push(i)},resize$1:function(){this._innerWrapper.resize();this.layout(null)},$e:function(n){var t=this.$3(n);this.$a(t)},$d:function(n){this.$e(n.sheetName)},$b:function(n){this.$e(n.sheetName)},$3:function(n){for(var t=0;t<this.$l.length;t++)if(ss.referenceEquals(this.$l[t].value,n))return this.$l[t];return null},$4:function(){this.$k++;this.$k>this.$l.length-1&&(this.$k=0);var n=this.$6(),t=dijit.byId(n);t.domNode.focus();this.$j()},$5:function(){this.$k--;this.$k<0&&(this.$k=this.$l.length-1);var n=this.$6(),t=dijit.byId(n);t.domNode.focus();this.$j()},$6:function(){return this.baseClass+"_tab_"+this.$k},$h:function(n){var t=dijit.byId(n);this.chooseTab(t)},$9:function(){var n=$(this._scrollNode).find(".dijitTab"),i,t;return n.length?(i=n[0],t=n[n.length-1],t.offsetLeft+parseFloat($(t).css("width"))-i.offsetLeft):0},$i:function(n){var t=this.$9();return t>0&&n<t},_indexOf:function(n,t){for(var i=0;i<n.length;i++)if(ss.referenceEquals(n[i],t))return i;return-1},_indexOf:function(n,t){for(var i=0;i<n.length;i++)if(ss.referenceEquals(n[i],t))return i;return-1},$7:function(){var n=$(this._scrollNode).find(".dijitTab"),i=this._containerNode.domNode.offsetWidth,r=this.$9(),t={};return!!n.length&&r>i?(t.min=0,t.max=n[n.length-1].offsetLeft+parseFloat($(n[n.length-1]).css("width"))+2-i):(t.min=0,t.max=0),t},$1:function(n){if(!ss.isValue(this.currentTab)||!ss.referenceEquals(this.currentTab.value,n.value)){ss.isValue(this.currentTab)&&(this.currentTab.attr("checked",!1),w.$1(this.currentTab.domNode,!1));this.$k=this._indexOf(this.$l,n);var t={};t.sheetName=n.value;t.repositoryUrl=n.repository_url;t.oldRepositoryUrl=ss.isValue(this.currentTab)?this.currentTab.repository_url:null;tab.Application.fireOnTabSelect(t)}},$a:function(n){(ss.isValue(this.currentTab)?(this.currentTab.attr("checked",!1),w.$1(this.currentTab.domNode,!1)):n=this.currentTab=this.$l[this.selectedTabArrayIndex],ss.isNullOrUndefined(n))||(n.attr("checked",!0),w.$1(n.domNode,!0),this.currentTab=n,this.$g(n))},$g:function(n){var t=n.domNode,i=this._getScroll();(i>t.offsetLeft||i+parseFloat($(this._containerNode.domNode).css("width"))<t.offsetLeft+parseFloat($(t).css("width")))&&this._createSmoothScroll(n).play()},$8:function(n){var t=n.domNode,u=parseFloat($(this._containerNode.domNode).css("width")),i=this.$7(),r;return r=t.offsetLeft+parseFloat($(t).css("width"))/2-u/2,Math.min(Math.max(r,i.min),i.max)},$0:function(){this.connect(this._rightBtn,"onClick",ss.mkdel(this,function(){this.$c(this._rightBtn)}));this.connect(this._leftBtn,"onClick",ss.mkdel(this,function(){this.$c(this._leftBtn)}));this.connect(this._menuBtn,"onClick",ss.mkdel(this,this.onMenuButtonClicked))},onMenuButtonClicked:function(){ss.isValue(this.$p)&&this.$p.dispose();this.$p=spiff.MenuViewModel.createForMenu(new spiff.Menu(this.$n),spiff.MenuViewModel.handleMenuActionItemClicked);this.$p.show(new spiff.ShowMenuOptions($(this._menuBtn.domNode),!1))},$c:function(n){n.dojoAttachPoint==="_leftBtn"?this.$2(-1):this.$2(1);n.domNode.focus()},$2:function(n){var t=parseFloat($(this._containerNode.domNode).css("width")),i=t*.5*n,r=this._getScroll()+i;this._createSmoothScroll(null,r).play()},_getScroll:function(){return this._containerNode.domNode.scrollLeft},_createSmoothScroll:function(n,t){var u,r,i;return ss.isValue(n)?t=this.$8(n):(u=this.$7(),t=Math.min(Math.max(t,u.min),u.max)),ss.isValue(this._anim)&&this._anim.status()==="playing"&&this._anim.stop(),r=null,i={},i.duration=100,i.beforeBegin=ss.mkdel(this,function(){var n=this._containerNode.domNode.scrollLeft;r.curve=new dojo._Line(n,t)}),i.onAnimate=ss.mkdel(this,function(n){this._containerNode.domNode.scrollLeft=n}),i.onEnd=ss.mkdel(this,function(){this.$j()}),r=new dojo._Animation(i),this._anim=r,r},$j:function(){var r=this._getScroll(),n=this.$7(),t,i;r>n.max&&(this._containerNode.domNode.scrollLeft=tab.DoubleUtil.roundToInt(n.max));i=r>=ss.Int32.trunc(n.max);t=r<=ss.Int32.trunc(n.min);this._rightBtn.setAttribute("disabled",i);this._leftBtn.setAttribute("disabled",t);$(this._rightBtn.domNode).find("button").toggleClass("tnRightButtonDisabled",i);$(this._leftBtn.domNode).find("button").toggleClass("tnLeftButtonDisabled",t);w.$0(this._rightBtn.domNode,tab.Strings.AccessibilityScrollSheetTabsRight,i);w.$0(this._leftBtn.domNode,tab.Strings.AccessibilityScrollSheetTabsLeft,t)},$f:function(){$(this._menuBtn.domNode).find("button")[0].tabIndex=-1;this._menuBtn.domNode.tabIndex=-1;this._menuBtn.domNode.setAttribute("aria-disabled","true")},startupShim:function(){this.startup()},resizeShim:function(){this.resize$1()},destroyShim:function(){this.destroy()}},Object,[tab.ITabbedNavigation]);ss.initClass(wu,t,{destroy:function(){this.$9.remove_scrolled(ss.mkdel(this,this.$2));this.$9.destroy();this.$9=null;this.$5.remove_contentFetched(ss.mkdel(this,this.$1));this.$5.destroy();this.$5=null;this.$7.destroy();this.$7=null;this.$6.destroy();this.$6=null},updateViewport:function(n,t){this.$7.updateViewport(n,t)},getElement:function(n){var t=this.$7.itemToTileIndex(n),i;return this.$7.getTileStatus(t)?(i=this.$7.globalToLocalItemIndex(n),this.$9.getItemElement(t,i)):null},$4:function(n,t){var i=this.$6.format(t,this.$7.getTilePosition(n),this.$7.getTileRange(n));i.length!==0&&(this.$9.setContent(n,i),this.$7.updateTileStatus(n,!0))},$0:function(n){var t=this.$7.getTileRangeType(n),i=this.$7.getTileRange(n);return new hr(n,i,t)},$3:function(){for(var i,t=[],r=this.$7.get_tileCount(),n=1;n<r;++n)i=this.$0(n),t.push(i);this.$5.fetch(t)},$2:function(n,t){var f=this.$8*this.$7.get_itemHeight(),u=t.get_newPos().y-f,r,i,s;u<0&&(u=0);r=t.get_newPos().y+f+this.$7.get_viewportHeight();r>this.$7.get_totalHeight()-1&&(r=this.$7.get_totalHeight()-1);var h=new tab.IntegerRange(u,r),e=this.$7.pixelToTileRange(h),o=[],c=e.get_from(),l=e.get_to();for(i=c;i<=l;++i)this.$7.getTileStatus(i)||this.$5.isTilePending(i)||(s=this.$0(i),o.push(s));this.$5.fetch(o)},$1:function(n,t){var i=t.get_tileIndex(),r=t.get_data();this.$4(i,r)}});ss.initClass(d,t,{});ss.initClass(bu,t,{add_notifyChangeCalled:function(n){this.$3$1=ss.delegateCombine(this.$3$1,n)},remove_notifyChangeCalled:function(n){this.$3$1=ss.delegateRemove(this.$3$1,n)},_createTreeNode:function(n){n.isChecked=this.model.isChecked(n.item);var t=new tableau.base.widget.hsm._TreeNode(n);return n.item.node=t,t},$0:function(n){return this.model.mayHaveChildren(n)},getIconClass:function(){return"HFTreeNodeIcon"},getLabelClass:function(n){var t=this.model.isSingleSelect?"HFTreeNodeLabelSS":"HFTreeNodeLabel";return t+(n.isRaggedOrSkipped?" HFTreeNodeRaggedOrSkipped":"")},focusNode:function(n){var t=$(n.labelNode),i=t.attr("tabindex");!i||t.removeAttr("tabindex");this.inherited(arguments);!i||t.attr("tabindex",i)},notifyChange:function(n){ss.isValue(this.$3$1)&&this.$3$1(n)},getDepth:function(n){for(var t=0;!ss.referenceEquals(n,this.rootNode);)t+=1,n=n.getParent();return t},findEarlierNode:function(n,t,i){return this.rEarlierContained(this.rootNode,0,n,t,i)},rEarlierContained:function(n,t,i,r,u){var e,s,f,o;if(t>u)return null;if(t<u){for(e=n.getChildren(),s=e.length,f=0;f<s;f++)if(o=this.rEarlierContained(e[f],t+1,i,r,u),ss.isValue(o))return o}else return ss.referenceEquals(n,i)?i:ss.referenceEquals(n,r)?r:null;return null}},dijit.Tree);ss.initClass(ku,t,{dispose:function(){this.$1.dispose();this.$1=null},destroy:function(){this.dispose();this.inherited(arguments)},updateCheckState:function(){this.isChecked=this.tree.model.isChecked(this.item);var n=$(this.labelNode).find("input");n.prop("checked",this.isChecked)},setLabelNode:function(n){var i,t,r;this.isChecked=this.tree.model.isChecked(this.item);i=this.isChecked?" checked='checked'":"";t="<input type=";this.tree.model.isSingleSelect?(r=this.tree.model.field,ss.isValue(this.tree.model.session)&&(r+=this.tree.model.session.get_viewId()),t+="'radio' name='FI_"+r+"'"+i+"/><div class='fakeRadio'><\/div>"):t+="'checkbox'"+i+"/><div class='fakeCheckBox'><\/div>";t+="<a title='"+n+"'>"+n+"<\/a>";this.labelNode.innerHTML=t;ss.isValue(this.$1)&&this.$1.dispose();this.$1=new tab.DisposableHolder;this.$1.add$1(spiff.EventUtil.bindWithDispose($(this.labelNode.firstChild),"click",ss.mkdel(this,this.$0)))},$0:function(n){this.isChecked=this.labelNode.firstChild.checked;this.tree.notifyChange(n);n.stopPropagation()}},dijit._TreeNode,[ss.IDisposable]);ss.initClass(du,t,{$0:function(n){var t=n.t;if(tab.MiscUtil.isNullOrEmpty$2(t))return!1;var r=t[t.length-1],i=r.s;return ss.referenceEquals(i,"r")||ss.referenceEquals(i,"s")},itemsFromTable:function(n,t){var f=[],u=ss.isValue(n.table)?n.table.tuples:null,r,o,e,i;if(ss.isNullOrUndefined(n.table))return f;for(r=0;r<u.length;r++)o=tableau.format.formatTupleDisplayName(u[r]),e=null,!n.children||(e=this.itemsFromTable(n.children[r],t+1)),i={},i.id=tableau.format.formatTupleUniqueName(u[r]),i.schema=n.table.schema,i.tuple=u[r],i.label=o,i.level=t,i.children=e,i.isRaggedOrSkipped=this.$0(u[r]),f.push(i);return f},$1:function(n){var t=n.node;t.updateCheckState();ss.isValue(n.node2)&&n.node2.updateCheckState()},onChildrenChange:function(n,t){n.children=t},getIdentity:function(n){return n.id},getLabel:function(n){return n.label},isChecked:function(n){return n.tuple.s},mayHaveChildren:function(n){return n.level+1<this.levels},getRoot:function(n){n(this.root)},getChildren:function(n,t,i){if(ss.isValue(n.children)||ss.referenceEquals(n,this.root))t(n.children);else{var u=ss.mkdel(this,function(i){n.children=!i[0].table?null:this.itemsFromTable(i[0],n.level+1);t(n.children)}),r={};r.schema=n.schema;r.tuples=[n.tuple];this.session.requestHSMChildren(this.field,r,u,i)}},refresh:function(n){this.$2(this.root,n)},$2:function(n,t){tab.MiscUtil.isNullOrEmpty(n.children)||(this.$3(n.children,t[0].table),_.each(n.children,ss.mkdel(this,function(n,i){if(!!n.children)if(ss.isValue(t[0].children)&&i<t[0].children.length)this.$2(n,[t[0].children[i]]);else{var u=ss.mkdel(this,function(t){this.$2(n,t)}),r={};r.schema=n.schema;r.tuples=[n.tuple];this.session.requestHSMChildren(this.field,r,u,null)}})))},$3:function(n,t){for(var r=t.tuples,i=0;i<r.length;i++)n[i].tuple.s!==r[i].s&&(n[i].tuple.s=r[i].s,this.$1(n[i]));return n}});ss.initClass(b,t,{instantiate:function(n,t,i,r,u,f){var s,e,o;this.$m=n;this.$v=t;this.$l=i;this.$z=f;ss.isNullOrUndefined(this.$m)&&(this.$m="");this.div.innerHTML="<div id='typein_"+tableau.format.escapeHTML(t)+"' class='TypeInDiv tab-ctrl-formatted-border tab-ctrl-formatted-darker-border-hover'><span class='TypeInQuerySpan'><input type='text' class='QueryBox' value='"+tableau.format.escapeHTML(this.$m)+"'/><\/span><span class='goButton' style='display:none'><\/span><\/div>";this.outerDiv=this.div.firstChild;this.querySpan=this.outerDiv.childNodes[0];this.queryBox=this.querySpan.childNodes[0];this.goButton=this.outerDiv.childNodes[1];s=function(n){n.stopPropagation()};e=$(this.queryBox);this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"keydown",ss.mkdel(this,this.$a)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"keyup",ss.mkdel(this,this.$b)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"blur",ss.mkdel(this,this.onInputBlur)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"focus",ss.mkdel(this,this.onQueryBoxFocus)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"click",ss.mkdel(this,this.$c)));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"mousedown",s));this.$r.add$1(spiff.EventUtil.bindWithDispose(e,"mousemove",s));o=$(this.goButton);this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mousedown",ss.mkdel(this,this.$5)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"click",ss.mkdel(this,this.$4)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mouseenter",ss.mkdel(this,this.$8)));this.$r.add$1(spiff.EventUtil.bindWithDispose(o,"mouseleave",ss.mkdel(this,this.$9)));spiff.GlobalUIEvents.add_firstTouch(ss.mkdel(this,this.$7));this.$r.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){spiff.GlobalUIEvents.remove_firstTouch(ss.mkdel(this,this.$7))})));spiff.GlobalUIEvents.add_dismissTemporaryElements(ss.mkdel(this,this.$6));this.$r.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){spiff.GlobalUIEvents.remove_dismissTemporaryElements(ss.mkdel(this,this.$6))})));this.$w=!1;this.$e()},$7:function(n){this.isInsideWidget(n)||this.$0()},$6:function(){this.$0()},$0:function(){this.$d()&&(this.setNewPattern(),this.queryBox.blur())},isInsideWidget:function(n){return tab.DomUtil.isEqualOrAncestorOf(this.outerDiv,n.target)},destroy:function(){this.dispose()},dispose:function(){this.$r.dispose()},layout:function(){},editableValue:function(){return tableau.format.formatDataValue(this.$l,null,tableau.format.deriveNumberEditingFormat(this.$z),null,2)},setNewState:function(n,t,i){if(this.$m=n,this.queryBox.value=n,ss.isValue(i))this.$l=i;else if(ss.isValue(this.$l)){var r=this.$l;this.$l={};this.$l.s="n";this.$l.t=r.t}this.$h();this.$t=t||[];this.$q=""},$j:function(){return tab.LegacyFilterModel.isNormalValue(this.$l)&&!this.$o},$3:function(n,t){this.$q="";this.$o=!0;this.$t=n||[];this.$p=t;tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")&&$(this.queryBox).attr("aria-autocomplete","inline")},$f:function(n){this.clearTimeout();this.$n=window.setTimeout(n,500)},clearTimeout:function(){this.$n=tab.MiscUtil.clearTimeout(this.$n)},$k:function(){var t,i,n;if(this.$o&&!tab.MiscUtil.isNullOrEmpty$3(this.queryBox.value)){if(this.$q.toLowerCase().indexOf(this.queryBox.value.toLowerCase())===0){this.onAutocompleteDone(this.$q);return}if(this.$t.length>0){for(t=this.queryBox.value.toLowerCase(),i=this.$t.length,n=0;n<i;n++)if(this.$t[n].toLowerCase().indexOf(t)===0){this.onAutocompleteDone(this.$t[n]);return}}else ss.isValue(this.$p)&&this.$f(ss.mkdel(this,function(){this.$p(this.queryBox.value,ss.mkdel(this,this.onAutocompleteDone),this.$v)}))}},onAutocompleteDone:function(n){var t=n,i;tab.MiscUtil.isNullOrEmpty$3(t)||(this.$q=t,i=this.queryBox.value,this.queryBox.value=t,b.selectText(this.queryBox,i.length,t.length))},onQueryBoxFocus:function(){this.queryBox.isFocused=!0;this.$j()&&(this.queryBox.value=this.editableValue(),this.$u=!0)},$c:function(){this.queryBox.isFocused&&this.queryBox.select();this.queryBox.isFocused=!1},$8:function(){$(this.goButton).addClass("Hover")},$9:function(){$(this.goButton).removeClass("Hover")},$d:function(){return this.$u&&this.$j()?!ss.referenceEquals(this.editableValue(),this.queryBox.value):!ss.referenceEquals(this.$m,this.queryBox.value)},$i:function(){var n=this.$A==="TypeIn"?this.$d():!ss.isNullOrEmptyString(this.queryBox.value);n?this.$g():this.$h()},$g:function(){$(this.goButton).css("display","");$(this.goButton).addClass(this.$A+"Active");$(this.querySpan).addClass("ShortQuerySpan")},$h:function(){$(this.querySpan).removeClass("ShortQuerySpan");$(this.goButton).removeClass(this.$A+"Active");$(this.goButton).css("display","none")},onInputBlur:function(){this.queryBox.isFocused=!1;this.$w||this.$x||this.setNewPattern();this.$x=!1},$5:function(){this.$w=!0},$4:function(){this.$1();this.$w=!1},$2:function(n){this.$e();tab.BrowserSupport.get_isFF()&&window.setTimeout(ss.mkdel(this,this.$e),10);this.$i();spiff.EventUtil.stopEvent(n)},$a:function(n){n.which===27&&this.$2(n);this.$y=n.which},$b:function(n){switch(n.which){case 13:this.clearTimeout();this.setNewPattern();this.queryBox.blur();spiff.EventUtil.stopEvent(n);break;case 27:this.clearTimeout();this.$2(n);this.$x=!0;tab.FeatureFlags.isEnabled("AccessibilityTypeInFilters")||this.queryBox.blur();break;case 8:case 46:this.clearTimeout();this.$i();break;case 16:this.$i();break;default:this.$y===n.which&&(this.$k(),this.$i())}},setPattern:function(n){this.queryBox.value=n;this.clearTimeout();this.setNewPattern();this.queryBox.blur()},setNewPattern:function(){this.$d()?(this.$s(this.queryBox.value),this.$j()||this.setNewState(this.queryBox.value)):this.$j()&&this.$e();this.$u=!1},$e:function(){this.queryBox.value=this.$m;this.$u=!1;this.$i()},$1:function(){this.$A==="TypeIn"?(this.$e(),this.queryBox.blur()):(this.queryBox.value="",this.setNewPattern());this.$i()}},null,[ss.IDisposable]);ss.initClass(gu,t,{instantiate:function(n,t){this.$6=new tableau.base.widget.TypeInFilterContents(ss.mkdict(["parentFilter",this.parent,"tuples",n,"itemName",t,"role",this.parent.get_oFilter().role]));this.div.appendChild(this.$6.domNode);this.$6.startup();this.$5()},$5:function(){var n=ss.mkdel(this,function(n){var t=this.parent.get_searchWidget().domResults;tab.DomUtil.isEqualOrAncestorOf(t,n.target)||(ss.referenceEquals(n.target,this.parent.get_searchWidget().get_domXButton())?this.parent.get_searchWidget().clearSearch(!1,!1):this.parent.get_searchWidget().clearSearch(!0,!0))});this.disposables.add$1(spiff.EventUtil.bindWithDispose($(document.body),"mousedown",n))},destroy:function(){this.dispose();ss.isValue(this.$6)&&this.$6.destroyRecursive(!1);this.$6=null},layout:function(n,t){this.inherited(arguments);var i={w:n.w-6,h:n.h};this.$6.layout$1(i,t)},fetchChildNodeByIndex:function(n){var t=this.$6.domItemsList.childNodes;return n<0||n>=t.length?null:t[n]},applyChanges:function(){var n=this.$3(),t=this.$6.getUIState(),i=this.$4(t,n),r=this.$4(n,t);(i.length>0||r.length>0)&&(this.parent.set_stateId(this.parent.get_stateId()+1),tab.FilterClientCommands.modifyCategoricalFilterValues(this.parent.get_session().get_visualId(),this.parent.get_field(),i,r,!0))},$3:function(){for(var t,i=this.parent.get_oFilter().table.tuples,r={},u=i.length,n=0;n<u;n++)t=i[n],r[this.$6.getFormattedAlias(t)]=t.s;return r},$4:function(n,t){var u=[],r=ss.getEnumerator(Object.keys(n)),i;try{while(r.moveNext())i=r.current(),n.hasOwnProperty(i)&&n[i]&&!t[i]&&u.push(i)}finally{r.dispose()}return u}},l,[ss.IDisposable]);ss.initClass(si,t,{get_calendarElement:function(){return ss.isValue(this.$G)?this.$G.element:null},dispose:function(){b.prototype.dispose.call(this);this.$G=tab.MiscUtil.dispose$1(this.$G)},instantiate:function(n,t,i,r,u,f,e,o,s){b.prototype.instantiate.call(this,n,t,i,this.$M,this.$L,f,e,o,s);this.$J=e;this.$I=o;this.$M=r;this.$L=u;this.$K=s;si.lazilyCreateCalendar||this.$B()},$F:function(n){return tab.LegacyFilterModel.isNormalValue(n)?new Date(tableau.types.JsDateFromOleDate(ss.unbox(n.v))):null},editableValue:function(){return tableau.format.formatDataValue(this.$l,"m",this.$I,null,2)},$C:function(){return ss.isValue(this.$l)&&ss.isValue(this.$l.t)?this.$l.t:"t"},setNewState:function(n,t,i,r,u){b.prototype.setNewState.call(this,n,t,i,r,u);ss.isValue(this.$G)&&this.$G.setDateRange(this.$F(r),this.$F(u))},isInsideWidget:function(n){return b.prototype.isInsideWidget.call(this,n)||this.$E(n)},$E:function(n){if(ss.isNullOrUndefined(this.$G))return!1;var t=this.$G.element.get(0);return tab.DomUtil.isEqualOrAncestorOf(t,n.target)},onQueryBoxFocus:function(n){if(b.prototype.onQueryBoxFocus.call(this,n),ss.isNullOrUndefined(this.$G)||this.$G.element.is(":hidden")){this.$B();var t=this.$F(this.$l);this.$G.show(t);this.$G.positionCalendarByElement($(this.queryBox).closest(".TypeInDiv"))}},$B:function(){var i,r,f;if(!ss.isValue(this.$G)){var n=this.$J.locale_formatting_strings,e=n.narrowDay.filter(function(n){return!ss.isNullOrEmptyString(n)}),u=this.$F(this.$l),t=this.$K;ss.isValue(t)&&(t=ss.Nullable$1.sub(t,1));i={};i.format=tableau.format.mapIcuToOleFormat(this.$J.yearMonthFormat);i.locale_formatting_strings=n;r={};r.format=tableau.format.mapIcuToOleFormat(this.$J.yearMonthFormat);r.locale_formatting_strings=n;f=new tab.DatePickerSettings(u,u,this.$F(this.$M),this.$F(this.$L),t,e,n.todayFormatTemplate,function(n){return tableau.format.formatCustomJsDateTime(n,i,0,"d")},function(n){return tableau.format.formatCustomJsDateTime(n,r,0,"d")});this.$G=this.$H(f);this.$G.element.on("dateSelected",ss.mkdel(this,this.$D)).appendTo(document.body)}},$D:function(n,t){ss.isValue(this.$G)&&this.$G.hide();this.setPattern(tableau.format.formatJsDateTime(t,this.$I,2,this.$C()))},onInputBlur:function(n){ss.isValue(this.$G)&&this.$G.hide();b.prototype.onInputBlur.call(this,n)}},b,[ss.IDisposable]);ss.initClass(nf,t,{postCreate:function(){for(var i,f,e,o=tableau.format.formatTupleDisplayName,s=ss.mkdel(n.filterItem,n.filterItem.getTypeInHtml),r=[],u=0,t=0;t<this.tuples.length;t++)i=this.tuples[t],i.s&&(f=this.itemName+"_"+t,e=s(f,o(i,!0,this.role)),r.push(e),u++);this.domItemsList.innerHTML=r.join("");this.domClearListButtonDiv.style.display=u>3?"block":"none"},_onItemsListClick:function(n){this.parentFilter.onListItemClick(n)},_onItemsListMouseOver:function(t){if(ss.isValue(t.target)&&$(t.target).hasClass("FITypeInItem")){$(t.target).addClass("Hover");var i=this.$0=n.filterItem.getNodeFromEvent(t);i.appendChild(this.domXButton);$(this.domXButton).css("top","calc(50% - 7px)");$(this.domXButton).css("display","block")}},_onItemsListMouseOut:function(n){ss.isValue(n.relatedTarget)&&ss.referenceEquals(n.relatedTarget,this.domXButton)||(ss.isValue(this.$0)&&$(this.$0).removeClass("Hover"),this.$0=null,$(this.domXButton).css("display","none"))},_onItemsKeyDown:function(n){n.keyCode===46&&(this._removeSelectedItemsFromFilter(),spiff.EventUtil.stopEvent(n))},_onXButtonClick:function(t){var i=null,r,u;(spiff.EventUtil.stopEvent(t),r=n.filterItem.getNodeFromEvent(t),ss.isValue(r))&&(n.filterItem.setChecked(r,!1),ss.isValue(this.parentFilter.get_oFilter())&&(i=this.parentFilter.get_oFilter().table),tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&ss.isValue(i)&&i.actual_size===i.tuples.length&&(u=new tab.LegacyCategoricalQuickFilterData(this.parentFilter.get_oFilter().targetSheets,this.parentFilter.get_field(),this.parentFilter.get_oFilter().exclude,this.getCheckedAliases(this.getUIState())),tab.FilterClientCommands.updateCategoricalFilter(u)),this.parentFilter.clearRangeAnchorAndSelection(),this.parentFilter.notifyChange(ss.mkdel(this.parentFilter,this.parentFilter.applyChanges)))},_onXButtonMouseOver:function(){$(this.domXButton).addClass("Hover")},_onXButtonMouseOut:function(){$(this.domXButton).removeClass("Hover")},_onClearListButtonClick:function(){var t,i=null,r;for(this.parentFilter.get_searchWidget().clearSearch(!0,!1),t=this.domItemsList.firstChild;ss.isValue(t);t=t.nextSibling)n.filterItem.setChecked(t,!1);this.parentFilter.set_stateId(this.parentFilter.get_stateId()+1);ss.isValue(this.parentFilter.get_oFilter())&&(i=this.parentFilter.get_oFilter().table);tab.ApplicationModel.get_instance().get_isLocalRenderMode()&&ss.isValue(i)&&i.actual_size===i.tuples.length&&(r=new tab.LegacyCategoricalQuickFilterData(this.parentFilter.get_oFilter().targetSheets,this.parentFilter.get_field(),this.parentFilter.get_oFilter().exclude,this.getCheckedAliases(this.getUIState())),tab.FilterClientCommands.updateCategoricalFilter(r));this.parentFilter.clearRangeAnchorAndSelection();this.parentFilter.applyChanges();$(this.domClearListButtonDiv).css("display","none")},layout$1:function(n){if(tableau.util.isElementVisible(this.domClearListButtonDiv)){var t=dojo.marginBox(this.domClearListButtonDiv);n.h=Math.max(0,n.h-t.h)}dojo.marginBox(this.domItemsList,n)},_removeSelectedItemsFromFilter:function(){this.parentFilter.forEachSelected(function(t,i){n.filterItem.setChecked(i,!1)});this.parentFilter.clearRangeAnchorAndSelection();this.parentFilter.notifyChange(ss.mkdel(this.parentFilter,this.parentFilter.applyChanges))},getUIState:function(){for(var u=this.domItemsList.firstChild,i={},r,t=u;ss.isValue(t);t=t.nextSibling)r=this.getFormattedAlias(this.tuples[n.filterItem.getIndex(t)]),i[r]=n.filterItem.isChecked(t);return i},getCheckedAliases:function(n){var r=[],i=ss.getEnumerator(Object.keys(n)),t;try{while(i.moveNext())t=i.current(),n.hasOwnProperty(t)&&n[t]&&r.push(t)}finally{i.dispose()}return r},getFormattedAlias:function(n){return tableau.format.formatTupleDisplayName(n,!0,this.role)}},Object);ss.initClass(tf,t,{},ut);ss.initClass(y,t,{}),function(){tr.$0="<div class='tabHorizontalSlider'>\n<\/div>'"}(),function(){ui.$0=100}(),function(){a.itemSelector=".FIItem";a.$2="keydown."+ss.getTypeName(a)}(),function(){n.unknownItemIndex=-2;n.allItemIndex=-1;n.$1=tab.Strings.QuickFilterAll;n.filterItem=null;n.filterItem=tsConfig.is_mobile?new ot:new lr}(),function(){p.getFilterItemHtml=ss.mkdel(n.filterItem,n.filterItem.formatChecklistFilterItemHtml)}(),function(){h.$2=3;h.$1=30;h.$0="keydown."+ss.getTypeName(h)}(),function(){v.horizontalIteratorButtonSize=12;v.horizontalIteratorButtonHolderWidth=28;v.parentZoneSizeChangedKey="ParentZoneSizeChanged";v.newZoneParentKey="newZoneParent"}(),function(){r.$1=new tab.ColorModel(0,0,0,1);r.$3="Items";r.$0="CustomShapesLoaded";r.$2="FocusIndex"}(),function(){ft.modelChangedProperty="ModelChanged"}(),function(){it.$0="urlCacheInfo"}(),function(){f.legendTitleControlsClass="tabLegendTitleControls";f.legendTitleControlsSelector=".tabLegendTitleControls";f.legendHighlighterButtonClass="tabLegendHighlighterButton";f.legendHighlighterButtonSelector=".tabLegendHighlighterButton";f.legendHighlighterButtonIconClass="tabLegendHighlighterButtonIcon";f.legendContextMenuButtonClass="tabLegendContextMenuButton";f.legendContextMenuButtonSelector=".tabLegendContextMenuButton";f.legendContextMenuButtonIconClass="tabLegendContextMenuButtonIcon";f.legendTitleControlsButtonsClass="tabLegendTitleControlsButtons"}(),function(){di.$0="\n            <div class='tabLegendPanel' style='position: relative; overflow: hidden'>\n                <div class='tabLegendTitleAndControls'>\n                    <h3 class='tabLegendTitle' style='position: absolute'><\/h3>\n                    <div class='tabLegendTitleControls'>\n                        <div class='tabLegendContextMenuButton' style='display:none;'>\n                            <div class='tabLegendContextMenuButtonIcon'><\/div>\n                        <\/div>\n                    <\/div>\n                <\/div>\n                <canvas class='tabLegendRamp' style='position: absolute'><\/canvas>\n                <div class='tabLegendCenterMark' style='position: absolute'><\/div>\n                <div class='tabLegendMinLabel' style='position: absolute'><\/div>\n                <div class='tabLegendMaxLabel' style='position: absolute'><\/div>\n            <\/div>"}(),function(){at.$0="tableau_qcolor_legend_";at.$1=.15}(),function(){et.$1=1e3;et.$0=200}(),function(){o.$0=1;o.$2="tabLegendItem";o.$4=2;o.$1="tableau_base_legend_";o.$5=new tab.ColorModel(216,216,216,1);o.$3=new tab.ColorModel(178,178,178,1)}(),function(){pt.$1="<span class='tabLegendItemSwatch' />";pt.$0="<canvas class='tabLegendItemSwatch' />";pt.$2="<div class='tabLegendItem'><span class='tabLegendItemSwatchHolder'><\/span><span class='tabLegendItemLabelHolder'><span class='tabLegendItemLabel' /><\/span><\/div>"}(),function(){ci.$0="<span class='tabLegendItemColumn'/>"}(),function(){ir.$0="<div class='tabLegendTitleControls'><div class='tabLegendHighlighterButton tabLegendTitleControlsButtons'><div class='tabLegendHighlighterButtonIcon'/><\/div><div class='tabLegendContextMenuButton tabLegendTitleControlsButtons'><div class='tabLegendContextMenuButtonIcon'/><\/div><\/div>"}(),function(){tab.ObjectRegistry.registerType(ai,ai).call(null)}(),function(){i.$1=null;i.$2=null}(),function(){yt.tableauSliderTemplate="<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>";yt.$2="<div class='dijitTooltip dijitTooltipLeft' id='dojoTooltip'><div class='dijitTooltipContainer' dojoAttachpoint='coreArea'><div class='dijitTooltipContents' dojoAttachPoint='containerNode' waiRole='alert'><\/div><\/div><div class='dijitTooltipConnector'><\/div><\/div>";yt.$0=1;yt.$1=20}(),function(){si.lazilyCreateCalendar=!0}(),function(){ut.$0=75}(),function(){u.$8=new tab.ColorModel(255,255,255,1);u.$6=.235294118523598;u.$7=.411764711141586;u.$3=.39215686917305;u.$1=.549019634723663;u.$5=95;u.$4=new tab.ColorModel(234,234,234,1);u.$2=new tab.ColorModel(241,241,241,1)}(),function(){tt.pickerDurationsInteger=[1,7,30,90,365,1825];tt.pickerDurations=["0d","-7d","-30d","-90d","-365d","-1825d"];tt.pickerStrings=[tab.Strings.RelDatePickerOneDayAbbrev,tab.Strings.RelDatePickerOneWeekAbbrev,tab.Strings.RelDatePickerOneMonthAbbrev,tab.Strings.RelDatePickerThreeMonthsAbbrev,tab.Strings.RelDatePickerOneYearAbbrev,tab.Strings.RelDatePickerFiveYearsAbbrev];tt.$1="RDFButtonR1";tt.$0="RDFButtonHide"}(),function(){ni.$0=!1}(),function(){e.noSearchPerformed=-1}(),function(){ri.$0=500;ri.minimumDomainSize=5}(),function(){lt.$1="<div class='CategoricalFilter' role='application'><div class='CategoricalFilterBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='FilterTitle' dojoAttachPoint='domTitleBar'><\/h3><div dojoType='dijit.form.Button' class='CFButton CFResetButton' showlabel='false'dojoAttachPoint='resetButton' dojoAttachEvent='onClick:toggleReset'iconClass='wcIconNonfiltered'>Showing all values<\/div><div dojoType='dijit.form.Button' class='CFButton CFSearchButton' showlabel='false'dojoAttachPoint='searchButton' dojoAttachEvent='onClick:toggleSearchUI'iconClass='wcIconSearch'>Search<\/div><div dojoType='dijit.form.Button' class='CFButton CFDomainButton' showlabel='false'dojoAttachPoint='domainButton' dojoAttachEvent='onClick:toggleDomain'iconClass='wcIconDomainAll'>Show Fewer Values<\/div><div dojoType='dijit.form.Button' dojoAttachEvent='onClick:doMenu' iconClass='wcIconContextMenu'class='CFButton CFMenuButton' dojoAttachPoint='menuButton' name='type'><\/div><\/div><div dojoAttachPoint='searchDiv'><\/div><div class='CFContent' dojoAttachPoint='domContent'><\/div><div class='CFHorizScroll' dojoAttachPoint='domHorizScroll' dojoAttachEvent='onscroll:doscrollHoriz'><div dojoAttachPoint='domHorizScrollContent'><\/div><\/div><div dojoType='tableau.base.widget.ConditionalsWidget' dojoAttachPoint='conditionals'><\/div><\/div><\/div>";lt.$2="<div class='ParameterControl' role='form'><div class='ParameterControlBox' dojoAttachPoint='domBox'><div class='TitleAndControls' dojoAttachPoint='domControls'><h3 class='ParamTitle' dojoAttachPoint='domTitleBar'><\/h3><\/div><div class='PCContent' dojoAttachPoint='domContent'><\/div><\/div><\/div>";lt.$3="<div class='Search' role='form'><div class='SearchBox' dojoAttachPoint='domQuerySection'><textarea rows='1' class='QueryBox' spellcheck='false'dojoAttachPoint='domQueryBox'dojoAttachEvent='onkeydown:onQueryBoxKeyDown,onpaste:onQueryBoxPaste'><\/textarea><span class='wcSearchX' title='${XBUTTON_CLOSE_TOOLTIP}'dojoAttachPoint='domXButton'dojoAttachEvent='onclick:onXButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><img class='searchBusyImg' title='${CANCEL_SEARCH_TOOLTIP}' src='${busy_gif_url}'dojoAttachPoint='domSearchBusyImg'dojoAttachEvent='onclick:onSearchBusyImgClick'><\/img><span class='wcIconSearch' title='${SEARCH_TOOLTIP}'dojoAttachPoint='domSearchButton'dojoAttachEvent='onclick:onSearchButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><span class='wcIconSearchAdd' title='${ADD_ITEM_CTRL_ENTER}'dojoAttachPoint='domSearchAddButton'dojoAttachEvent='onclick:onSearchAddButtonClick,onmouseover:onButtonHover,onmouseout:onButtonUnhover'><\/span><\/div><div class='SearchResults' dojoAttachPoint='domResults' dojoAttachEvent='onclick:onListItemClick'><\/div><\/div>";dojo.addOnLoad(lt.$0)}(),function(){gi.$0="<div class='tab-quick-filter'><\/div>"}(),function(){yi.$0="<div class='tab-page'><\/div>"}(),function(){tab.ObjectRegistry.registerType(pi,pi).call(null)}(),function(){bi.$0="<div class='tab-parameter'><\/div>"}(),function(){tab.ObjectRegistry.registerType(ki,ki).call(null)}()})();
/*! BEGIN LegacyDojoUIWeb */
(function(){"dont use strict";var n={},t,i,r,o,s,e,u,f;global.tab=global.tab||{};ss.initAssembly(n,"vqllegacydojouiweb");t=function(){this.scroller=null;tab.CategoricalLegendTemplate.call(this,$("<div class='tabLegendPanel' style='position : relative;'><div class='tabLegendBox'><h3 class='tabLegendTitle'><\/h3><div class='tabLegendContentHolder' style='overflow:auto'><div class='tabLegendColumnHolder' style='white-space:nowrap'><\/div><\/div><div class='tabCatLegendScroll'><\/div><\/div><\/div>"));this.scroller=this.getElementBySelector(".tabCatLegendScroll");this.legendContentArea=this.columnsHolder;tab.BrowserSupport.get_isFF()&&this.columnsHolder.attr("tabindex","-1")};t.__typeName="tab.CategoricalLegendTemplateWeb";global.tab.CategoricalLegendTemplateWeb=t;i=function(n){this.$M=null;this.$N=null;this.$L=null;tab.CategoricalLegendView.call(this,n,new t);this.$M=this.$B();this.$I().domRoot.css("cursor","default");this.$N=new tab.IteratorButtons(this.get_catLegendTemplate().columnsHolder,!0,12);this.$I().scroller.append(this.$N.get_domRoot())};i.__typeName="tab.CategoricalLegendViewWeb";global.tab.CategoricalLegendViewWeb=i;r=function(n){var i;if(this.$d=null,this.$f=null,this.$g=null,this.$e=!1,tab.ContinuousSlider.call(this,n),this.viewModel.add_enabledChanged(ss.mkdel(this,this.applyEnabledState)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.viewModel.remove_enabledChanged(ss.mkdel(this,this.applyEnabledState))}))),i={templateString:"<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>",onChange:ss.mkdel(this,this.$9),value:n.get_sliderCurrentValue(),minimum:n.get_sliderMinimumValue(),maximum:n.get_sliderMaximumValue(),slideDuration:0,intermediateChanges:!0,style:"width:"+n.get_pixelWidth()+"px;",showButtons:!1},this.$d=new dijit.form.HorizontalSlider(i,this.get_template().domRoot.get(0)),this.$f=dojo.subscribe("/dnd/move/start",ss.mkdel(this,this.$a)),this.$g=dojo.subscribe("/dnd/move/stop",ss.mkdel(this,this.$b)),this.viewModel.add_sliderValueChange(ss.mkdel(this,this.$c)),this.disposables.add$1(new tab.CallOnDispose(ss.mkdel(this,function(){this.viewModel.remove_sliderValueChange(ss.mkdel(this,this.$c))}))),this.get_template().domRoot.append(this.$d.domNode),this.viewModel.get_ruleTickCount()>0){var t=$("<div class='tabSliderRule'>"),u=ss.mkdict(["count",this.viewModel.get_ruleTickCount()]),r=new dijit.form.HorizontalRule(u,t.get(0));t.append(r.domNode);r.startup();this.get_template().domRoot.append(t)}this.$e=!1;this.applyEnabledState()};r.__typeName="tab.ContinuousSliderWeb";global.tab.ContinuousSliderWeb=r;o=function(){};o.__typeName="tab.DojoWidgetsWeb";global.tab.DojoWidgetsWeb=o;s=function(){tab.BaseLegacyDojoUIModule.call(this)};s.__typeName="tab.LegacyDojoUIWebFactory";global.tab.LegacyDojoUIWebFactory=s;e=function(){};e.__typeName="tab.LegacyDojoWidgetMakerWeb";global.tab.LegacyDojoWidgetMakerWeb=e;u=function(){this.domHorizScrollButtonHolder=null;tab.LegacyLegendTemplate.call(this,$("<div class='LegendPanel'><div class='LegendBox'><h3 class='tabLegendTitle'><\/h3><div class='LegendContent'><img class='LegendImageBody'/><\/div><div class='tabCatLegendScroll'><\/div><\/div><div class='tabLegendTitleControls'><div class='tabLegendHighlighterButton tabLegendTitleControlsButtons'><div class='tabLegendHighlighterButtonIcon'><\/div><\/div><div class='tabLegendContextMenuButton tabLegendTitleControlsButtons'><div class='tabLegendContextMenuButtonIcon'><\/div><\/div><\/div><\/div>"));this.domHorizScrollButtonHolder=this.getElementBySelector(".tabCatLegendScroll");this.legendContentArea=this.domContent};u.__typeName="tab.LegacyLegendTemplateWeb";global.tab.LegacyLegendTemplateWeb=u;f=function(n){this.$o=new tab.DisposableHolder;tab.LegacyLegendView.call(this,n,new u)};f.__typeName="tab.LegacyLegendViewWeb";global.tab.LegacyLegendViewWeb=f;ss.initClass(t,n,{},tab.CategoricalLegendTemplate,[ss.IDisposable]);ss.initClass(i,n,{$J:function(){return tab.DoubleUtil.roundToInt(this.$I().columnsHolder.width())},$K:function(){return this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.colCount*this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.colWidth},$I:function(){return this.get_template()},dispose:function(){this.$M.dispose();this.$L.dispose();this.$N.dispose();ss.makeGenericType(tab.BaseLegendView$1,[tab.CategoricalLegendViewModel]).prototype.dispose.call(this)},drawLegend:function(n){var f,i,s,h,c;tab.CategoricalLegendView.prototype.drawLegend.call(this,n);var l=this.get_catLegendViewModel().get_categoricalLegendPM(),t=l.catLegendLayout,e=tab.DoubleUtil.roundToInt(this.$I().titleArea.height()),o=0,r=0,u=!this.highlighterFitsUpperRight();u&&!this.get_catLegendViewModel().get_titleInline()&&(o+=e);f=!1;i=!1;this.$G()?(this.get_catLegendTemplate().columnsHolder.css({"overflow-x":"hidden"}),this.get_catLegendTemplate().columnsHolder.css({"overflow-y":"hidden"}),s=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout.colWidth,this.$N.set_scrollIncrement(s),this.$N.reset(),this.viewportWidth-=28,u&&(r+=30),this.get_catLegendViewModel().get_titleInline()?this.$I().scroller.css({top:"0px"}):this.$I().scroller.css({top:e+"px"})):t.legendLayout==="horizontal"||t.legendLayout==="grid"?f=!0:i=!0;u&&i&&(h=t.rowCount*t.rowHeight,this.viewportHeight<h&&(c=tab.Metrics.get_scrollW(),r+=c));this.get_catLegendTemplate().columnsHolder.css({"overflow-x":f?"auto":"hidden","overflow-y":i?"auto":"hidden"});this.$I().titleControls.css({top:o+"px",right:r+"px"});this.setContentSize(this.viewportHeight,this.viewportWidth);this.$H()},$B:function(){var n;return this.$L=new spiff.HoverBehavior(this,null,ss.mkdel(this,this.$D),ss.mkdel(this,this.$E)),n={},n.tap=ss.mkdel(this,this.$F),n.hover=ss.mkdel(this,this.$C),n.hoverDelay=tab.FeatureFlags.isEnabled("VizLegendHover")?0:150,new spiff.TableauEventHandler.$ctor1(this.$I().domRoot.get(0),n)},$D:function(){this.showOrHideTitleControls(!0)},$E:function(){var n=$.contains(this.element[0],document.activeElement)&&!spiff.FocusManager.wasFocusedByClick();this.showOrHideTitleControls(n);tab.FeatureFlags.isEnabled("VizLegendHover")&&this.clearHoverOnItem()},$C:function(n){var t;if(!spiff.DragDropManager.get_isDragging()){if(t=this.getLegendItemFromEvent(n),ss.isValue(t)){var i=this.getViewportPosition(n),r=this.getDocumentPosition(i),u={x:r.x,y:r.y,w:0,h:0};this.performHoverOnItem(t,i,u)}n.preventDefault()}},$F:function(n){var t=this.getLegendItemFromEvent(n),i=tab.SelectActionResolver.fromNormalizedEvent(n,2);if(ss.isValue(t)){var r=this.getViewportPosition(n),u=this.getDocumentPosition(r),f={x:u.x,y:u.y,w:0,h:0};this.performSelectOnItem(t,i,r,f)}else this.get_catLegendViewModel().selectNone(i);n.preventDefault()},$G:function(){var n=this.get_catLegendViewModel().get_categoricalLegendPM().catLegendLayout,t;return n.legendLayout==="vertical"?!1:(t=n.rowHeight+tab.Metrics.get_scrollH(),this.$J()<this.$K()&&t>=this.$I().columnsHolder.height())},$H:function(){this.$G()?this.$I().scroller.show():this.$I().scroller.hide()}},tab.CategoricalLegendView,[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[tab.CategoricalLegendViewModel]),ss.makeGenericType(tab.ICategoricalLegendView$1,[tab.CategoricalLegendViewModel])]);ss.initClass(r,n,{$c:function(){this.$d._setValueAttr(this.viewModel.get_sliderCurrentValue())},$a:function(n){this.viewModel.get_enabled()&&ss.isValue(n)&&ss.referenceEquals(n.node,this.$d.sliderHandle)&&(this.$e=!0)},$b:function(n){this.viewModel.get_enabled()&&ss.isValue(n)&&ss.referenceEquals(n.node,this.$d.sliderHandle)&&(this.$e=!1,this.applyChanges(this.viewModel.get_sliderIntermediateValue()))},$9:function(n){this.viewModel.get_enabled()&&(this.viewModel.applyIntermediateChange(n),this.$e||this.applyChanges(this.viewModel.get_sliderIntermediateValue()))},dispose:function(){dojo.unsubscribe(this.$f);dojo.unsubscribe(this.$g);tab.ContinuousSlider.prototype.dispose.call(this)},applyEnabledState:function(){this.$d.setDisabled(!this.viewModel.get_enabled())}},tab.ContinuousSlider,[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[tab.ContinuousSliderViewModel]),tab.IContinuousSlider]);ss.initClass(o,n,{});ss.initClass(s,n,{createPageView:function(n){return new tab.PageView(n)},createLegacyQuickFilterDisplayView:function(n){return new tab.LegacyQuickFilterDisplayView(n)},createParameterControlView:function(n){return new tab.ParameterControlView(n)},createLegacyLegendView:function(n){return new f(n)},createContinuousSlider:function(n){return new r(n)}},tab.BaseLegacyDojoUIModule,[tab.ILegacyDojoUIModule]);ss.initClass(e,n,{makeCurrentPagePanelWidget:function(n){return new tableau.base.widget.CurrentPagePanel(n)},makeFilterPanelWidget:function(n){return new tableau.base.widget.FilterPanel(n)},makeControlWidget:function(n){return new tableau.base.widget.ParameterControl(n)}},null,[tab.ILegacyDojoWidgetMaker]);ss.initClass(u,n,{},tab.LegacyLegendTemplate,[ss.IDisposable]);ss.initClass(f,n,{onAddedToDom:function(){tab.LegacyLegendView.prototype.onAddedToDom.call(this);var n=this.get_legendTemplate().domHorizScrollButtonHolder;n.append(this.iterButtons.get_domRoot());n.css({visibility:"hidden"})},dispose:function(){this.$o.dispose();tab.LegacyLegendView.prototype.dispose.call(this)},makeViewerInputHandler:function(n){var t={};return t.tap=ss.mkdel(this,this.onTap),t.hover=ss.mkdel(this,this.onHover),new spiff.TableauEventHandler.$ctor1(n,t)},layoutButtons:function(n){var u=0,r=0,i,t,f,e;this.get_legendTemplate().titleControls.css({right:""});i=!this.highlighterFitsUpperRight();i&&!this.get_legendViewModel().get_titleInline()&&(u+=this.get_legendViewModel().get_titleHeight());t=this.get_template().domHorizScrollButtonHolder;t.css({visibility:"hidden"});this.get_serverRenderedModel().isVisuallyCat?(this.get_serverRenderedModel().legendLayout!=="vertical"&&(n.h<tab.Metrics.get_minScrollHeight()&&n.h>1?(this.get_domNode().classList.add("LegendHorizontal"),f=this.bodySize.w,f>n.w?(n.w-=28,!this.get_serverRenderedModel().isVisuallyCat||!this.get_legendViewModel().get_titleInline()&&this.get_legendViewModel().get_hasTitle()||(n.w-=18,this.get_legendTemplate().titleControls.css({right:"32px"})),this.iterButtons.set_scrollIncrement(this.get_serverRenderedModel().colWidth||ss.Int32.div(this.get_legendTemplate().get_contentArea().get(0).clientWidth,2)||120),e=!this.get_legendViewModel().get_titleInline()?this.get_legendViewModel().get_titleHeight():0,t.css({visibility:"visible",top:e+"px"}),i&&(r+=30)):(t.css({visibility:"hidden"}),this.get_legendTemplate().get_contentArea().css({"overflow-x":"auto"}))):this.get_legendTemplate().get_contentArea().css({overflow:"auto"})),this.get_serverRenderedModel().legendLayout==="vertical"&&(this.get_legendTemplate().get_contentArea().css({"overflow-y":"auto"}),i&&this.get_serverRenderedModel().regionHeight>n.h&&(r+=tab.Metrics.get_scrollW())),tab.DomUtil.setMarginBox(this.get_legendTemplate().get_contentArea().get(0),{w:n.w,h:n.h})):(t.css({visibility:"hidden"}),this.get_legendTemplate().get_contentArea().css({overflow:"hidden"}),n.w>0&&tab.DomUtil.setMarginBox(this.get_legendTemplate().get_contentArea().get(0),{w:n.w,h:n.h}));this.get_legendTemplate().titleControls.css({top:u+"px",right:r+"px"});this.iterButtons.updateButtonState()},onTap:function(n){if(!(n.originalEvent.button>1)){this.disallowHover();var i=this.getDocumentPoint(n),t=this.documentPointToContentPoint(i),u={x:t.x,y:t.y,w:0,h:0},f=n.getSelectAction(),r=ss.mkdel(this,function(){this.get_legendTooltip().singleSelectCoordinates(i,t,this.get_legendViewModel().get_regionType(),"legenditem",this.getFieldNameVec())});this.get_serverRenderedModel().legendType!=="map"?tab.SelectionClientCommands.selectRectRegionAndDoUbertip(this.get_legendViewModel().get_regionType(),u,f,this.get_visualId(),r,"default",this.getFieldNameVec()):r()}},allowHover:function(){this.eventHandler.unsuppressHover()},disallowHover:function(){this.eventHandler.suppressHover()}},tab.LegacyLegendView,[tab.IWidget,tab.IAppendableView,ss.IDisposable,ss.makeGenericType(tab.IView$1,[tab.LegacyLegendViewModel]),ss.makeGenericType(tab.ILegacyLegendView$1,[tab.LegacyLegendViewModel])]),function(){t.$0="<div class='tabLegendPanel' style='position : relative;'><div class='tabLegendBox'><h3 class='tabLegendTitle'><\/h3><div class='tabLegendContentHolder' style='overflow:auto'><div class='tabLegendColumnHolder' style='white-space:nowrap'><\/div><\/div><div class='tabCatLegendScroll'><\/div><\/div><\/div>"}(),function(){tab.ObjectRegistry.registerType(tab.CategoricalLegendView,i).call(null);tab.ObjectRegistry.registerType(ss.makeGenericType(tab.ICategoricalLegendView$1,[tab.ICategoricalLegendViewModel]),i).call(null)}(),function(){r.tableauSliderTemplate="<div class='dijit dijitReset'><div class='dijitReset tableauSlider' dojoAttachPoint='tableauSlider'><table class='dijit dijitReset' cellspacing='0' cellpadding='0' border='0' rules='none'><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,topDecoration' class='dijitReset' style='text-align:center;width:100%;'><\/td><td class='dijitReset'><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper dijitSliderLeftBumper' dojoAttachEvent='onclick:_onClkDecBumper'><\/div><\/td><td class='dijitReset'><input dojoAttachPoint='valueNode' type='hidden' name='${name}'><div class='dijitReset dijitSliderBarContainerH' waiRole='presentation' dojoAttachPoint='sliderBarContainer'><div waiRole='presentation' dojoAttachPoint='progressBar' class='dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH' dojoAttachEvent='onclick:_onBarClick'><div class='dijitSliderMoveable dijitSliderMoveableH'><div dojoAttachPoint='sliderHandle,focusNode' class='dijitSliderImageHandle dijitSliderImageHandleH' dojoAttachEvent='onmousedown:_onHandleClick' waiRole='slider' valuemin='${minimum}' valuemax='${maximum}'><\/div><\/div><\/div><div waiRole='presentation' dojoAttachPoint='remainingBar' class='dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH' dojoAttachEvent='onclick:_onBarClick'><\/div><\/div><\/td><td class='dijitReset'><div class='dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper dijitSliderRightBumper' dojoAttachEvent='onclick:_onClkIncBumper'><\/div><\/td><\/tr><tr class='dijitReset'><td class='dijitReset'><\/td><td dojoAttachPoint='containerNode,bottomDecoration' class='dijitReset'><\/td><td class='dijitReset'><\/td><\/tr><\/table><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowDec' style='display:none' dojoAttachPoint='decrementButton'><div class='dijitSliderDecrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>-<\/span><\/div><\/div><div class='dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH tableauArrowInc' style='display:none' dojoAttachPoint='incrementButton'><div class='dijitSliderIncrementIconH' tabIndex='-1'><span class='dijitSliderButtonInner'>+<\/span><\/div><\/div><\/div>"}(),function(){dojo.addOnLoad(function(){dojo.require("tableau.web.WebClient")})}(),function(){u.$0="<div class='LegendPanel'><div class='LegendBox'><h3 class='tabLegendTitle'><\/h3><div class='LegendContent'><img class='LegendImageBody'/><\/div><div class='tabCatLegendScroll'><\/div><\/div><div class='tabLegendTitleControls'><div class='tabLegendHighlighterButton tabLegendTitleControlsButtons'><div class='tabLegendHighlighterButtonIcon'><\/div><\/div><div class='tabLegendContextMenuButton tabLegendTitleControlsButtons'><div class='tabLegendContextMenuButtonIcon'><\/div><\/div><\/div><\/div>"}(),function(){f.$0=120}(),function(){tab.ObjectRegistry.registerType(tab.ILegacyDojoWidgetMaker,e).call(null)}()})();